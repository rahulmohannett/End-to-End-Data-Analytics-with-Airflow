[0m22:09:38.829700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10597fe00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106eefb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106eefd90>]}


============================== 22:09:38.832084 | 21c25380-006f-4aeb-aaec-ade69791afbf ==============================
[0m22:09:38.832084 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m22:09:38.832328 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/Users/rahulmohandevi/.dbt', 'target_path': 'None', 'log_cache_events': 'False', 'printer_width': '80', 'invocation_command': 'dbt debug', 'use_experimental_parser': 'False', 'warn_error': 'None', 'write_json': 'True', 'indirect_selection': 'eager', 'empty': 'None', 'introspect': 'True', 'log_format': 'default', 'quiet': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'static_parser': 'True', 'use_colors': 'True', 'no_print': 'None', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'log_path': '/Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/logs'}
[0m22:09:38.840114 [info ] [MainThread]: dbt version: 1.11.0-b3
[0m22:09:38.840260 [info ] [MainThread]: python version: 3.13.5
[0m22:09:38.840358 [info ] [MainThread]: python path: /opt/anaconda3/bin/python3.13
[0m22:09:38.840445 [info ] [MainThread]: os info: macOS-26.0.1-arm64-arm-64bit-Mach-O
[0m22:09:39.473542 [info ] [MainThread]: Using profiles dir at /Users/rahulmohandevi/.dbt
[0m22:09:39.473751 [info ] [MainThread]: Using profiles.yml file at /Users/rahulmohandevi/.dbt/profiles.yml
[0m22:09:39.473866 [info ] [MainThread]: Using dbt_project.yml file at /Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/dbt_project.yml
[0m22:09:39.474077 [info ] [MainThread]: adapter type: snowflake
[0m22:09:39.474214 [info ] [MainThread]: adapter version: 1.10.2
[0m22:09:39.508303 [info ] [MainThread]: Configuration:
[0m22:09:39.508455 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m22:09:39.508554 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m22:09:39.508640 [info ] [MainThread]: Required dependencies:
[0m22:09:39.508767 [debug] [MainThread]: Executing "git --help"
[0m22:09:39.527391 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m22:09:39.527819 [debug] [MainThread]: STDERR: "b''"
[0m22:09:39.527943 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m22:09:39.528048 [info ] [MainThread]: Connection:
[0m22:09:39.528165 [info ] [MainThread]:   account: sfedu02-lvb17920
[0m22:09:39.528248 [info ] [MainThread]:   user: OSTRICH
[0m22:09:39.528329 [info ] [MainThread]:   database: USER_DB_OSTRICH
[0m22:09:39.528404 [info ] [MainThread]:   warehouse: OSTRICH_QUERY_WH
[0m22:09:39.528482 [info ] [MainThread]:   role: TRAINING_ROLE
[0m22:09:39.528559 [info ] [MainThread]:   schema: PUBLIC
[0m22:09:39.528637 [info ] [MainThread]:   authenticator: None
[0m22:09:39.528717 [info ] [MainThread]:   oauth_client_id: None
[0m22:09:39.528792 [info ] [MainThread]:   query_tag: None
[0m22:09:39.528871 [info ] [MainThread]:   client_session_keep_alive: False
[0m22:09:39.528952 [info ] [MainThread]:   host: None
[0m22:09:39.529029 [info ] [MainThread]:   port: None
[0m22:09:39.529103 [info ] [MainThread]:   proxy_host: None
[0m22:09:39.529182 [info ] [MainThread]:   proxy_port: None
[0m22:09:39.529257 [info ] [MainThread]:   protocol: None
[0m22:09:39.529328 [info ] [MainThread]:   connect_retries: 1
[0m22:09:39.529401 [info ] [MainThread]:   connect_timeout: None
[0m22:09:39.529473 [info ] [MainThread]:   retry_on_database_errors: False
[0m22:09:39.529546 [info ] [MainThread]:   retry_all: False
[0m22:09:39.529618 [info ] [MainThread]:   insecure_mode: False
[0m22:09:39.529692 [info ] [MainThread]:   reuse_connections: True
[0m22:09:39.529764 [info ] [MainThread]:   s3_stage_vpce_dns_name: None
[0m22:09:39.530016 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m22:09:39.573412 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m22:09:39.631204 [debug] [MainThread]: Using snowflake connection "debug"
[0m22:09:39.631402 [debug] [MainThread]: On debug: select 1 as id
[0m22:09:39.631507 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:09:42.326562 [debug] [MainThread]: SQL status: SUCCESS 1 in 2.695 seconds
[0m22:09:42.328662 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m22:09:42.329388 [info ] [MainThread]: [32mAll checks passed![0m
[0m22:09:42.340188 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 3.5403302, "process_in_blocks": "0", "process_kernel_time": 0.279328, "process_mem_max_rss": "235945984", "process_out_blocks": "0", "process_user_time": 1.023682}
[0m22:09:42.340772 [debug] [MainThread]: Command `dbt debug` succeeded at 22:09:42.340656 after 3.54 seconds
[0m22:09:42.341131 [debug] [MainThread]: Connection 'debug' was left open.
[0m22:09:42.341623 [debug] [MainThread]: On debug: Close
[0m22:09:42.470744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f8fbbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ed2ef90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e99b350>]}
[0m22:09:42.471754 [debug] [MainThread]: Flushing usage events
[0m22:09:42.839103 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:40:14.490973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105493e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107233b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107233d90>]}


============================== 22:40:14.493475 | b91bca03-d13b-41a9-913e-a73c5e7b7695 ==============================
[0m22:40:14.493475 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m22:40:14.493715 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'partial_parse': 'True', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'quiet': 'False', 'use_experimental_parser': 'False', 'empty': 'False', 'target_path': 'None', 'write_json': 'True', 'log_path': '/Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/logs', 'use_colors': 'True', 'printer_width': '80', 'version_check': 'True', 'profiles_dir': '/Users/rahulmohandevi/.dbt', 'log_cache_events': 'False', 'static_parser': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'invocation_command': 'dbt run -s stg_market_data stg_market_forecast', 'no_print': 'None'}
[0m22:40:15.255220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b91bca03-d13b-41a9-913e-a73c5e7b7695', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b3c510>]}
[0m22:40:15.277368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b91bca03-d13b-41a9-913e-a73c5e7b7695', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120ae8270>]}
[0m22:40:15.277849 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m22:40:15.328144 [debug] [MainThread]: checksum: e63134dccc1251cfb572caf0e4aa952f030c125ee3634f3bf2c0a2e1bb6ae349, vars: {}, profile: , target: , version: 1.11.0b3
[0m22:40:15.328531 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:40:15.328675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b91bca03-d13b-41a9-913e-a73c5e7b7695', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1209e3a50>]}
[0m22:40:15.725327 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two data_tests with the name "not_null_stg_market_data_id" defined on column "id" in "models.stg_market_data".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when running tests.
  
  To fix this, change the name of one of these resources:
  - test.stock_analytics.not_null_stg_market_data_id.2680e0cd02 (models/staging/schema.yml)
  - test.stock_analytics.not_null_stg_market_data_id.2680e0cd02 (models/staging/schema.yml)
[0m22:40:15.730055 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.2678865, "process_in_blocks": "0", "process_kernel_time": 0.245707, "process_mem_max_rss": "223772672", "process_out_blocks": "0", "process_user_time": 1.319658}
[0m22:40:15.730266 [debug] [MainThread]: Command `dbt run` failed at 22:40:15.730221 after 1.27 seconds
[0m22:40:15.730418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121012210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121010050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10713fe70>]}
[0m22:40:15.730548 [debug] [MainThread]: Flushing usage events
[0m22:40:16.075735 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:49:17.052788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107193e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120c17b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120c17d90>]}


============================== 22:49:17.055437 | b8c7a072-9343-482d-84ba-2acbb2346fd2 ==============================
[0m22:49:17.055437 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m22:49:17.055720 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'indirect_selection': 'eager', 'log_format': 'default', 'use_experimental_parser': 'False', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'partial_parse': 'True', 'warn_error': 'None', 'empty': 'False', 'introspect': 'True', 'printer_width': '80', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'log_path': '/Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'profiles_dir': '/Users/rahulmohandevi/.dbt', 'log_cache_events': 'False', 'invocation_command': 'dbt compile', 'target_path': 'None', 'cache_selected_only': 'False'}
[0m22:49:17.806778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b8c7a072-9343-482d-84ba-2acbb2346fd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10773c510>]}
[0m22:49:17.829089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b8c7a072-9343-482d-84ba-2acbb2346fd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1339e8270>]}
[0m22:49:17.829581 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m22:49:17.879008 [debug] [MainThread]: checksum: e63134dccc1251cfb572caf0e4aa952f030c125ee3634f3bf2c0a2e1bb6ae349, vars: {}, profile: , target: , version: 1.11.0b3
[0m22:49:17.879373 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:49:17.879513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b8c7a072-9343-482d-84ba-2acbb2346fd2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1338e7a50>]}
[0m22:49:17.881144 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading stock_analytics: staging/schema.yml - Runtime Error
    Syntax error near line 7
    ------------------------------
    4  |   - name: stg_market_data
    5  |     description: "Cleaned staging view for RAW.MARKET_DATA"
    6  |     data_tests:
    7  |           - unique: column_name: [symbol, date]
    8  |           - not_null: { column_name: symbol }
    9  |           - not_null: { column_name: date }
    10 | 
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 7, column 32
[0m22:49:17.886290 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": false, "command_wall_clock_time": 0.86334807, "process_in_blocks": "0", "process_kernel_time": 0.235164, "process_mem_max_rss": "212058112", "process_out_blocks": "0", "process_user_time": 0.935211}
[0m22:49:17.886508 [debug] [MainThread]: Command `dbt compile` failed at 22:49:17.886463 after 0.86 seconds
[0m22:49:17.886695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x133999220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13399a7b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120b1be70>]}
[0m22:49:17.886821 [debug] [MainThread]: Flushing usage events
[0m22:49:18.258655 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:51:24.769149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112293e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113d0fb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113d0fd90>]}


============================== 22:51:24.771602 | 21f47257-7487-4f1e-a0d1-4a9a5e4f8ecf ==============================
[0m22:51:24.771602 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m22:51:24.771843 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'introspect': 'True', 'debug': 'False', 'static_parser': 'True', 'use_colors': 'True', 'fail_fast': 'False', 'version_check': 'True', 'log_format': 'default', 'target_path': 'None', 'log_cache_events': 'False', 'write_json': 'True', 'log_path': '/Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/logs', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt compile', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'False', 'quiet': 'False', 'profiles_dir': '/Users/rahulmohandevi/.dbt', 'indirect_selection': 'eager', 'no_print': 'None', 'cache_selected_only': 'False', 'partial_parse': 'True', 'warn_error': 'None'}
[0m22:51:25.481289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '21f47257-7487-4f1e-a0d1-4a9a5e4f8ecf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11273c510>]}
[0m22:51:25.503395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '21f47257-7487-4f1e-a0d1-4a9a5e4f8ecf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1269ec270>]}
[0m22:51:25.503866 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m22:51:25.552693 [debug] [MainThread]: checksum: e63134dccc1251cfb572caf0e4aa952f030c125ee3634f3bf2c0a2e1bb6ae349, vars: {}, profile: , target: , version: 1.11.0b3
[0m22:51:25.553042 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:51:25.553176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '21f47257-7487-4f1e-a0d1-4a9a5e4f8ecf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1268e7a50>]}
[0m22:51:25.950328 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.stock_analytics.stg_market_forecast' (models/staging/stg_market_forecast.sql) depends on a source named 'analytics.MARKET_DATA' which was not found
[0m22:51:25.954243 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": false, "command_wall_clock_time": 1.214161, "process_in_blocks": "0", "process_kernel_time": 0.239636, "process_mem_max_rss": "224395264", "process_out_blocks": "0", "process_user_time": 1.315685}
[0m22:51:25.954472 [debug] [MainThread]: Command `dbt compile` failed at 22:51:25.954419 after 1.21 seconds
[0m22:51:25.954653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126ff26c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126ff2120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113c1be70>]}
[0m22:51:25.954809 [debug] [MainThread]: Flushing usage events
[0m22:51:26.331056 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:52:12.195348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f8be00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107507b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107507d90>]}


============================== 22:52:12.197841 | 455e68e2-7cef-49ca-ab07-54a30ff65557 ==============================
[0m22:52:12.197841 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m22:52:12.198098 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'target_path': 'None', 'log_path': '/Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/logs', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/Users/rahulmohandevi/.dbt', 'introspect': 'True', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'invocation_command': 'dbt compile', 'debug': 'False', 'partial_parse': 'True', 'empty': 'False', 'fail_fast': 'False', 'warn_error': 'None', 'printer_width': '80', 'static_parser': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'no_print': 'None', 'cache_selected_only': 'False', 'write_json': 'True', 'log_format': 'default'}
[0m22:52:12.904693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '455e68e2-7cef-49ca-ab07-54a30ff65557', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106334510>]}
[0m22:52:12.927675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '455e68e2-7cef-49ca-ab07-54a30ff65557', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1192ec270>]}
[0m22:52:12.928061 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m22:52:12.975866 [debug] [MainThread]: checksum: e63134dccc1251cfb572caf0e4aa952f030c125ee3634f3bf2c0a2e1bb6ae349, vars: {}, profile: , target: , version: 1.11.0b3
[0m22:52:12.976218 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:52:12.976354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '455e68e2-7cef-49ca-ab07-54a30ff65557', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1191e7a50>]}
[0m22:52:12.977896 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'models' in "<unicode string>", line 14, column 1 in file
`models/staging/schema.yml`
[0m22:52:12.978064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '455e68e2-7cef-49ca-ab07-54a30ff65557', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119299a90>]}
[0m22:52:13.376354 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.stock_analytics.stg_market_forecast' (models/staging/stg_market_forecast.sql) depends on a source named 'analytics.MARKET_DATA' which was not found
[0m22:52:13.376683 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m22:52:13.380707 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": false, "command_wall_clock_time": 1.2150688, "process_in_blocks": "0", "process_kernel_time": 0.254475, "process_mem_max_rss": "227524608", "process_out_blocks": "0", "process_user_time": 1.355466}
[0m22:52:13.380867 [debug] [MainThread]: Command `dbt compile` failed at 22:52:13.380829 after 1.22 seconds
[0m22:52:13.381010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107413e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1198acf30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119233a00>]}
[0m22:52:13.381129 [debug] [MainThread]: Flushing usage events
[0m22:52:13.689903 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:52:48.447592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106297e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107813b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107813d90>]}


============================== 22:52:48.449930 | 24fe0693-69c4-4469-987f-2a4b9fbbe5ef ==============================
[0m22:52:48.449930 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m22:52:48.450176 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/Users/rahulmohandevi/.dbt', 'log_format': 'default', 'empty': 'None', 'log_path': '/Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/logs', 'version_check': 'True', 'log_cache_events': 'False', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'debug': 'False', 'warn_error': 'None', 'static_parser': 'True', 'use_colors': 'True', 'no_print': 'None', 'cache_selected_only': 'False', 'quiet': 'False', 'write_json': 'True', 'printer_width': '80', 'introspect': 'True', 'invocation_command': 'dbt test -s stg_market_data stg_market_forecast', 'partial_parse': 'True', 'target_path': 'None', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m22:52:49.139572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '24fe0693-69c4-4469-987f-2a4b9fbbe5ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106640510>]}
[0m22:52:49.162214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '24fe0693-69c4-4469-987f-2a4b9fbbe5ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f368270>]}
[0m22:52:49.162831 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m22:52:49.213316 [debug] [MainThread]: checksum: e63134dccc1251cfb572caf0e4aa952f030c125ee3634f3bf2c0a2e1bb6ae349, vars: {}, profile: , target: , version: 1.11.0b3
[0m22:52:49.214270 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:52:49.214486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '24fe0693-69c4-4469-987f-2a4b9fbbe5ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f263a50>]}
[0m22:52:49.216310 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'models' in "<unicode string>", line 14, column 1 in file
`models/staging/schema.yml`
[0m22:52:49.216513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '24fe0693-69c4-4469-987f-2a4b9fbbe5ef', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f315a90>]}
[0m22:52:49.615798 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.stock_analytics.stg_market_forecast' (models/staging/stg_market_forecast.sql) depends on a source named 'analytics.MARKET_DATA' which was not found
[0m22:52:49.616124 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m22:52:49.620296 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 1.2001818, "process_in_blocks": "0", "process_kernel_time": 0.237243, "process_mem_max_rss": "223035392", "process_out_blocks": "0", "process_user_time": 1.321341}
[0m22:52:49.620493 [debug] [MainThread]: Command `dbt test` failed at 22:52:49.620452 after 1.20 seconds
[0m22:52:49.620640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10771fe70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f8f50f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f2afa00>]}
[0m22:52:49.620762 [debug] [MainThread]: Flushing usage events
[0m22:52:49.974656 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:55:01.903100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106793e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c23b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c23d90>]}


============================== 22:55:01.905539 | 022a19a6-4dc0-4427-b07c-184e37a9c7e3 ==============================
[0m22:55:01.905539 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m22:55:01.905819 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'indirect_selection': 'eager', 'fail_fast': 'False', 'empty': 'False', 'warn_error': 'None', 'use_experimental_parser': 'False', 'introspect': 'True', 'log_path': '/Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/logs', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'invocation_command': 'dbt compile', 'write_json': 'True', 'target_path': 'None', 'version_check': 'True', 'no_print': 'None', 'profiles_dir': '/Users/rahulmohandevi/.dbt', 'use_colors': 'True', 'partial_parse': 'True', 'static_parser': 'True', 'debug': 'False', 'printer_width': '80', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m22:55:02.517947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '022a19a6-4dc0-4427-b07c-184e37a9c7e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d3c510>]}
[0m22:55:02.540990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '022a19a6-4dc0-4427-b07c-184e37a9c7e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123aec270>]}
[0m22:55:02.541414 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m22:55:02.589129 [debug] [MainThread]: checksum: e63134dccc1251cfb572caf0e4aa952f030c125ee3634f3bf2c0a2e1bb6ae349, vars: {}, profile: , target: , version: 1.11.0b3
[0m22:55:02.589477 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:55:02.589613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '022a19a6-4dc0-4427-b07c-184e37a9c7e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1239e7a50>]}
[0m22:55:02.987367 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.stock_analytics.stg_market_forecast' (models/staging/stg_market_forecast.sql) depends on a source named 'analytics.MARKET_DATA' which was not found
[0m22:55:02.991816 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": false, "command_wall_clock_time": 1.1171391, "process_in_blocks": "0", "process_kernel_time": 0.220139, "process_mem_max_rss": "224509952", "process_out_blocks": "0", "process_user_time": 1.380309}
[0m22:55:02.992004 [debug] [MainThread]: Command `dbt compile` failed at 22:55:02.991964 after 1.12 seconds
[0m22:55:02.992154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123ef27b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123ef2120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d3fe70>]}
[0m22:55:02.992288 [debug] [MainThread]: Flushing usage events
[0m22:55:03.388732 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:03:15.718585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107693e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111427b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111427d90>]}


============================== 23:03:15.721198 | c1d7ad03-f6d7-4b98-ae93-b1c67c15d925 ==============================
[0m23:03:15.721198 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m23:03:15.721481 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'static_parser': 'True', 'quiet': 'False', 'write_json': 'True', 'indirect_selection': 'eager', 'profiles_dir': '/Users/rahulmohandevi/.dbt', 'log_path': '/Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/logs', 'use_colors': 'True', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'debug': 'False', 'version_check': 'True', 'no_print': 'None', 'invocation_command': 'dbt clean', 'log_cache_events': 'False', 'printer_width': '80', 'log_format': 'default', 'empty': 'None', 'target_path': 'None'}
[0m23:03:15.817613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c1d7ad03-f6d7-4b98-ae93-b1c67c15d925', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e3c510>]}
[0m23:03:15.827357 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.13769113, "process_in_blocks": "0", "process_kernel_time": 0.12445, "process_mem_max_rss": "123797504", "process_out_blocks": "0", "process_user_time": 0.574644}
[0m23:03:15.827518 [debug] [MainThread]: Command `dbt clean` succeeded at 23:03:15.827482 after 0.14 seconds
[0m23:03:15.827645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115e4380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115e47c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115d9d50>]}
[0m23:03:15.827755 [debug] [MainThread]: Flushing usage events
[0m23:03:16.184236 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:03:25.749425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107947e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ec3b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ec3d90>]}


============================== 23:03:25.751630 | c7be48e6-25d4-4dc3-b0a3-51be9bd41be9 ==============================
[0m23:03:25.751630 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m23:03:25.751872 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'indirect_selection': 'eager', 'log_format': 'default', 'quiet': 'False', 'write_json': 'True', 'static_parser': 'True', 'empty': 'None', 'use_colors': 'True', 'profiles_dir': '/Users/rahulmohandevi/.dbt', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'fail_fast': 'False', 'cache_selected_only': 'False', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt deps', 'introspect': 'True', 'debug': 'False', 'printer_width': '80', 'version_check': 'True', 'target_path': 'None', 'log_path': '/Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/logs'}
[0m23:03:25.806599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c7be48e6-25d4-4dc3-b0a3-51be9bd41be9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d00510>]}
[0m23:03:25.816206 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m23:03:25.816507 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m23:03:25.817793 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.09469225, "process_in_blocks": "0", "process_kernel_time": 0.105942, "process_mem_max_rss": "121454592", "process_out_blocks": "0", "process_user_time": 0.57688}
[0m23:03:25.817944 [debug] [MainThread]: Command `dbt deps` succeeded at 23:03:25.817907 after 0.09 seconds
[0m23:03:25.818058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109088c00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109089260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10881fe50>]}
[0m23:03:25.818163 [debug] [MainThread]: Flushing usage events
[0m23:03:26.128290 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:03:38.110447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105993e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107613b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107613d90>]}


============================== 23:03:38.112697 | 8894397f-1df7-46db-aa84-b86ded2d0d91 ==============================
[0m23:03:38.112697 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m23:03:38.112944 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'indirect_selection': 'eager', 'version_check': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'introspect': 'True', 'quiet': 'False', 'target_path': 'None', 'profiles_dir': '/Users/rahulmohandevi/.dbt', 'partial_parse': 'False', 'use_colors': 'True', 'invocation_command': 'dbt compile --no-partial-parse', 'warn_error': 'None', 'log_path': '/Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'static_parser': 'True', 'empty': 'False', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'write_json': 'True', 'printer_width': '80'}
[0m23:03:38.782679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8894397f-1df7-46db-aa84-b86ded2d0d91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10603c510>]}
[0m23:03:38.805296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8894397f-1df7-46db-aa84-b86ded2d0d91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1190ec270>]}
[0m23:03:38.805886 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m23:03:38.854335 [debug] [MainThread]: checksum: e63134dccc1251cfb572caf0e4aa952f030c125ee3634f3bf2c0a2e1bb6ae349, vars: {}, profile: , target: , version: 1.11.0b3
[0m23:03:38.854685 [debug] [MainThread]: Partial parsing not enabled
[0m23:03:39.329508 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stock_analytics.example
[0m23:03:39.333035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8894397f-1df7-46db-aa84-b86ded2d0d91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119672f50>]}
[0m23:03:39.364231 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/target/manifest.json
[0m23:03:39.365372 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/target/semantic_manifest.json
[0m23:03:39.374170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8894397f-1df7-46db-aa84-b86ded2d0d91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1190998b0>]}
[0m23:03:39.374339 [info ] [MainThread]: Found 2 models, 6 data tests, 2 sources, 492 macros
[0m23:03:39.374454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8894397f-1df7-46db-aa84-b86ded2d0d91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1198de510>]}
[0m23:03:39.375420 [info ] [MainThread]: 
[0m23:03:39.375542 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:03:39.375632 [info ] [MainThread]: 
[0m23:03:39.375812 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:03:39.377412 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_OSTRICH_PUBLIC'
[0m23:03:39.441183 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_OSTRICH_PUBLIC"
[0m23:03:39.441363 [debug] [ThreadPool]: On list_USER_DB_OSTRICH_PUBLIC: show objects in USER_DB_OSTRICH.PUBLIC
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_OSTRICH_PUBLIC"} */;
[0m23:03:39.441456 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:03:42.085171 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 2.644 seconds
[0m23:03:42.088803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8894397f-1df7-46db-aa84-b86ded2d0d91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b84d4a0>]}
[0m23:03:42.094959 [debug] [Thread-1 (]: Began running node model.stock_analytics.stg_market_data
[0m23:03:42.095623 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_OSTRICH_PUBLIC, now model.stock_analytics.stg_market_data)
[0m23:03:42.096073 [debug] [Thread-1 (]: Began compiling node model.stock_analytics.stg_market_data
[0m23:03:42.104552 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_analytics.stg_market_data"
[0m23:03:42.105698 [debug] [Thread-1 (]: Began executing node model.stock_analytics.stg_market_data
[0m23:03:42.106295 [debug] [Thread-1 (]: Finished running node model.stock_analytics.stg_market_data
[0m23:03:42.106609 [debug] [Thread-1 (]: Began running node model.stock_analytics.stg_market_forecast
[0m23:03:42.107029 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_analytics.stg_market_data, now model.stock_analytics.stg_market_forecast)
[0m23:03:42.107455 [debug] [Thread-1 (]: Began compiling node model.stock_analytics.stg_market_forecast
[0m23:03:42.117853 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_analytics.stg_market_forecast"
[0m23:03:42.118462 [debug] [Thread-1 (]: Began executing node model.stock_analytics.stg_market_forecast
[0m23:03:42.118848 [debug] [Thread-1 (]: Finished running node model.stock_analytics.stg_market_forecast
[0m23:03:42.119066 [debug] [Thread-1 (]: Began running node test.stock_analytics.not_null_stg_market_data_date.fb73c94489
[0m23:03:42.119327 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_analytics.stg_market_forecast, now test.stock_analytics.not_null_stg_market_data_date.fb73c94489)
[0m23:03:42.119611 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.not_null_stg_market_data_date.fb73c94489
[0m23:03:42.126503 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.not_null_stg_market_data_date.fb73c94489"
[0m23:03:42.126959 [debug] [Thread-1 (]: Began executing node test.stock_analytics.not_null_stg_market_data_date.fb73c94489
[0m23:03:42.127300 [debug] [Thread-1 (]: Finished running node test.stock_analytics.not_null_stg_market_data_date.fb73c94489
[0m23:03:42.127478 [debug] [Thread-1 (]: Began running node test.stock_analytics.not_null_stg_market_data_symbol.478198cf66
[0m23:03:42.127663 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_stg_market_data_date.fb73c94489, now test.stock_analytics.not_null_stg_market_data_symbol.478198cf66)
[0m23:03:42.127821 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.not_null_stg_market_data_symbol.478198cf66
[0m23:03:42.129838 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.not_null_stg_market_data_symbol.478198cf66"
[0m23:03:42.130142 [debug] [Thread-1 (]: Began executing node test.stock_analytics.not_null_stg_market_data_symbol.478198cf66
[0m23:03:42.130425 [debug] [Thread-1 (]: Finished running node test.stock_analytics.not_null_stg_market_data_symbol.478198cf66
[0m23:03:42.130590 [debug] [Thread-1 (]: Began running node test.stock_analytics.unique_stg_market_data_symbol__date.3e1fafb254
[0m23:03:42.130759 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_stg_market_data_symbol.478198cf66, now test.stock_analytics.unique_stg_market_data_symbol__date.3e1fafb254)
[0m23:03:42.130915 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.unique_stg_market_data_symbol__date.3e1fafb254
[0m23:03:42.134159 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.unique_stg_market_data_symbol__date.3e1fafb254"
[0m23:03:42.134428 [debug] [Thread-1 (]: Began executing node test.stock_analytics.unique_stg_market_data_symbol__date.3e1fafb254
[0m23:03:42.134684 [debug] [Thread-1 (]: Finished running node test.stock_analytics.unique_stg_market_data_symbol__date.3e1fafb254
[0m23:03:42.134838 [debug] [Thread-1 (]: Began running node test.stock_analytics.not_null_stg_market_forecast_date.ca0f3ba00f
[0m23:03:42.134991 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.unique_stg_market_data_symbol__date.3e1fafb254, now test.stock_analytics.not_null_stg_market_forecast_date.ca0f3ba00f)
[0m23:03:42.135133 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.not_null_stg_market_forecast_date.ca0f3ba00f
[0m23:03:42.136871 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.not_null_stg_market_forecast_date.ca0f3ba00f"
[0m23:03:42.137190 [debug] [Thread-1 (]: Began executing node test.stock_analytics.not_null_stg_market_forecast_date.ca0f3ba00f
[0m23:03:42.137443 [debug] [Thread-1 (]: Finished running node test.stock_analytics.not_null_stg_market_forecast_date.ca0f3ba00f
[0m23:03:42.137592 [debug] [Thread-1 (]: Began running node test.stock_analytics.not_null_stg_market_forecast_symbol.d304415e8d
[0m23:03:42.137745 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_stg_market_forecast_date.ca0f3ba00f, now test.stock_analytics.not_null_stg_market_forecast_symbol.d304415e8d)
[0m23:03:42.137885 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.not_null_stg_market_forecast_symbol.d304415e8d
[0m23:03:42.139336 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.not_null_stg_market_forecast_symbol.d304415e8d"
[0m23:03:42.139570 [debug] [Thread-1 (]: Began executing node test.stock_analytics.not_null_stg_market_forecast_symbol.d304415e8d
[0m23:03:42.139799 [debug] [Thread-1 (]: Finished running node test.stock_analytics.not_null_stg_market_forecast_symbol.d304415e8d
[0m23:03:42.139938 [debug] [Thread-1 (]: Began running node test.stock_analytics.unique_stg_market_forecast_symbol__date.d55b034665
[0m23:03:42.140080 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_stg_market_forecast_symbol.d304415e8d, now test.stock_analytics.unique_stg_market_forecast_symbol__date.d55b034665)
[0m23:03:42.140210 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.unique_stg_market_forecast_symbol__date.d55b034665
[0m23:03:42.141784 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.unique_stg_market_forecast_symbol__date.d55b034665"
[0m23:03:42.142015 [debug] [Thread-1 (]: Began executing node test.stock_analytics.unique_stg_market_forecast_symbol__date.d55b034665
[0m23:03:42.142243 [debug] [Thread-1 (]: Finished running node test.stock_analytics.unique_stg_market_forecast_symbol__date.d55b034665
[0m23:03:42.142713 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:03:42.142886 [debug] [MainThread]: Connection 'test.stock_analytics.unique_stg_market_forecast_symbol__date.d55b034665' was left open.
[0m23:03:42.143027 [debug] [MainThread]: On test.stock_analytics.unique_stg_market_forecast_symbol__date.d55b034665: Close
[0m23:03:42.305498 [debug] [MainThread]: Command end result
[0m23:03:42.324088 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/target/manifest.json
[0m23:03:42.325352 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/target/semantic_manifest.json
[0m23:03:42.329960 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/target/run_results.json
[0m23:03:42.335580 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 4.2521234, "process_in_blocks": "0", "process_kernel_time": 0.284848, "process_mem_max_rss": "248086528", "process_out_blocks": "0", "process_user_time": 1.638208}
[0m23:03:42.335826 [debug] [MainThread]: Command `dbt compile` succeeded at 23:03:42.335773 after 4.25 seconds
[0m23:03:42.336041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f425d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b933b70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b931020>]}
[0m23:03:42.336232 [debug] [MainThread]: Flushing usage events
[0m23:03:42.641875 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:07:06.628296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106333e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078afb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078afd90>]}


============================== 23:07:06.630743 | d2cf62ef-0716-4f2c-bcda-c50010e31e31 ==============================
[0m23:07:06.630743 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m23:07:06.631001 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'target_path': 'None', 'indirect_selection': 'eager', 'debug': 'False', 'write_json': 'True', 'fail_fast': 'False', 'log_path': '/Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/logs', 'printer_width': '80', 'cache_selected_only': 'False', 'empty': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'quiet': 'False', 'use_colors': 'True', 'profiles_dir': '/Users/rahulmohandevi/.dbt', 'partial_parse': 'True', 'introspect': 'True', 'warn_error': 'None', 'invocation_command': 'dbt clean', 'version_check': 'True', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False'}
[0m23:07:06.729332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd2cf62ef-0716-4f2c-bcda-c50010e31e31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066e8510>]}
[0m23:07:06.740687 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.14607154, "process_in_blocks": "0", "process_kernel_time": 0.134334, "process_mem_max_rss": "121356288", "process_out_blocks": "0", "process_user_time": 0.567094}
[0m23:07:06.740848 [debug] [MainThread]: Command `dbt clean` succeeded at 23:07:06.740808 after 0.15 seconds
[0m23:07:06.740983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a6c380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a6c7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a61d50>]}
[0m23:07:06.741096 [debug] [MainThread]: Flushing usage events
[0m23:07:07.088100 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:07:56.025254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106433e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108203b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108203d90>]}


============================== 23:07:56.027657 | e636fd70-1984-4bcb-8f29-9ff6f944ae19 ==============================
[0m23:07:56.027657 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m23:07:56.027899 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'log_path': '/Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/logs', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'fail_fast': 'False', 'quiet': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'printer_width': '80', 'invocation_command': 'dbt deps', 'profiles_dir': '/Users/rahulmohandevi/.dbt', 'use_colors': 'True', 'debug': 'False', 'warn_error': 'None', 'version_check': 'True', 'empty': 'None', 'cache_selected_only': 'False', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'write_json': 'True', 'log_format': 'default', 'target_path': 'None'}
[0m23:07:56.083126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e636fd70-1984-4bcb-8f29-9ff6f944ae19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c3c510>]}
[0m23:07:56.092175 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m23:07:56.092482 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m23:07:56.094198 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.098424084, "process_in_blocks": "0", "process_kernel_time": 0.135218, "process_mem_max_rss": "123338752", "process_out_blocks": "0", "process_user_time": 0.57386}
[0m23:07:56.094349 [debug] [MainThread]: Command `dbt deps` succeeded at 23:07:56.094311 after 0.10 seconds
[0m23:07:56.094468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083c8c00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083c9260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10803bd50>]}
[0m23:07:56.094580 [debug] [MainThread]: Flushing usage events
[0m23:07:56.424825 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:08:09.567571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10835fe00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098dfb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098dfd90>]}


============================== 23:08:09.570028 | 63cc9a8a-c1ac-4e28-90d4-1a92a9435ff8 ==============================
[0m23:08:09.570028 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m23:08:09.570287 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'log_format': 'default', 'log_path': '/Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/logs', 'partial_parse': 'False', 'target_path': 'None', 'version_check': 'True', 'debug': 'False', 'quiet': 'False', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'printer_width': '80', 'warn_error': 'True', 'use_colors': 'True', 'profiles_dir': '/Users/rahulmohandevi/.dbt', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'indirect_selection': 'eager', 'invocation_command': 'dbt compile --no-partial-parse --warn-error', 'use_experimental_parser': 'False', 'no_print': 'None', 'introspect': 'True', 'fail_fast': 'False'}
[0m23:08:10.319096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '63cc9a8a-c1ac-4e28-90d4-1a92a9435ff8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10870c510>]}
[0m23:08:10.342151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '63cc9a8a-c1ac-4e28-90d4-1a92a9435ff8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111420270>]}
[0m23:08:10.342751 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m23:08:10.393511 [debug] [MainThread]: checksum: e63134dccc1251cfb572caf0e4aa952f030c125ee3634f3bf2c0a2e1bb6ae349, vars: {}, profile: , target: , version: 1.11.0b3
[0m23:08:10.393865 [debug] [MainThread]: Partial parsing not enabled
[0m23:08:10.868285 [error] [MainThread]: Encountered an error:
Compilation Error
  [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
  There are 1 unused configuration paths:
  - models.stock_analytics.marts
[0m23:08:10.872573 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": false, "command_wall_clock_time": 1.3334297, "process_in_blocks": "0", "process_kernel_time": 0.245295, "process_mem_max_rss": "228589568", "process_out_blocks": "0", "process_user_time": 1.407416}
[0m23:08:10.872761 [debug] [MainThread]: Command `dbt compile` failed at 23:08:10.872715 after 1.33 seconds
[0m23:08:10.872914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118a3050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118a2d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113ccc80>]}
[0m23:08:10.873044 [debug] [MainThread]: Flushing usage events
[0m23:08:11.182419 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:08:30.367425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c93e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10820fb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10820fd90>]}


============================== 23:08:30.369698 | 7b445bfc-e8ff-4412-b688-2bf1c2643b59 ==============================
[0m23:08:30.369698 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m23:08:30.369942 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'log_cache_events': 'False', 'write_json': 'True', 'log_path': '/Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/logs', 'target_path': 'None', 'printer_width': '80', 'use_experimental_parser': 'False', 'introspect': 'True', 'partial_parse': 'True', 'debug': 'False', 'quiet': 'False', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'static_parser': 'True', 'no_print': 'None', 'empty': 'None', 'version_check': 'True', 'invocation_command': 'dbt ls --resource-type source', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/Users/rahulmohandevi/.dbt', 'fail_fast': 'False', 'use_colors': 'True'}
[0m23:08:31.049597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7b445bfc-e8ff-4412-b688-2bf1c2643b59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10643c510>]}
[0m23:08:31.072787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7b445bfc-e8ff-4412-b688-2bf1c2643b59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1195e4380>]}
[0m23:08:31.073706 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m23:08:31.124557 [debug] [MainThread]: checksum: e63134dccc1251cfb572caf0e4aa952f030c125ee3634f3bf2c0a2e1bb6ae349, vars: {}, profile: , target: , version: 1.11.0b3
[0m23:08:31.188856 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:08:31.189025 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:08:31.191125 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stock_analytics.marts
[0m23:08:31.205582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7b445bfc-e8ff-4412-b688-2bf1c2643b59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11994a350>]}
[0m23:08:31.238026 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/target/manifest.json
[0m23:08:31.239081 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/target/semantic_manifest.json
[0m23:08:31.248828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7b445bfc-e8ff-4412-b688-2bf1c2643b59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11959be30>]}
[0m23:08:31.249054 [info ] [MainThread]: Found 2 models, 6 data tests, 2 sources, 492 macros
[0m23:08:31.249173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7b445bfc-e8ff-4412-b688-2bf1c2643b59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119b80670>]}
[0m23:08:31.249545 [info ] [MainThread]: source:stock_analytics.analytics.MARKET_DATA
[0m23:08:31.249659 [info ] [MainThread]: source:stock_analytics.raw.MARKET_DATA
[0m23:08:31.253614 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 0.9135852, "process_in_blocks": "0", "process_kernel_time": 0.234776, "process_mem_max_rss": "216104960", "process_out_blocks": "0", "process_user_time": 1.045417}
[0m23:08:31.253825 [debug] [MainThread]: Command `dbt ls` succeeded at 23:08:31.253778 after 0.91 seconds
[0m23:08:31.253983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119b64530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10801e5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119ac2f90>]}
[0m23:08:31.254126 [debug] [MainThread]: Flushing usage events
[0m23:08:31.604040 [debug] [MainThread]: An error was encountered while trying to flush usage events
{"data": {"kwargs": "{'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108327e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098a7d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098a7ed0>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "49f02202-ecce-4818-84eb-74382af7bcbc", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108327e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098a7d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098a7ed0>]}", "name": "SendingEvent", "pid": 48047, "thread": "MainThread", "ts": "2025-11-21T07:14:13.847561Z"}}
{"data": {"log_version": 3, "version": "=1.11.0-b3"}, "info": {"category": "", "code": "A001", "extra": {}, "invocation_id": "49f02202-ecce-4818-84eb-74382af7bcbc", "level": "info", "msg": "Running with dbt=1.11.0-b3", "name": "MainReportVersion", "pid": 48047, "thread": "MainThread", "ts": "2025-11-21T07:14:13.850290Z"}}
{"data": {"args": {"cache_selected_only": "False", "debug": "False", "empty": "False", "fail_fast": "False", "indirect_selection": "eager", "introspect": "True", "invocation_command": "dbt run --select stg_market_data --log-format json", "log_cache_events": "False", "log_format": "json", "log_path": "/Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/logs", "no_print": "None", "partial_parse": "True", "printer_width": "80", "profiles_dir": "/Users/rahulmohandevi/.dbt", "quiet": "False", "send_anonymous_usage_stats": "True", "static_parser": "True", "target_path": "None", "use_colors": "True", "use_experimental_parser": "False", "version_check": "True", "warn_error": "None", "warn_error_options": "WarnErrorOptionsV2(error=[], warn=[], silence=[])", "write_json": "True"}}, "info": {"category": "", "code": "A002", "extra": {}, "invocation_id": "49f02202-ecce-4818-84eb-74382af7bcbc", "level": "debug", "msg": "running dbt with arguments {'introspect': 'True', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'empty': 'False', 'partial_parse': 'True', 'debug': 'False', 'profiles_dir': '/Users/rahulmohandevi/.dbt', 'log_format': 'json', 'log_cache_events': 'False', 'target_path': 'None', 'version_check': 'True', 'warn_error': 'None', 'quiet': 'False', 'cache_selected_only': 'False', 'use_colors': 'True', 'invocation_command': 'dbt run --select stg_market_data --log-format json', 'write_json': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/logs', 'static_parser': 'True', 'no_print': 'None', 'fail_fast': 'False'}", "name": "MainReportArgs", "pid": 48047, "thread": "MainThread", "ts": "2025-11-21T07:14:13.850559Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'project_id', 'label': '49f02202-ecce-4818-84eb-74382af7bcbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086d0510>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "49f02202-ecce-4818-84eb-74382af7bcbc", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '49f02202-ecce-4818-84eb-74382af7bcbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086d0510>]}", "name": "SendingEvent", "pid": 48047, "thread": "MainThread", "ts": "2025-11-21T07:14:14.601651Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'adapter_info', 'label': '49f02202-ecce-4818-84eb-74382af7bcbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111380270>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "49f02202-ecce-4818-84eb-74382af7bcbc", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '49f02202-ecce-4818-84eb-74382af7bcbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111380270>]}", "name": "SendingEvent", "pid": 48047, "thread": "MainThread", "ts": "2025-11-21T07:14:14.624936Z"}}
{"data": {"adapter_name": "snowflake", "adapter_version": "=1.10.2"}, "info": {"category": "", "code": "E034", "extra": {}, "invocation_id": "49f02202-ecce-4818-84eb-74382af7bcbc", "level": "info", "msg": "Registered adapter: snowflake=1.10.2", "name": "AdapterRegistered", "pid": 48047, "thread": "MainThread", "ts": "2025-11-21T07:14:14.625504Z"}}
{"data": {"checksum": "e63134dccc1251cfb572caf0e4aa952f030c125ee3634f3bf2c0a2e1bb6ae349", "profile": "", "target": "", "vars": "{}", "version": "1.11.0b3"}, "info": {"category": "", "code": "I025", "extra": {}, "invocation_id": "49f02202-ecce-4818-84eb-74382af7bcbc", "level": "debug", "msg": "checksum: e63134dccc1251cfb572caf0e4aa952f030c125ee3634f3bf2c0a2e1bb6ae349, vars: {}, profile: , target: , version: 1.11.0b3", "name": "StateCheckVarsHash", "pid": 48047, "thread": "MainThread", "ts": "2025-11-21T07:14:14.678098Z"}}
{"data": {"added": 0, "changed": 0, "deleted": 0}, "info": {"category": "", "code": "I040", "extra": {}, "invocation_id": "49f02202-ecce-4818-84eb-74382af7bcbc", "level": "debug", "msg": "Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.", "name": "PartialParsingEnabled", "pid": 48047, "thread": "MainThread", "ts": "2025-11-21T07:14:14.747733Z"}}
{"data": {}, "info": {"category": "", "code": "I017", "extra": {}, "invocation_id": "49f02202-ecce-4818-84eb-74382af7bcbc", "level": "debug", "msg": "Partial parsing enabled, no changes found, skipping parsing", "name": "PartialParsingSkipParsing", "pid": 48047, "thread": "MainThread", "ts": "2025-11-21T07:14:14.747965Z"}}
{"data": {"unused_config_paths": ["models.stock_analytics.marts"]}, "info": {"category": "", "code": "I051", "extra": {}, "invocation_id": "49f02202-ecce-4818-84eb-74382af7bcbc", "level": "warn", "msg": "[\u001b[33mWARNING\u001b[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.\nThere are 1 unused configuration paths:\n- models.stock_analytics.marts", "name": "UnusedResourceConfigPath", "pid": 48047, "thread": "MainThread", "ts": "2025-11-21T07:14:14.750099Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'load_project', 'label': '49f02202-ecce-4818-84eb-74382af7bcbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111792250>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "49f02202-ecce-4818-84eb-74382af7bcbc", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '49f02202-ecce-4818-84eb-74382af7bcbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111792250>]}", "name": "SendingEvent", "pid": 48047, "thread": "MainThread", "ts": "2025-11-21T07:14:14.764485Z"}}
{"data": {"artifact_path": "/Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/target/manifest.json", "artifact_type": "WritableManifest"}, "info": {"category": "", "code": "P001", "extra": {}, "invocation_id": "49f02202-ecce-4818-84eb-74382af7bcbc", "level": "debug", "msg": "Wrote artifact WritableManifest to /Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/target/manifest.json", "name": "ArtifactWritten", "pid": 48047, "thread": "MainThread", "ts": "2025-11-21T07:14:14.796429Z"}}
{"data": {"artifact_path": "/Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/target/semantic_manifest.json", "artifact_type": "SemanticManifest"}, "info": {"category": "", "code": "P001", "extra": {}, "invocation_id": "49f02202-ecce-4818-84eb-74382af7bcbc", "level": "debug", "msg": "Wrote artifact SemanticManifest to /Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/target/semantic_manifest.json", "name": "ArtifactWritten", "pid": 48047, "thread": "MainThread", "ts": "2025-11-21T07:14:14.797501Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'resource_counts', 'label': '49f02202-ecce-4818-84eb-74382af7bcbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11132d400>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "49f02202-ecce-4818-84eb-74382af7bcbc", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '49f02202-ecce-4818-84eb-74382af7bcbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11132d400>]}", "name": "SendingEvent", "pid": 48047, "thread": "MainThread", "ts": "2025-11-21T07:14:14.807508Z"}}
{"data": {"stat_line": "2 models, 6 data tests, 2 sources, 492 macros"}, "info": {"category": "", "code": "W006", "extra": {}, "invocation_id": "49f02202-ecce-4818-84eb-74382af7bcbc", "level": "info", "msg": "Found 2 models, 6 data tests, 2 sources, 492 macros", "name": "FoundStats", "pid": 48047, "thread": "MainThread", "ts": "2025-11-21T07:14:14.807723Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'runnable_timing', 'label': '49f02202-ecce-4818-84eb-74382af7bcbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1119d0e50>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "49f02202-ecce-4818-84eb-74382af7bcbc", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49f02202-ecce-4818-84eb-74382af7bcbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1119d0e50>]}", "name": "SendingEvent", "pid": 48047, "thread": "MainThread", "ts": "2025-11-21T07:14:14.807863Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "49f02202-ecce-4818-84eb-74382af7bcbc", "level": "info", "msg": "", "name": "Formatting", "pid": 48047, "thread": "MainThread", "ts": "2025-11-21T07:14:14.808457Z"}}
{"data": {"node_count": 1, "num_threads": 1, "target_name": "dev"}, "info": {"category": "", "code": "Q027", "extra": {}, "invocation_id": "49f02202-ecce-4818-84eb-74382af7bcbc", "level": "info", "msg": "Concurrency: 1 threads (target='dev')", "name": "ConcurrencyLine", "pid": 48047, "thread": "MainThread", "ts": "2025-11-21T07:14:14.808595Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "49f02202-ecce-4818-84eb-74382af7bcbc", "level": "info", "msg": "", "name": "Formatting", "pid": 48047, "thread": "MainThread", "ts": "2025-11-21T07:14:14.808707Z"}}
{"data": {"conn_name": "master", "conn_type": "snowflake"}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "49f02202-ecce-4818-84eb-74382af7bcbc", "level": "debug", "msg": "Acquiring new snowflake connection 'master'", "name": "NewConnection", "pid": 48047, "thread": "MainThread", "ts": "2025-11-21T07:14:14.808899Z"}}
{"data": {"conn_name": "list_USER_DB_OSTRICH", "conn_type": "snowflake"}, "info": {"category": "", "code": "E005", "extra": {}, "invocation_id": "49f02202-ecce-4818-84eb-74382af7bcbc", "level": "debug", "msg": "Acquiring new snowflake connection 'list_USER_DB_OSTRICH'", "name": "NewConnection", "pid": 48047, "thread": "ThreadPoolExecutor-0_0", "ts": "2025-11-21T07:14:14.809259Z"}}
{"data": {"conn_name": "list_USER_DB_OSTRICH", "conn_type": "snowflake"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "49f02202-ecce-4818-84eb-74382af7bcbc", "level": "debug", "msg": "Using snowflake connection \"list_USER_DB_OSTRICH\"", "name": "ConnectionUsed", "pid": 48047, "thread": "ThreadPoolExecutor-0_0", "ts": "2025-11-21T07:14:14.869178Z"}}
{"data": {"conn_name": "list_USER_DB_OSTRICH", "sql": "show terse schemas in database USER_DB_OSTRICH\n    limit 10000\n/* {\"app\": \"dbt\", \"dbt_version\": \"1.11.0b3\", \"profile_name\": \"stock_analytics\", \"target_name\": \"dev\", \"connection_name\": \"list_USER_DB_OSTRICH\"} */"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "49f02202-ecce-4818-84eb-74382af7bcbc", "level": "debug", "msg": "On list_USER_DB_OSTRICH: show terse schemas in database USER_DB_OSTRICH\n    limit 10000\n/* {\"app\": \"dbt\", \"dbt_version\": \"1.11.0b3\", \"profile_name\": \"stock_analytics\", \"target_name\": \"dev\", \"connection_name\": \"list_USER_DB_OSTRICH\"} */", "name": "SQLQuery", "pid": 48047, "thread": "ThreadPoolExecutor-0_0", "ts": "2025-11-21T07:14:14.869404Z"}}
{"data": {"connection_state": "init"}, "info": {"category": "", "code": "E037", "extra": {}, "invocation_id": "49f02202-ecce-4818-84eb-74382af7bcbc", "level": "debug", "msg": "Opening a new connection, currently in state init", "name": "NewConnectionOpening", "pid": 48047, "thread": "ThreadPoolExecutor-0_0", "ts": "2025-11-21T07:14:14.869549Z"}}
{"data": {"elapsed": 2.6083996, "query_id": "01c088d2-0307-1716-000f-c0df00871092", "status": "SUCCESS 7"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "49f02202-ecce-4818-84eb-74382af7bcbc", "level": "debug", "msg": "SQL status: SUCCESS 7 in 2.608 seconds", "name": "SQLQueryStatus", "pid": 48047, "thread": "ThreadPoolExecutor-0_0", "ts": "2025-11-21T07:14:17.478145Z"}}
{"data": {"conn_name": "create_USER_DB_OSTRICH_PUBLIC_STAGING", "orig_conn_name": "list_USER_DB_OSTRICH"}, "info": {"category": "", "code": "E006", "extra": {}, "invocation_id": "49f02202-ecce-4818-84eb-74382af7bcbc", "level": "debug", "msg": "Re-using an available connection from the pool (formerly list_USER_DB_OSTRICH, now create_USER_DB_OSTRICH_PUBLIC_STAGING)", "name": "ConnectionReused", "pid": 48047, "thread": "ThreadPoolExecutor-0_0", "ts": "2025-11-21T07:14:17.481821Z"}}
{"data": {"relation": {"database": "USER_DB_OSTRICH", "identifier": "", "schema": "PUBLIC_STAGING"}}, "info": {"category": "", "code": "E020", "extra": {}, "invocation_id": "49f02202-ecce-4818-84eb-74382af7bcbc", "level": "debug", "msg": "Creating schema \"database: \"USER_DB_OSTRICH\"\nschema: \"PUBLIC_STAGING\"\n\"", "name": "SchemaCreation", "pid": 48047, "thread": "ThreadPoolExecutor-0_0", "ts": "2025-11-21T07:14:17.482682Z"}}
{"data": {"conn_name": "create_USER_DB_OSTRICH_PUBLIC_STAGING", "conn_type": "snowflake"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "49f02202-ecce-4818-84eb-74382af7bcbc", "level": "debug", "msg": "Using snowflake connection \"create_USER_DB_OSTRICH_PUBLIC_STAGING\"", "name": "ConnectionUsed", "pid": 48047, "thread": "ThreadPoolExecutor-0_0", "ts": "2025-11-21T07:14:17.489783Z"}}
{"data": {"conn_name": "create_USER_DB_OSTRICH_PUBLIC_STAGING", "sql": "create schema if not exists USER_DB_OSTRICH.PUBLIC_STAGING\n/* {\"app\": \"dbt\", \"dbt_version\": \"1.11.0b3\", \"profile_name\": \"stock_analytics\", \"target_name\": \"dev\", \"connection_name\": \"create_USER_DB_OSTRICH_PUBLIC_STAGING\"} */"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "49f02202-ecce-4818-84eb-74382af7bcbc", "level": "debug", "msg": "On create_USER_DB_OSTRICH_PUBLIC_STAGING: create schema if not exists USER_DB_OSTRICH.PUBLIC_STAGING\n/* {\"app\": \"dbt\", \"dbt_version\": \"1.11.0b3\", \"profile_name\": \"stock_analytics\", \"target_name\": \"dev\", \"connection_name\": \"create_USER_DB_OSTRICH_PUBLIC_STAGING\"} */", "name": "SQLQuery", "pid": 48047, "thread": "ThreadPoolExecutor-0_0", "ts": "2025-11-21T07:14:17.490370Z"}}
{"data": {"elapsed": 0.12544684, "query_id": "01c088d2-0307-1800-000f-c0df008647ba", "status": "SUCCESS 1"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "49f02202-ecce-4818-84eb-74382af7bcbc", "level": "debug", "msg": "SQL status: SUCCESS 1 in 0.125 seconds", "name": "SQLQueryStatus", "pid": 48047, "thread": "ThreadPoolExecutor-0_0", "ts": "2025-11-21T07:14:17.616443Z"}}
{"data": {"conn_name": "list_USER_DB_OSTRICH_PUBLIC_STAGING", "orig_conn_name": "create_USER_DB_OSTRICH_PUBLIC_STAGING"}, "info": {"category": "", "code": "E006", "extra": {}, "invocation_id": "49f02202-ecce-4818-84eb-74382af7bcbc", "level": "debug", "msg": "Re-using an available connection from the pool (formerly create_USER_DB_OSTRICH_PUBLIC_STAGING, now list_USER_DB_OSTRICH_PUBLIC_STAGING)", "name": "ConnectionReused", "pid": 48047, "thread": "ThreadPoolExecutor-3_0", "ts": "2025-11-21T07:14:17.623637Z"}}
{"data": {"conn_name": "list_USER_DB_OSTRICH_PUBLIC_STAGING", "conn_type": "snowflake"}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "49f02202-ecce-4818-84eb-74382af7bcbc", "level": "debug", "msg": "Using snowflake connection \"list_USER_DB_OSTRICH_PUBLIC_STAGING\"", "name": "ConnectionUsed", "pid": 48047, "thread": "ThreadPoolExecutor-3_0", "ts": "2025-11-21T07:14:17.637406Z"}}
{"data": {"conn_name": "list_USER_DB_OSTRICH_PUBLIC_STAGING", "sql": "show objects in USER_DB_OSTRICH.PUBLIC_STAGING\n    limit 10000\n    \n\n/* {\"app\": \"dbt\", \"dbt_version\": \"1.11.0b3\", \"profile_name\": \"stock_analytics\", \"target_name\": \"dev\", \"connection_name\": \"list_USER_DB_OSTRICH_PUBLIC_STAGING\"} */;"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "49f02202-ecce-4818-84eb-74382af7bcbc", "level": "debug", "msg": "On list_USER_DB_OSTRICH_PUBLIC_STAGING: show objects in USER_DB_OSTRICH.PUBLIC_STAGING\n    limit 10000\n    \n\n/* {\"app\": \"dbt\", \"dbt_version\": \"1.11.0b3\", \"profile_name\": \"stock_analytics\", \"target_name\": \"dev\", \"connection_name\": \"list_USER_DB_OSTRICH_PUBLIC_STAGING\"} */;", "name": "SQLQuery", "pid": 48047, "thread": "ThreadPoolExecutor-3_0", "ts": "2025-11-21T07:14:17.637938Z"}}
{"data": {"elapsed": 0.09396288, "query_id": "01c088d2-0307-171b-000f-c0df0087010a", "status": "SUCCESS 0"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "49f02202-ecce-4818-84eb-74382af7bcbc", "level": "debug", "msg": "SQL status: SUCCESS 0 in 0.094 seconds", "name": "SQLQueryStatus", "pid": 48047, "thread": "ThreadPoolExecutor-3_0", "ts": "2025-11-21T07:14:17.732395Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'runnable_timing', 'label': '49f02202-ecce-4818-84eb-74382af7bcbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11264a680>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "49f02202-ecce-4818-84eb-74382af7bcbc", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49f02202-ecce-4818-84eb-74382af7bcbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11264a680>]}", "name": "SendingEvent", "pid": 48047, "thread": "MainThread", "ts": "2025-11-21T07:14:17.735780Z"}}
{"data": {"node_info": {"materialized": "view", "meta": {}, "node_checksum": "1594bc316b6a3b446bdf3099c5c8dc88726f1c055eabd4ff0f2ecb463d72bcd1", "node_finished_at": "", "node_name": "stg_market_data", "node_path": "staging/stg_market_data.sql", "node_relation": {"alias": "stg_market_data", "database": "USER_DB_OSTRICH", "relation_name": "USER_DB_OSTRICH.PUBLIC_STAGING.stg_market_data", "schema": "PUBLIC_STAGING"}, "node_started_at": "2025-11-21T07:14:17.740010", "node_status": "started", "resource_type": "model", "unique_id": "model.stock_analytics.stg_market_data"}}, "info": {"category": "", "code": "Q024", "extra": {}, "invocation_id": "49f02202-ecce-4818-84eb-74382af7bcbc", "level": "debug", "msg": "Began running node model.stock_analytics.stg_market_data", "name": "NodeStart", "pid": 48047, "thread": "Thread-1 (worker)", "ts": "2025-11-21T07:14:17.740210Z"}}
{"data": {"description": "sql view model PUBLIC_STAGING.stg_market_data", "index": 1, "node_info": {"materialized": "view", "meta": {}, "node_checksum": "1594bc316b6a3b446bdf3099c5c8dc88726f1c055eabd4ff0f2ecb463d72bcd1", "node_finished_at": "", "node_name": "stg_market_data", "node_path": "staging/stg_market_data.sql", "node_relation": {"alias": "stg_market_data", "database": "USER_DB_OSTRICH", "relation_name": "USER_DB_OSTRICH.PUBLIC_STAGING.stg_market_data", "schema": "PUBLIC_STAGING"}, "node_started_at": "2025-11-21T07:14:17.740010", "node_status": "started", "resource_type": "model", "unique_id": "model.stock_analytics.stg_market_data"}, "total": 1}, "info": {"category": "", "code": "Q011", "extra": {}, "invocation_id": "49f02202-ecce-4818-84eb-74382af7bcbc", "level": "info", "msg": "1 of 1 START sql view model PUBLIC_STAGING.stg_market_data ..................... [RUN]", "name": "LogStartLine", "pid": 48047, "thread": "Thread-1 (worker)", "ts": "2025-11-21T07:14:17.741088Z"}}
{"data": {"conn_name": "model.stock_analytics.stg_market_data", "orig_conn_name": "list_USER_DB_OSTRICH_PUBLIC_STAGING"}, "info": {"category": "", "code": "E006", "extra": {}, "invocation_id": "49f02202-ecce-4818-84eb-74382af7bcbc", "level": "debug", "msg": "Re-using an available connection from the pool (formerly list_USER_DB_OSTRICH_PUBLIC_STAGING, now model.stock_analytics.stg_market_data)", "name": "ConnectionReused", "pid": 48047, "thread": "Thread-1 (worker)", "ts": "2025-11-21T07:14:17.741708Z"}}
{"data": {"node_info": {"materialized": "view", "meta": {}, "node_checksum": "1594bc316b6a3b446bdf3099c5c8dc88726f1c055eabd4ff0f2ecb463d72bcd1", "node_finished_at": "", "node_name": "stg_market_data", "node_path": "staging/stg_market_data.sql", "node_relation": {"alias": "stg_market_data", "database": "USER_DB_OSTRICH", "relation_name": "USER_DB_OSTRICH.PUBLIC_STAGING.stg_market_data", "schema": "PUBLIC_STAGING"}, "node_started_at": "2025-11-21T07:14:17.740010", "node_status": "compiling", "resource_type": "model", "unique_id": "model.stock_analytics.stg_market_data"}}, "info": {"category": "", "code": "Q030", "extra": {}, "invocation_id": "49f02202-ecce-4818-84eb-74382af7bcbc", "level": "debug", "msg": "Began compiling node model.stock_analytics.stg_market_data", "name": "NodeCompiling", "pid": 48047, "thread": "Thread-1 (worker)", "ts": "2025-11-21T07:14:17.742125Z"}}
{"data": {"node_info": {"materialized": "view", "meta": {}, "node_checksum": "1594bc316b6a3b446bdf3099c5c8dc88726f1c055eabd4ff0f2ecb463d72bcd1", "node_finished_at": "", "node_name": "stg_market_data", "node_path": "staging/stg_market_data.sql", "node_relation": {"alias": "stg_market_data", "database": "USER_DB_OSTRICH", "relation_name": "USER_DB_OSTRICH.PUBLIC_STAGING.stg_market_data", "schema": "PUBLIC_STAGING"}, "node_started_at": "2025-11-21T07:14:17.740010", "node_status": "compiling", "resource_type": "model", "unique_id": "model.stock_analytics.stg_market_data"}}, "info": {"category": "", "code": "Q029", "extra": {}, "invocation_id": "49f02202-ecce-4818-84eb-74382af7bcbc", "level": "debug", "msg": "Writing injected SQL for node \"model.stock_analytics.stg_market_data\"", "name": "WritingInjectedSQLForNode", "pid": 48047, "thread": "Thread-1 (worker)", "ts": "2025-11-21T07:14:17.750454Z"}}
{"data": {"node_info": {"materialized": "view", "meta": {}, "node_checksum": "1594bc316b6a3b446bdf3099c5c8dc88726f1c055eabd4ff0f2ecb463d72bcd1", "node_finished_at": "", "node_name": "stg_market_data", "node_path": "staging/stg_market_data.sql", "node_relation": {"alias": "stg_market_data", "database": "USER_DB_OSTRICH", "relation_name": "USER_DB_OSTRICH.PUBLIC_STAGING.stg_market_data", "schema": "PUBLIC_STAGING"}, "node_started_at": "2025-11-21T07:14:17.740010", "node_status": "executing", "resource_type": "model", "unique_id": "model.stock_analytics.stg_market_data"}}, "info": {"category": "", "code": "Q031", "extra": {}, "invocation_id": "49f02202-ecce-4818-84eb-74382af7bcbc", "level": "debug", "msg": "Began executing node model.stock_analytics.stg_market_data", "name": "NodeExecuting", "pid": 48047, "thread": "Thread-1 (worker)", "ts": "2025-11-21T07:14:17.751772Z"}}
{"data": {"msg": "Writing runtime sql for node \"model.stock_analytics.stg_market_data\"", "node_info": {"materialized": "view", "meta": {}, "node_checksum": "1594bc316b6a3b446bdf3099c5c8dc88726f1c055eabd4ff0f2ecb463d72bcd1", "node_finished_at": "", "node_name": "stg_market_data", "node_path": "staging/stg_market_data.sql", "node_relation": {"alias": "stg_market_data", "database": "USER_DB_OSTRICH", "relation_name": "USER_DB_OSTRICH.PUBLIC_STAGING.stg_market_data", "schema": "PUBLIC_STAGING"}, "node_started_at": "2025-11-21T07:14:17.740010", "node_status": "executing", "resource_type": "model", "unique_id": "model.stock_analytics.stg_market_data"}}, "info": {"category": "", "code": "I063", "extra": {}, "invocation_id": "49f02202-ecce-4818-84eb-74382af7bcbc", "level": "debug", "msg": "Writing runtime sql for node \"model.stock_analytics.stg_market_data\"", "name": "JinjaLogDebug", "pid": 48047, "thread": "Thread-1 (worker)", "ts": "2025-11-21T07:14:17.772322Z"}}
{"data": {"conn_name": "model.stock_analytics.stg_market_data", "conn_type": "snowflake", "node_info": {"materialized": "view", "meta": {}, "node_checksum": "1594bc316b6a3b446bdf3099c5c8dc88726f1c055eabd4ff0f2ecb463d72bcd1", "node_finished_at": "", "node_name": "stg_market_data", "node_path": "staging/stg_market_data.sql", "node_relation": {"alias": "stg_market_data", "database": "USER_DB_OSTRICH", "relation_name": "USER_DB_OSTRICH.PUBLIC_STAGING.stg_market_data", "schema": "PUBLIC_STAGING"}, "node_started_at": "2025-11-21T07:14:17.740010", "node_status": "executing", "resource_type": "model", "unique_id": "model.stock_analytics.stg_market_data"}}, "info": {"category": "", "code": "E015", "extra": {}, "invocation_id": "49f02202-ecce-4818-84eb-74382af7bcbc", "level": "debug", "msg": "Using snowflake connection \"model.stock_analytics.stg_market_data\"", "name": "ConnectionUsed", "pid": 48047, "thread": "Thread-1 (worker)", "ts": "2025-11-21T07:14:17.773358Z"}}
{"data": {"conn_name": "model.stock_analytics.stg_market_data", "node_info": {"materialized": "view", "meta": {}, "node_checksum": "1594bc316b6a3b446bdf3099c5c8dc88726f1c055eabd4ff0f2ecb463d72bcd1", "node_finished_at": "", "node_name": "stg_market_data", "node_path": "staging/stg_market_data.sql", "node_relation": {"alias": "stg_market_data", "database": "USER_DB_OSTRICH", "relation_name": "USER_DB_OSTRICH.PUBLIC_STAGING.stg_market_data", "schema": "PUBLIC_STAGING"}, "node_started_at": "2025-11-21T07:14:17.740010", "node_status": "executing", "resource_type": "model", "unique_id": "model.stock_analytics.stg_market_data"}, "sql": "create or replace   view USER_DB_OSTRICH.PUBLIC_STAGING.stg_market_data\n  \n  \n  \n  \n  as (\n    \n\n-- Historical OHLCV (cleaned)\nselect distinct\n  upper(symbol)                  as symbol,\n  cast(date as date)             as date,\n  cast(open as float)            as open,\n  cast(high as float)            as high,\n  cast(low  as float)            as low,\n  cast(close as float)           as close,\n  cast(volume as float)          as volume\nfrom USER_DB_OSTRICH.RAW.MARKET_DATA\nwhere date is not null\n  )\n/* {\"app\": \"dbt\", \"dbt_version\": \"1.11.0b3\", \"profile_name\": \"stock_analytics\", \"target_name\": \"dev\", \"node_id\": \"model.stock_analytics.stg_market_data\"} */;"}, "info": {"category": "", "code": "E016", "extra": {}, "invocation_id": "49f02202-ecce-4818-84eb-74382af7bcbc", "level": "debug", "msg": "On model.stock_analytics.stg_market_data: create or replace   view USER_DB_OSTRICH.PUBLIC_STAGING.stg_market_data\n  \n  \n  \n  \n  as (\n    \n\n-- Historical OHLCV (cleaned)\nselect distinct\n  upper(symbol)                  as symbol,\n  cast(date as date)             as date,\n  cast(open as float)            as open,\n  cast(high as float)            as high,\n  cast(low  as float)            as low,\n  cast(close as float)           as close,\n  cast(volume as float)          as volume\nfrom USER_DB_OSTRICH.RAW.MARKET_DATA\nwhere date is not null\n  )\n/* {\"app\": \"dbt\", \"dbt_version\": \"1.11.0b3\", \"profile_name\": \"stock_analytics\", \"target_name\": \"dev\", \"node_id\": \"model.stock_analytics.stg_market_data\"} */;", "name": "SQLQuery", "pid": 48047, "thread": "Thread-1 (worker)", "ts": "2025-11-21T07:14:17.773668Z"}}
{"data": {"elapsed": 0.28881234, "node_info": {"materialized": "view", "meta": {}, "node_checksum": "1594bc316b6a3b446bdf3099c5c8dc88726f1c055eabd4ff0f2ecb463d72bcd1", "node_finished_at": "", "node_name": "stg_market_data", "node_path": "staging/stg_market_data.sql", "node_relation": {"alias": "stg_market_data", "database": "USER_DB_OSTRICH", "relation_name": "USER_DB_OSTRICH.PUBLIC_STAGING.stg_market_data", "schema": "PUBLIC_STAGING"}, "node_started_at": "2025-11-21T07:14:17.740010", "node_status": "executing", "resource_type": "model", "unique_id": "model.stock_analytics.stg_market_data"}, "query_id": "01c088d2-0307-1706-000f-c0df00858fda", "status": "SUCCESS 1"}, "info": {"category": "", "code": "E017", "extra": {}, "invocation_id": "49f02202-ecce-4818-84eb-74382af7bcbc", "level": "debug", "msg": "SQL status: SUCCESS 1 in 0.289 seconds", "name": "SQLQueryStatus", "pid": 48047, "thread": "Thread-1 (worker)", "ts": "2025-11-21T07:14:18.063176Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'run_model', 'label': '49f02202-ecce-4818-84eb-74382af7bcbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11259e510>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "49f02202-ecce-4818-84eb-74382af7bcbc", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49f02202-ecce-4818-84eb-74382af7bcbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11259e510>]}", "name": "SendingEvent", "pid": 48047, "thread": "Thread-1 (worker)", "ts": "2025-11-21T07:14:18.090471Z"}}
{"data": {"description": "sql view model PUBLIC_STAGING.stg_market_data", "execution_time": 0.34706688, "index": 1, "node_info": {"materialized": "view", "meta": {}, "node_checksum": "1594bc316b6a3b446bdf3099c5c8dc88726f1c055eabd4ff0f2ecb463d72bcd1", "node_finished_at": "2025-11-21T07:14:18.088600", "node_name": "stg_market_data", "node_path": "staging/stg_market_data.sql", "node_relation": {"alias": "stg_market_data", "database": "USER_DB_OSTRICH", "relation_name": "USER_DB_OSTRICH.PUBLIC_STAGING.stg_market_data", "schema": "PUBLIC_STAGING"}, "node_started_at": "2025-11-21T07:14:17.740010", "node_status": "success", "resource_type": "model", "unique_id": "model.stock_analytics.stg_market_data"}, "status": "SUCCESS 1", "total": 1}, "info": {"category": "", "code": "Q012", "extra": {}, "invocation_id": "49f02202-ecce-4818-84eb-74382af7bcbc", "level": "info", "msg": "1 of 1 OK created sql view model PUBLIC_STAGING.stg_market_data ................ [\u001b[32mSUCCESS 1\u001b[0m in 0.35s]", "name": "LogModelResult", "pid": 48047, "thread": "Thread-1 (worker)", "ts": "2025-11-21T07:14:18.091234Z"}}
{"data": {"node_info": {"materialized": "view", "meta": {}, "node_checksum": "1594bc316b6a3b446bdf3099c5c8dc88726f1c055eabd4ff0f2ecb463d72bcd1", "node_finished_at": "2025-11-21T07:14:18.088600", "node_name": "stg_market_data", "node_path": "staging/stg_market_data.sql", "node_relation": {"alias": "stg_market_data", "database": "USER_DB_OSTRICH", "relation_name": "USER_DB_OSTRICH.PUBLIC_STAGING.stg_market_data", "schema": "PUBLIC_STAGING"}, "node_started_at": "2025-11-21T07:14:17.740010", "node_status": "success", "resource_type": "model", "unique_id": "model.stock_analytics.stg_market_data"}, "run_result": {"adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "query_id": "01c088d2-0307-1706-000f-c0df00858fda", "rows_affected": 1.0}, "execution_time": 0.34706688, "message": "SUCCESS 1", "num_failures": 0, "status": "success", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2025-11-21T07:14:17.751651Z", "name": "compile", "started_at": "2025-11-21T07:14:17.742476Z"}, {"completed_at": "2025-11-21T07:14:18.088503Z", "name": "execute", "started_at": "2025-11-21T07:14:17.752111Z"}]}}, "info": {"category": "", "code": "Q025", "extra": {}, "invocation_id": "49f02202-ecce-4818-84eb-74382af7bcbc", "level": "debug", "msg": "Finished running node model.stock_analytics.stg_market_data", "name": "NodeFinished", "pid": 48047, "thread": "Thread-1 (worker)", "ts": "2025-11-21T07:14:18.091862Z"}}
{"data": {"conn_name": "master"}, "info": {"category": "", "code": "E008", "extra": {}, "invocation_id": "49f02202-ecce-4818-84eb-74382af7bcbc", "level": "debug", "msg": "Connection 'master' was properly closed.", "name": "ConnectionClosedInCleanup", "pid": 48047, "thread": "MainThread", "ts": "2025-11-21T07:14:18.093189Z"}}
{"data": {"conn_name": "model.stock_analytics.stg_market_data"}, "info": {"category": "", "code": "E007", "extra": {}, "invocation_id": "49f02202-ecce-4818-84eb-74382af7bcbc", "level": "debug", "msg": "Connection 'model.stock_analytics.stg_market_data' was left open.", "name": "ConnectionLeftOpenInCleanup", "pid": 48047, "thread": "MainThread", "ts": "2025-11-21T07:14:18.093545Z"}}
{"data": {"conn_name": "model.stock_analytics.stg_market_data"}, "info": {"category": "", "code": "E010", "extra": {}, "invocation_id": "49f02202-ecce-4818-84eb-74382af7bcbc", "level": "debug", "msg": "On model.stock_analytics.stg_market_data: Close", "name": "ConnectionClosed", "pid": 48047, "thread": "MainThread", "ts": "2025-11-21T07:14:18.093803Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "49f02202-ecce-4818-84eb-74382af7bcbc", "level": "info", "msg": "", "name": "Formatting", "pid": 48047, "thread": "MainThread", "ts": "2025-11-21T07:14:18.272923Z"}}
{"data": {"execution": " in 0 hours 0 minutes and 3.46 seconds", "execution_time": 3.463914, "stat_line": "1 view model"}, "info": {"category": "", "code": "E047", "extra": {}, "invocation_id": "49f02202-ecce-4818-84eb-74382af7bcbc", "level": "info", "msg": "Finished running 1 view model in 0 hours 0 minutes and 3.46 seconds (3.46s).", "name": "FinishedRunningStats", "pid": 48047, "thread": "MainThread", "ts": "2025-11-21T07:14:18.273800Z"}}
{"data": {"elapsed_time": 3.463914, "generated_at": "2025-11-21T07:14:18Z", "results": [{"adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "query_id": "01c088d2-0307-1706-000f-c0df00858fda", "rows_affected": 1.0}, "execution_time": 0.34706688, "message": "SUCCESS 1", "num_failures": 0, "status": "success", "thread": "Thread-1 (worker)", "timing_info": [{"completed_at": "2025-11-21T07:14:17.751651Z", "name": "compile", "started_at": "2025-11-21T07:14:17.742476Z"}, {"completed_at": "2025-11-21T07:14:18.088503Z", "name": "execute", "started_at": "2025-11-21T07:14:17.752111Z"}]}], "success": true}, "info": {"category": "", "code": "Q037", "extra": {}, "invocation_id": "49f02202-ecce-4818-84eb-74382af7bcbc", "level": "debug", "msg": "Command end result", "name": "EndRunResult", "pid": 48047, "thread": "MainThread", "ts": "2025-11-21T07:14:18.274770Z"}}
{"data": {"artifact_path": "/Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/target/manifest.json", "artifact_type": "WritableManifest"}, "info": {"category": "", "code": "P001", "extra": {}, "invocation_id": "49f02202-ecce-4818-84eb-74382af7bcbc", "level": "debug", "msg": "Wrote artifact WritableManifest to /Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/target/manifest.json", "name": "ArtifactWritten", "pid": 48047, "thread": "MainThread", "ts": "2025-11-21T07:14:18.306056Z"}}
{"data": {"artifact_path": "/Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/target/semantic_manifest.json", "artifact_type": "SemanticManifest"}, "info": {"category": "", "code": "P001", "extra": {}, "invocation_id": "49f02202-ecce-4818-84eb-74382af7bcbc", "level": "debug", "msg": "Wrote artifact SemanticManifest to /Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/target/semantic_manifest.json", "name": "ArtifactWritten", "pid": 48047, "thread": "MainThread", "ts": "2025-11-21T07:14:18.307359Z"}}
{"data": {"artifact_path": "/Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/target/run_results.json", "artifact_type": "RunExecutionResult"}, "info": {"category": "", "code": "P001", "extra": {}, "invocation_id": "49f02202-ecce-4818-84eb-74382af7bcbc", "level": "debug", "msg": "Wrote artifact RunExecutionResult to /Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/target/run_results.json", "name": "ArtifactWritten", "pid": 48047, "thread": "MainThread", "ts": "2025-11-21T07:14:18.310885Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "49f02202-ecce-4818-84eb-74382af7bcbc", "level": "info", "msg": "", "name": "Formatting", "pid": 48047, "thread": "MainThread", "ts": "2025-11-21T07:14:18.311111Z"}}
{"data": {"keyboard_interrupt": false, "num_errors": 0, "num_partial_success": 0, "num_warnings": 0}, "info": {"category": "", "code": "Z030", "extra": {}, "invocation_id": "49f02202-ecce-4818-84eb-74382af7bcbc", "level": "info", "msg": "\u001b[32mCompleted successfully\u001b[0m", "name": "EndOfRunSummary", "pid": 48047, "thread": "MainThread", "ts": "2025-11-21T07:14:18.311359Z"}}
{"data": {"msg": ""}, "info": {"category": "", "code": "Z017", "extra": {}, "invocation_id": "49f02202-ecce-4818-84eb-74382af7bcbc", "level": "info", "msg": "", "name": "Formatting", "pid": 48047, "thread": "MainThread", "ts": "2025-11-21T07:14:18.311561Z"}}
{"data": {"stats": {"error": 0, "noop": 0, "pass": 1, "skip": 0, "total": 1, "warn": 0}}, "info": {"category": "", "code": "Z023", "extra": {}, "invocation_id": "49f02202-ecce-4818-84eb-74382af7bcbc", "level": "info", "msg": "Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1", "name": "StatsLine", "pid": 48047, "thread": "MainThread", "ts": "2025-11-21T07:14:18.311766Z"}}
{"data": {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.50144, "process_in_blocks": "0", "process_kernel_time": 0.317077, "process_mem_max_rss": "242565120", "process_out_blocks": "0", "process_user_time": 1.326226}, "info": {"category": "", "code": "Z051", "extra": {}, "invocation_id": "49f02202-ecce-4818-84eb-74382af7bcbc", "level": "debug", "msg": "Resource report: {\"command_name\": \"run\", \"command_success\": true, \"command_wall_clock_time\": 4.50144, \"process_in_blocks\": \"0\", \"process_kernel_time\": 0.317077, \"process_mem_max_rss\": \"242565120\", \"process_out_blocks\": \"0\", \"process_user_time\": 1.326226}", "name": "ResourceReport", "pid": 48047, "thread": "MainThread", "ts": "2025-11-21T07:14:18.316692Z"}}
{"data": {"command": "dbt run", "completed_at": "2025-11-21T07:14:18.316929Z", "elapsed": 4.5017624, "success": true}, "info": {"category": "", "code": "Q039", "extra": {}, "invocation_id": "49f02202-ecce-4818-84eb-74382af7bcbc", "level": "debug", "msg": "Command `dbt run` succeeded at 23:14:18.316929 after 4.50 seconds", "name": "CommandCompleted", "pid": 48047, "thread": "MainThread", "ts": "2025-11-21T07:14:18.316983Z"}}
{"data": {"kwargs": "{'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1128ed020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111cb6c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11287c690>]}"}, "info": {"category": "", "code": "Z040", "extra": {}, "invocation_id": "49f02202-ecce-4818-84eb-74382af7bcbc", "level": "debug", "msg": "Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1128ed020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111cb6c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11287c690>]}", "name": "SendingEvent", "pid": 48047, "thread": "MainThread", "ts": "2025-11-21T07:14:18.317221Z"}}
{"data": {}, "info": {"category": "", "code": "Z042", "extra": {}, "invocation_id": "49f02202-ecce-4818-84eb-74382af7bcbc", "level": "debug", "msg": "Flushing usage events", "name": "FlushEvents", "pid": 48047, "thread": "MainThread", "ts": "2025-11-21T07:14:18.317435Z"}}
{"data": {}, "info": {"category": "", "code": "Z043", "extra": {}, "invocation_id": "49f02202-ecce-4818-84eb-74382af7bcbc", "level": "debug", "msg": "An error was encountered while trying to flush usage events", "name": "FlushEventsFailure", "pid": 48047, "thread": "MainThread", "ts": "2025-11-21T07:14:18.661358Z"}}
[0m23:20:48.703075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10785be00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108dd7b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108dd7d90>]}


============================== 23:20:48.705557 | c91712cd-c12a-4cd0-b43b-d3a5507234f9 ==============================
[0m23:20:48.705557 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m23:20:48.705813 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'version_check': 'True', 'write_json': 'True', 'profiles_dir': '/Users/rahulmohandevi/.dbt', 'indirect_selection': 'eager', 'quiet': 'False', 'printer_width': '80', 'empty': 'False', 'cache_selected_only': 'False', 'target_path': 'None', 'log_cache_events': 'False', 'fail_fast': 'False', 'no_print': 'None', 'warn_error': 'None', 'log_path': '/Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/logs', 'use_colors': 'True', 'invocation_command': 'dbt run -s stg_market_data stg_market_forecast', 'static_parser': 'True', 'introspect': 'True', 'partial_parse': 'True'}
[0m23:20:49.423396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c91712cd-c12a-4cd0-b43b-d3a5507234f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c04510>]}
[0m23:20:49.445311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c91712cd-c12a-4cd0-b43b-d3a5507234f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108d8270>]}
[0m23:20:49.445796 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m23:20:49.495401 [debug] [MainThread]: checksum: e63134dccc1251cfb572caf0e4aa952f030c125ee3634f3bf2c0a2e1bb6ae349, vars: {}, profile: , target: , version: 1.11.0b3
[0m23:20:49.545459 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m23:20:49.545644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c91712cd-c12a-4cd0-b43b-d3a5507234f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110cb6650>]}
[0m23:20:50.001096 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.stock_analytics.marts
[0m23:20:50.004643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c91712cd-c12a-4cd0-b43b-d3a5507234f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e9de50>]}
[0m23:20:50.035165 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/target/manifest.json
[0m23:20:50.036483 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/target/semantic_manifest.json
[0m23:20:50.046965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c91712cd-c12a-4cd0-b43b-d3a5507234f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11120e7b0>]}
[0m23:20:50.047158 [info ] [MainThread]: Found 2 models, 6 data tests, 2 sources, 492 macros
[0m23:20:50.047273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c91712cd-c12a-4cd0-b43b-d3a5507234f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111ebee0>]}
[0m23:20:50.047935 [info ] [MainThread]: 
[0m23:20:50.048056 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:20:50.048147 [info ] [MainThread]: 
[0m23:20:50.048335 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:20:50.049946 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_OSTRICH'
[0m23:20:50.106413 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_OSTRICH"
[0m23:20:50.106572 [debug] [ThreadPool]: On list_USER_DB_OSTRICH: show terse schemas in database USER_DB_OSTRICH
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_OSTRICH"} */
[0m23:20:50.106667 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:20:51.661371 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.555 seconds
[0m23:20:51.665665 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_OSTRICH, now list_USER_DB_OSTRICH_PUBLIC_STAGING)
[0m23:20:51.680618 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_OSTRICH_PUBLIC_STAGING"
[0m23:20:51.681024 [debug] [ThreadPool]: On list_USER_DB_OSTRICH_PUBLIC_STAGING: show objects in USER_DB_OSTRICH.PUBLIC_STAGING
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_OSTRICH_PUBLIC_STAGING"} */;
[0m23:20:51.822921 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.142 seconds
[0m23:20:51.826335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c91712cd-c12a-4cd0-b43b-d3a5507234f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111afdd0>]}
[0m23:20:51.831143 [debug] [Thread-1 (]: Began running node model.stock_analytics.stg_market_data
[0m23:20:51.831679 [info ] [Thread-1 (]: 1 of 2 START sql view model PUBLIC_STAGING.stg_market_data ..................... [RUN]
[0m23:20:51.832055 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_OSTRICH_PUBLIC_STAGING, now model.stock_analytics.stg_market_data)
[0m23:20:51.832341 [debug] [Thread-1 (]: Began compiling node model.stock_analytics.stg_market_data
[0m23:20:51.839612 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_analytics.stg_market_data"
[0m23:20:51.840381 [debug] [Thread-1 (]: Began executing node model.stock_analytics.stg_market_data
[0m23:20:51.863702 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_analytics.stg_market_data"
[0m23:20:51.864746 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.stg_market_data"
[0m23:20:51.864980 [debug] [Thread-1 (]: On model.stock_analytics.stg_market_data: create or replace   view USER_DB_OSTRICH.PUBLIC_STAGING.stg_market_data
  
  
  
  
  as (
    

-- Historical OHLCV (cleaned)
select distinct
  upper(symbol)                  as symbol,
  cast(date as date)             as date,
  cast(open as float)            as open,
  cast(high as float)            as high,
  cast(low  as float)            as low,
  cast(close as float)           as close,
  cast(volume as float)          as volume
from USER_DB_OSTRICH.RAW.MARKET_DATA
where date is not null
  )
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.stg_market_data"} */;
[0m23:20:52.333722 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.468 seconds
[0m23:20:52.355497 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c91712cd-c12a-4cd0-b43b-d3a5507234f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a12fc0>]}
[0m23:20:52.356013 [info ] [Thread-1 (]: 1 of 2 OK created sql view model PUBLIC_STAGING.stg_market_data ................ [[32mSUCCESS 1[0m in 0.52s]
[0m23:20:52.356364 [debug] [Thread-1 (]: Finished running node model.stock_analytics.stg_market_data
[0m23:20:52.356596 [debug] [Thread-1 (]: Began running node model.stock_analytics.stg_market_forecast
[0m23:20:52.356983 [info ] [Thread-1 (]: 2 of 2 START sql view model PUBLIC_STAGING.stg_market_forecast ................. [RUN]
[0m23:20:52.357316 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_analytics.stg_market_data, now model.stock_analytics.stg_market_forecast)
[0m23:20:52.357527 [debug] [Thread-1 (]: Began compiling node model.stock_analytics.stg_market_forecast
[0m23:20:52.359750 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_analytics.stg_market_forecast"
[0m23:20:52.360320 [debug] [Thread-1 (]: Began executing node model.stock_analytics.stg_market_forecast
[0m23:20:52.361599 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_analytics.stg_market_forecast"
[0m23:20:52.362262 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.stg_market_forecast"
[0m23:20:52.362455 [debug] [Thread-1 (]: On model.stock_analytics.stg_market_forecast: create or replace   view USER_DB_OSTRICH.PUBLIC_STAGING.stg_market_forecast
  
  
  
  
  as (
    

-- Forecast rows only (ACTUAL is null for future)
with src as (
  select
    upper(symbol)           as symbol,
    cast(date as date)      as date,
    cast(actual as float)   as actual,
    cast(forecast as float) as forecast,
    cast(lower_bound as float) as lower_bound,
    cast(upper_bound as float) as upper_bound
  from USER_DB_OSTRICH.ANALYTICS.MARKET_DATA
)
select distinct
  symbol,
  date,
  forecast,
  lower_bound,
  upper_bound
from src
where actual is null          -- keep future horizon only
  and date is not null
  )
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.stg_market_forecast"} */;
[0m23:20:52.742754 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.380 seconds
[0m23:20:52.746349 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c91712cd-c12a-4cd0-b43b-d3a5507234f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a43ed0>]}
[0m23:20:52.747246 [info ] [Thread-1 (]: 2 of 2 OK created sql view model PUBLIC_STAGING.stg_market_forecast ............ [[32mSUCCESS 1[0m in 0.39s]
[0m23:20:52.747935 [debug] [Thread-1 (]: Finished running node model.stock_analytics.stg_market_forecast
[0m23:20:52.749746 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:20:52.750139 [debug] [MainThread]: Connection 'model.stock_analytics.stg_market_forecast' was left open.
[0m23:20:52.750480 [debug] [MainThread]: On model.stock_analytics.stg_market_forecast: Close
[0m23:20:52.849464 [info ] [MainThread]: 
[0m23:20:52.850421 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 2.80 seconds (2.80s).
[0m23:20:52.851310 [debug] [MainThread]: Command end result
[0m23:20:52.870500 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/target/manifest.json
[0m23:20:52.871763 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/target/semantic_manifest.json
[0m23:20:52.875710 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/target/run_results.json
[0m23:20:52.875882 [info ] [MainThread]: 
[0m23:20:52.876083 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:20:52.876224 [info ] [MainThread]: 
[0m23:20:52.876402 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m23:20:52.881985 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.2069416, "process_in_blocks": "0", "process_kernel_time": 0.303868, "process_mem_max_rss": "252706816", "process_out_blocks": "0", "process_user_time": 1.712127}
[0m23:20:52.882224 [debug] [MainThread]: Command `dbt run` succeeded at 23:20:52.882173 after 4.21 seconds
[0m23:20:52.882413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111893d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114f7b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e0b070>]}
[0m23:20:52.882589 [debug] [MainThread]: Flushing usage events
[0m23:20:53.239402 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:32:02.988962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af93e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c533b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c533d90>]}


============================== 23:32:02.991520 | e6ac3a8e-3504-4e9f-8995-271171c777ce ==============================
[0m23:32:02.991520 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m23:32:02.991785 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'printer_width': '80', 'write_json': 'True', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'log_format': 'default', 'version_check': 'True', 'invocation_command': 'dbt run -s mart_stock_analysis', 'profiles_dir': '/Users/rahulmohandevi/.dbt', 'fail_fast': 'False', 'empty': 'False', 'log_path': '/Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/logs', 'partial_parse': 'True', 'static_parser': 'True', 'target_path': 'None', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'warn_error': 'None', 'introspect': 'True'}
[0m23:32:03.710493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e6ac3a8e-3504-4e9f-8995-271171c777ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b53c510>]}
[0m23:32:03.732641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e6ac3a8e-3504-4e9f-8995-271171c777ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1400ec270>]}
[0m23:32:03.733116 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m23:32:03.781005 [debug] [MainThread]: checksum: e63134dccc1251cfb572caf0e4aa952f030c125ee3634f3bf2c0a2e1bb6ae349, vars: {}, profile: , target: , version: 1.11.0b3
[0m23:32:03.847407 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 0 files changed.
[0m23:32:03.847664 [debug] [MainThread]: Partial parsing: added file: stock_analytics://tests/mart_stock_analysis.sql
[0m23:32:03.847805 [debug] [MainThread]: Partial parsing: added file: stock_analytics://models/marts/mart_stock_analysis.yml
[0m23:32:03.847904 [debug] [MainThread]: Partial parsing: added file: stock_analytics://models/marts/mart_stock_analysis.sql
[0m23:32:03.989432 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'mart_stock_analysis' in package 'stock_analytics'
(models/marts/mart_stock_analysis.yml). Arguments to generic tests should be
nested under the `arguments` property.
[0m23:32:03.989682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e6ac3a8e-3504-4e9f-8995-271171c777ce', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x140b84550>]}
[0m23:32:04.030836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e6ac3a8e-3504-4e9f-8995-271171c777ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1408d76b0>]}
[0m23:32:04.066831 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/target/manifest.json
[0m23:32:04.068367 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/target/semantic_manifest.json
[0m23:32:04.079370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e6ac3a8e-3504-4e9f-8995-271171c777ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x140a64f30>]}
[0m23:32:04.079538 [info ] [MainThread]: Found 3 models, 11 data tests, 2 sources, 492 macros
[0m23:32:04.079658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6ac3a8e-3504-4e9f-8995-271171c777ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x140a6d640>]}
[0m23:32:04.080264 [info ] [MainThread]: 
[0m23:32:04.080382 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:32:04.080471 [info ] [MainThread]: 
[0m23:32:04.080638 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:32:04.080961 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_OSTRICH'
[0m23:32:04.137863 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_OSTRICH"
[0m23:32:04.138032 [debug] [ThreadPool]: On list_USER_DB_OSTRICH: show terse schemas in database USER_DB_OSTRICH
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_OSTRICH"} */
[0m23:32:04.138125 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:32:06.836396 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 2.698 seconds
[0m23:32:06.841133 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_OSTRICH, now create_USER_DB_OSTRICH_PUBLIC_ANALYTICS)
[0m23:32:06.841677 [debug] [ThreadPool]: Creating schema "database: "USER_DB_OSTRICH"
schema: "PUBLIC_ANALYTICS"
"
[0m23:32:06.845438 [debug] [ThreadPool]: Using snowflake connection "create_USER_DB_OSTRICH_PUBLIC_ANALYTICS"
[0m23:32:06.845679 [debug] [ThreadPool]: On create_USER_DB_OSTRICH_PUBLIC_ANALYTICS: create schema if not exists USER_DB_OSTRICH.PUBLIC_ANALYTICS
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "create_USER_DB_OSTRICH_PUBLIC_ANALYTICS"} */
[0m23:32:07.026301 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.180 seconds
[0m23:32:07.033879 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_USER_DB_OSTRICH_PUBLIC_ANALYTICS, now list_USER_DB_OSTRICH_PUBLIC_ANALYTICS)
[0m23:32:07.045872 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_OSTRICH_PUBLIC_ANALYTICS"
[0m23:32:07.046148 [debug] [ThreadPool]: On list_USER_DB_OSTRICH_PUBLIC_ANALYTICS: show objects in USER_DB_OSTRICH.PUBLIC_ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_OSTRICH_PUBLIC_ANALYTICS"} */;
[0m23:32:07.142280 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.096 seconds
[0m23:32:07.146502 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_OSTRICH_PUBLIC_ANALYTICS, now list_USER_DB_OSTRICH_PUBLIC_STAGING)
[0m23:32:07.149258 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_OSTRICH_PUBLIC_STAGING"
[0m23:32:07.149687 [debug] [ThreadPool]: On list_USER_DB_OSTRICH_PUBLIC_STAGING: show objects in USER_DB_OSTRICH.PUBLIC_STAGING
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_OSTRICH_PUBLIC_STAGING"} */;
[0m23:32:07.301960 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.152 seconds
[0m23:32:07.307699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6ac3a8e-3504-4e9f-8995-271171c777ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1411e7ad0>]}
[0m23:32:07.310869 [debug] [Thread-1 (]: Began running node model.stock_analytics.mart_stock_analysis
[0m23:32:07.311320 [info ] [Thread-1 (]: 1 of 1 START sql table model PUBLIC_ANALYTICS.mart_stock_analysis .............. [RUN]
[0m23:32:07.311663 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_OSTRICH_PUBLIC_STAGING, now model.stock_analytics.mart_stock_analysis)
[0m23:32:07.311907 [debug] [Thread-1 (]: Began compiling node model.stock_analytics.mart_stock_analysis
[0m23:32:07.317466 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_analytics.mart_stock_analysis"
[0m23:32:07.318343 [debug] [Thread-1 (]: Began executing node model.stock_analytics.mart_stock_analysis
[0m23:32:07.335636 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_analytics.mart_stock_analysis"
[0m23:32:07.336457 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.mart_stock_analysis"
[0m23:32:07.336655 [debug] [Thread-1 (]: On model.stock_analytics.mart_stock_analysis: create or replace transient table USER_DB_OSTRICH.PUBLIC_ANALYTICS.mart_stock_analysis
    
    
    
    as (

-- Historical slice (from staging)
with hist as (
  select
    symbol,
    date,
    close                as actual_price,
    cast(null as float)  as forecast_price,
    cast(null as float)  as lower_bound,
    cast(null as float)  as upper_bound,
    'historical'         as record_type
  from USER_DB_OSTRICH.PUBLIC_STAGING.stg_market_data
),

-- Forecast slice (from staging)
fut as (
  select
    symbol,
    date,
    cast(null as float)  as actual_price,
    forecast             as forecast_price,
    lower_bound,
    upper_bound,
    'forecast'           as record_type
  from USER_DB_OSTRICH.PUBLIC_STAGING.stg_market_forecast
)

-- Union both
, unioned as (
  select * from hist
  union all
  select * from fut
)

-- In case of any accidental dupes (shouldn't happen, but safe)
select *
from (
  select
    *,
    row_number() over (partition by symbol, date, record_type order by date desc) as rn
  from unioned
)
where rn = 1
    )

/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.mart_stock_analysis"} */;
[0m23:32:08.943594 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.607 seconds
[0m23:32:08.969308 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6ac3a8e-3504-4e9f-8995-271171c777ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x141aab490>]}
[0m23:32:08.969954 [info ] [Thread-1 (]: 1 of 1 OK created sql table model PUBLIC_ANALYTICS.mart_stock_analysis ......... [[32mSUCCESS 1[0m in 1.66s]
[0m23:32:08.970390 [debug] [Thread-1 (]: Finished running node model.stock_analytics.mart_stock_analysis
[0m23:32:08.971485 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:32:08.971780 [debug] [MainThread]: Connection 'model.stock_analytics.mart_stock_analysis' was left open.
[0m23:32:08.972000 [debug] [MainThread]: On model.stock_analytics.mart_stock_analysis: Close
[0m23:32:09.085676 [info ] [MainThread]: 
[0m23:32:09.086386 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.00 seconds (5.00s).
[0m23:32:09.087308 [debug] [MainThread]: Command end result
[0m23:32:09.109735 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/target/manifest.json
[0m23:32:09.111136 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/target/semantic_manifest.json
[0m23:32:09.115293 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/target/run_results.json
[0m23:32:09.115489 [info ] [MainThread]: 
[0m23:32:09.115727 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:32:09.115891 [info ] [MainThread]: 
[0m23:32:09.116068 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m23:32:09.116393 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m23:32:09.121962 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.1618094, "process_in_blocks": "0", "process_kernel_time": 0.318526, "process_mem_max_rss": "251527168", "process_out_blocks": "0", "process_user_time": 1.500726}
[0m23:32:09.122263 [debug] [MainThread]: Command `dbt run` succeeded at 23:32:09.122207 after 6.16 seconds
[0m23:32:09.122473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x141a9fbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x141b6e720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc1b2d0>]}
[0m23:32:09.122666 [debug] [MainThread]: Flushing usage events
[0m23:32:09.493603 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:32:27.647651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a03e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10913fb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10913fd90>]}


============================== 23:32:27.649881 | a669cdd1-1dd6-472f-a869-8845c676eb3b ==============================
[0m23:32:27.649881 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m23:32:27.650123 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'log_cache_events': 'False', 'fail_fast': 'False', 'write_json': 'True', 'log_path': '/Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/logs', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'no_print': 'None', 'profiles_dir': '/Users/rahulmohandevi/.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt test -s mart_stock_analysis tests/test_forecast_dates_future.sql', 'warn_error': 'None', 'use_colors': 'True', 'partial_parse': 'True', 'empty': 'None', 'version_check': 'True', 'target_path': 'None', 'static_parser': 'True', 'log_format': 'default', 'cache_selected_only': 'False', 'quiet': 'False', 'introspect': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False'}
[0m23:32:28.188173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a669cdd1-1dd6-472f-a869-8845c676eb3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f6c510>]}
[0m23:32:28.210551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a669cdd1-1dd6-472f-a869-8845c676eb3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110be0270>]}
[0m23:32:28.211131 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m23:32:28.261343 [debug] [MainThread]: checksum: e63134dccc1251cfb572caf0e4aa952f030c125ee3634f3bf2c0a2e1bb6ae349, vars: {}, profile: , target: , version: 1.11.0b3
[0m23:32:28.331212 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:32:28.331441 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:32:28.349723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a669cdd1-1dd6-472f-a869-8845c676eb3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110fbad50>]}
[0m23:32:28.386149 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/target/manifest.json
[0m23:32:28.387232 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/target/semantic_manifest.json
[0m23:32:28.402018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a669cdd1-1dd6-472f-a869-8845c676eb3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11120e4e0>]}
[0m23:32:28.402220 [info ] [MainThread]: Found 3 models, 11 data tests, 2 sources, 492 macros
[0m23:32:28.402342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a669cdd1-1dd6-472f-a869-8845c676eb3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112d17f0>]}
[0m23:32:28.402856 [warn ] [MainThread]: The selection criterion 'tests/test_forecast_dates_future.sql' does not match any enabled nodes
[0m23:32:28.403434 [info ] [MainThread]: 
[0m23:32:28.403558 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:32:28.403645 [info ] [MainThread]: 
[0m23:32:28.403825 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:32:28.405431 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_OSTRICH_PUBLIC_ANALYTICS'
[0m23:32:28.432854 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_OSTRICH_PUBLIC_ANALYTICS"
[0m23:32:28.432999 [debug] [ThreadPool]: On list_USER_DB_OSTRICH_PUBLIC_ANALYTICS: show objects in USER_DB_OSTRICH.PUBLIC_ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_OSTRICH_PUBLIC_ANALYTICS"} */;
[0m23:32:28.433098 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:32:31.053344 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 2.620 seconds
[0m23:32:31.058433 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_OSTRICH_PUBLIC_ANALYTICS, now list_USER_DB_OSTRICH_PUBLIC_STAGING)
[0m23:32:31.060829 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_OSTRICH_PUBLIC_STAGING"
[0m23:32:31.061095 [debug] [ThreadPool]: On list_USER_DB_OSTRICH_PUBLIC_STAGING: show objects in USER_DB_OSTRICH.PUBLIC_STAGING
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_OSTRICH_PUBLIC_STAGING"} */;
[0m23:32:31.706256 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.645 seconds
[0m23:32:31.710460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a669cdd1-1dd6-472f-a869-8845c676eb3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111343d40>]}
[0m23:32:31.715253 [debug] [Thread-1 (]: Began running node test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316
[0m23:32:31.715799 [info ] [Thread-1 (]: 1 of 5 START test accepted_values_mart_stock_analysis_record_type__historical__forecast  [RUN]
[0m23:32:31.716426 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_OSTRICH_PUBLIC_STAGING, now test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316)
[0m23:32:31.716868 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316
[0m23:32:31.732561 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316"
[0m23:32:31.733546 [debug] [Thread-1 (]: Began executing node test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316
[0m23:32:31.748926 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316"
[0m23:32:31.749635 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316"
[0m23:32:31.749842 [debug] [Thread-1 (]: On test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        record_type as value_field,
        count(*) as n_records

    from USER_DB_OSTRICH.PUBLIC_ANALYTICS.mart_stock_analysis
    group by record_type

)

select *
from all_values
where value_field not in (
    'historical','forecast'
)



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316"} */
[0m23:32:32.033090 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.283 seconds
[0m23:32:32.055847 [info ] [Thread-1 (]: 1 of 5 PASS accepted_values_mart_stock_analysis_record_type__historical__forecast  [[32mPASS[0m in 0.34s]
[0m23:32:32.057149 [debug] [Thread-1 (]: Finished running node test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316
[0m23:32:32.057611 [debug] [Thread-1 (]: Began running node test.stock_analytics.mart_stock_analysis
[0m23:32:32.058091 [info ] [Thread-1 (]: 2 of 5 START test mart_stock_analysis .......................................... [RUN]
[0m23:32:32.058782 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316, now test.stock_analytics.mart_stock_analysis)
[0m23:32:32.059404 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.mart_stock_analysis
[0m23:32:32.062981 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.mart_stock_analysis"
[0m23:32:32.064145 [debug] [Thread-1 (]: Began executing node test.stock_analytics.mart_stock_analysis
[0m23:32:32.077185 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.mart_stock_analysis"
[0m23:32:32.078592 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.mart_stock_analysis"
[0m23:32:32.079086 [debug] [Thread-1 (]: On test.stock_analytics.mart_stock_analysis: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  with max_hist as (
  select symbol, max(date) as max_hist_date
  from USER_DB_OSTRICH.PUBLIC_STAGING.stg_market_data
  group by 1
)
select f.symbol, f.date
from USER_DB_OSTRICH.PUBLIC_ANALYTICS.mart_stock_analysis f
join max_hist m using (symbol)
where f.record_type = 'forecast'
  and f.date <= m.max_hist_date
  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.mart_stock_analysis"} */
[0m23:32:32.382244 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.302 seconds
[0m23:32:32.385553 [info ] [Thread-1 (]: 2 of 5 PASS mart_stock_analysis ................................................ [[32mPASS[0m in 0.33s]
[0m23:32:32.386182 [debug] [Thread-1 (]: Finished running node test.stock_analytics.mart_stock_analysis
[0m23:32:32.386587 [debug] [Thread-1 (]: Began running node test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5
[0m23:32:32.387043 [info ] [Thread-1 (]: 3 of 5 START test not_null_mart_stock_analysis_date ............................ [RUN]
[0m23:32:32.387515 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.mart_stock_analysis, now test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5)
[0m23:32:32.387884 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5
[0m23:32:32.394841 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5"
[0m23:32:32.395597 [debug] [Thread-1 (]: Began executing node test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5
[0m23:32:32.397967 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5"
[0m23:32:32.398921 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5"
[0m23:32:32.399251 [debug] [Thread-1 (]: On test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date
from USER_DB_OSTRICH.PUBLIC_ANALYTICS.mart_stock_analysis
where date is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5"} */
[0m23:32:32.729854 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.330 seconds
[0m23:32:32.733865 [info ] [Thread-1 (]: 3 of 5 PASS not_null_mart_stock_analysis_date .................................. [[32mPASS[0m in 0.35s]
[0m23:32:32.734494 [debug] [Thread-1 (]: Finished running node test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5
[0m23:32:32.735189 [debug] [Thread-1 (]: Began running node test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e
[0m23:32:32.735608 [info ] [Thread-1 (]: 4 of 5 START test not_null_mart_stock_analysis_symbol .......................... [RUN]
[0m23:32:32.736244 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5, now test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e)
[0m23:32:32.736660 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e
[0m23:32:32.740409 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e"
[0m23:32:32.741276 [debug] [Thread-1 (]: Began executing node test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e
[0m23:32:32.743513 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e"
[0m23:32:32.744283 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e"
[0m23:32:32.744535 [debug] [Thread-1 (]: On test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select symbol
from USER_DB_OSTRICH.PUBLIC_ANALYTICS.mart_stock_analysis
where symbol is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e"} */
[0m23:32:33.138050 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.393 seconds
[0m23:32:33.141814 [info ] [Thread-1 (]: 4 of 5 PASS not_null_mart_stock_analysis_symbol ................................ [[32mPASS[0m in 0.41s]
[0m23:32:33.142557 [debug] [Thread-1 (]: Finished running node test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e
[0m23:32:33.143004 [debug] [Thread-1 (]: Began running node test.stock_analytics.unique_mart_stock_analysis_symbol__date__record_type.1fad36923d
[0m23:32:33.143477 [info ] [Thread-1 (]: 5 of 5 START test unique_mart_stock_analysis_symbol__date__record_type ......... [RUN]
[0m23:32:33.144017 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e, now test.stock_analytics.unique_mart_stock_analysis_symbol__date__record_type.1fad36923d)
[0m23:32:33.144415 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.unique_mart_stock_analysis_symbol__date__record_type.1fad36923d
[0m23:32:33.153298 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.unique_mart_stock_analysis_symbol__date__record_type.1fad36923d"
[0m23:32:33.154199 [debug] [Thread-1 (]: Began executing node test.stock_analytics.unique_mart_stock_analysis_symbol__date__record_type.1fad36923d
[0m23:32:33.157196 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.unique_mart_stock_analysis_symbol__date__record_type.1fad36923d"
[0m23:32:33.158162 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.unique_mart_stock_analysis_symbol__date__record_type.1fad36923d"
[0m23:32:33.158473 [debug] [Thread-1 (]: On test.stock_analytics.unique_mart_stock_analysis_symbol__date__record_type.1fad36923d: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    ['symbol', 'date', 'record_type'] as unique_field,
    count(*) as n_records

from USER_DB_OSTRICH.PUBLIC_ANALYTICS.mart_stock_analysis
where ['symbol', 'date', 'record_type'] is not null
group by ['symbol', 'date', 'record_type']
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.unique_mart_stock_analysis_symbol__date__record_type.1fad36923d"} */
[0m23:32:33.445435 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.286 seconds
[0m23:32:33.449048 [error] [Thread-1 (]: 5 of 5 FAIL 1 unique_mart_stock_analysis_symbol__date__record_type ............. [[31mFAIL 1[0m in 0.30s]
[0m23:32:33.449915 [debug] [Thread-1 (]: Finished running node test.stock_analytics.unique_mart_stock_analysis_symbol__date__record_type.1fad36923d
[0m23:32:33.452172 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:32:33.452579 [debug] [MainThread]: Connection 'test.stock_analytics.unique_mart_stock_analysis_symbol__date__record_type.1fad36923d' was left open.
[0m23:32:33.452935 [debug] [MainThread]: On test.stock_analytics.unique_mart_stock_analysis_symbol__date__record_type.1fad36923d: Close
[0m23:32:33.577259 [info ] [MainThread]: 
[0m23:32:33.578212 [info ] [MainThread]: Finished running 5 data tests in 0 hours 0 minutes and 5.17 seconds (5.17s).
[0m23:32:33.580188 [debug] [MainThread]: Command end result
[0m23:32:33.603549 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/target/manifest.json
[0m23:32:33.605080 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/target/semantic_manifest.json
[0m23:32:33.610315 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/target/run_results.json
[0m23:32:33.610529 [info ] [MainThread]: 
[0m23:32:33.610747 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m23:32:33.610924 [info ] [MainThread]: 
[0m23:32:33.611142 [error] [MainThread]: [31mFailure in test unique_mart_stock_analysis_symbol__date__record_type (models/marts/mart_stock_analysis.yml)[0m
[0m23:32:33.611341 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m23:32:33.611478 [info ] [MainThread]: 
[0m23:32:33.611654 [info ] [MainThread]:   compiled code at target/compiled/stock_analytics/models/marts/mart_stock_analysis.yml/unique_mart_stock_analysis_symbol__date__record_type.sql
[0m23:32:33.611790 [info ] [MainThread]: 
[0m23:32:33.611953 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=5
[0m23:32:33.617561 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 5.9964786, "process_in_blocks": "0", "process_kernel_time": 0.27924, "process_mem_max_rss": "245481472", "process_out_blocks": "0", "process_user_time": 1.386018}
[0m23:32:33.617782 [debug] [MainThread]: Command `dbt test` failed at 23:32:33.617734 after 6.00 seconds
[0m23:32:33.617976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a725d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114f38680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114f389f0>]}
[0m23:32:33.618153 [debug] [MainThread]: Flushing usage events
[0m23:32:33.923622 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:39:31.696335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10575fe00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cdbb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cdbd90>]}


============================== 23:39:31.698794 | e781f020-bdc4-4153-9377-b8480ff8b383 ==============================
[0m23:39:31.698794 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m23:39:31.699054 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'warn_error': 'None', 'introspect': 'True', 'log_format': 'default', 'log_cache_events': 'False', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/logs', 'invocation_command': 'dbt test', 'fail_fast': 'False', 'profiles_dir': '/Users/rahulmohandevi/.dbt', 'empty': 'None', 'static_parser': 'True', 'write_json': 'True', 'indirect_selection': 'eager', 'no_print': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'debug': 'False'}
[0m23:39:32.633542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e781f020-bdc4-4153-9377-b8480ff8b383', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b08510>]}
[0m23:39:32.656278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e781f020-bdc4-4153-9377-b8480ff8b383', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121e0c270>]}
[0m23:39:32.656793 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m23:39:32.704915 [debug] [MainThread]: checksum: e63134dccc1251cfb572caf0e4aa952f030c125ee3634f3bf2c0a2e1bb6ae349, vars: {}, profile: , target: , version: 1.11.0b3
[0m23:39:32.776715 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 1 files changed.
[0m23:39:32.776955 [debug] [MainThread]: Partial parsing: added file: stock_analytics://tests/test_forecast_dates_future.sql
[0m23:39:32.777058 [debug] [MainThread]: Partial parsing: deleted file: stock_analytics://tests/mart_stock_analysis.sql
[0m23:39:32.777208 [debug] [MainThread]: Partial parsing: updated file: stock_analytics://models/marts/mart_stock_analysis.sql
[0m23:39:32.917482 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'mart_stock_analysis' in package 'stock_analytics'
(models/marts/mart_stock_analysis.yml). Arguments to generic tests should be
nested under the `arguments` property.
[0m23:39:32.917727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e781f020-bdc4-4153-9377-b8480ff8b383', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1228f0050>]}
[0m23:39:32.958024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e781f020-bdc4-4153-9377-b8480ff8b383', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122567e30>]}
[0m23:39:32.996445 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/target/manifest.json
[0m23:39:32.998031 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/target/semantic_manifest.json
[0m23:39:33.012172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e781f020-bdc4-4153-9377-b8480ff8b383', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1228e8bb0>]}
[0m23:39:33.012352 [info ] [MainThread]: Found 3 models, 11 data tests, 2 sources, 492 macros
[0m23:39:33.012467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e781f020-bdc4-4153-9377-b8480ff8b383', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1229d18b0>]}
[0m23:39:33.013304 [info ] [MainThread]: 
[0m23:39:33.013431 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:39:33.013521 [info ] [MainThread]: 
[0m23:39:33.013694 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:39:33.015457 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_OSTRICH_PUBLIC_STAGING'
[0m23:39:33.074084 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_OSTRICH_PUBLIC_STAGING"
[0m23:39:33.074250 [debug] [ThreadPool]: On list_USER_DB_OSTRICH_PUBLIC_STAGING: show objects in USER_DB_OSTRICH.PUBLIC_STAGING
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_OSTRICH_PUBLIC_STAGING"} */;
[0m23:39:33.074347 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:39:33.591098 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.517 seconds
[0m23:39:33.594106 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_OSTRICH_PUBLIC_STAGING, now list_USER_DB_OSTRICH_PUBLIC_ANALYTICS)
[0m23:39:33.597932 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_OSTRICH_PUBLIC_ANALYTICS"
[0m23:39:33.598286 [debug] [ThreadPool]: On list_USER_DB_OSTRICH_PUBLIC_ANALYTICS: show objects in USER_DB_OSTRICH.PUBLIC_ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_OSTRICH_PUBLIC_ANALYTICS"} */;
[0m23:39:33.728046 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.129 seconds
[0m23:39:33.732289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e781f020-bdc4-4153-9377-b8480ff8b383', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122963e90>]}
[0m23:39:33.736111 [debug] [Thread-1 (]: Began running node test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316
[0m23:39:33.736560 [info ] [Thread-1 (]: 1 of 11 START test accepted_values_mart_stock_analysis_record_type__historical__forecast  [RUN]
[0m23:39:33.736976 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_OSTRICH_PUBLIC_ANALYTICS, now test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316)
[0m23:39:33.737274 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316
[0m23:39:33.744603 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316"
[0m23:39:33.745419 [debug] [Thread-1 (]: Began executing node test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316
[0m23:39:33.761257 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316"
[0m23:39:33.762047 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316"
[0m23:39:33.762252 [debug] [Thread-1 (]: On test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        record_type as value_field,
        count(*) as n_records

    from USER_DB_OSTRICH.PUBLIC_ANALYTICS.mart_stock_analysis
    group by record_type

)

select *
from all_values
where value_field not in (
    'historical','forecast'
)



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316"} */
[0m23:39:33.897068 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.134 seconds
[0m23:39:33.907703 [info ] [Thread-1 (]: 1 of 11 PASS accepted_values_mart_stock_analysis_record_type__historical__forecast  [[32mPASS[0m in 0.17s]
[0m23:39:33.908269 [debug] [Thread-1 (]: Finished running node test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316
[0m23:39:33.908591 [debug] [Thread-1 (]: Began running node test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5
[0m23:39:33.908941 [info ] [Thread-1 (]: 2 of 11 START test not_null_mart_stock_analysis_date ........................... [RUN]
[0m23:39:33.909296 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316, now test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5)
[0m23:39:33.909574 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5
[0m23:39:33.914336 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5"
[0m23:39:33.915696 [debug] [Thread-1 (]: Began executing node test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5
[0m23:39:33.917508 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5"
[0m23:39:33.918285 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5"
[0m23:39:33.918507 [debug] [Thread-1 (]: On test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date
from USER_DB_OSTRICH.PUBLIC_ANALYTICS.mart_stock_analysis
where date is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5"} */
[0m23:39:34.082379 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.163 seconds
[0m23:39:34.086029 [info ] [Thread-1 (]: 2 of 11 PASS not_null_mart_stock_analysis_date ................................. [[32mPASS[0m in 0.18s]
[0m23:39:34.086867 [debug] [Thread-1 (]: Finished running node test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5
[0m23:39:34.087374 [debug] [Thread-1 (]: Began running node test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e
[0m23:39:34.087870 [info ] [Thread-1 (]: 3 of 11 START test not_null_mart_stock_analysis_symbol ......................... [RUN]
[0m23:39:34.088475 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5, now test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e)
[0m23:39:34.088904 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e
[0m23:39:34.093553 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e"
[0m23:39:34.095743 [debug] [Thread-1 (]: Began executing node test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e
[0m23:39:34.098529 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e"
[0m23:39:34.099516 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e"
[0m23:39:34.099850 [debug] [Thread-1 (]: On test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select symbol
from USER_DB_OSTRICH.PUBLIC_ANALYTICS.mart_stock_analysis
where symbol is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e"} */
[0m23:39:34.232292 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.132 seconds
[0m23:39:34.236836 [info ] [Thread-1 (]: 3 of 11 PASS not_null_mart_stock_analysis_symbol ............................... [[32mPASS[0m in 0.15s]
[0m23:39:34.237793 [debug] [Thread-1 (]: Finished running node test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e
[0m23:39:34.238062 [debug] [Thread-1 (]: Began running node test.stock_analytics.not_null_stg_market_data_date.fb73c94489
[0m23:39:34.238325 [info ] [Thread-1 (]: 4 of 11 START test not_null_stg_market_data_date ............................... [RUN]
[0m23:39:34.238613 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e, now test.stock_analytics.not_null_stg_market_data_date.fb73c94489)
[0m23:39:34.238822 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.not_null_stg_market_data_date.fb73c94489
[0m23:39:34.241246 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.not_null_stg_market_data_date.fb73c94489"
[0m23:39:34.242628 [debug] [Thread-1 (]: Began executing node test.stock_analytics.not_null_stg_market_data_date.fb73c94489
[0m23:39:34.244205 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.not_null_stg_market_data_date.fb73c94489"
[0m23:39:34.244804 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_stg_market_data_date.fb73c94489"
[0m23:39:34.244995 [debug] [Thread-1 (]: On test.stock_analytics.not_null_stg_market_data_date.fb73c94489: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date
from USER_DB_OSTRICH.PUBLIC_STAGING.stg_market_data
where date is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stg_market_data_date.fb73c94489"} */
[0m23:39:34.937283 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.692 seconds
[0m23:39:34.940529 [info ] [Thread-1 (]: 4 of 11 PASS not_null_stg_market_data_date ..................................... [[32mPASS[0m in 0.70s]
[0m23:39:34.941249 [debug] [Thread-1 (]: Finished running node test.stock_analytics.not_null_stg_market_data_date.fb73c94489
[0m23:39:34.941682 [debug] [Thread-1 (]: Began running node test.stock_analytics.not_null_stg_market_data_symbol.478198cf66
[0m23:39:34.942134 [info ] [Thread-1 (]: 5 of 11 START test not_null_stg_market_data_symbol ............................. [RUN]
[0m23:39:34.942662 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_stg_market_data_date.fb73c94489, now test.stock_analytics.not_null_stg_market_data_symbol.478198cf66)
[0m23:39:34.943055 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.not_null_stg_market_data_symbol.478198cf66
[0m23:39:34.948015 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.not_null_stg_market_data_symbol.478198cf66"
[0m23:39:34.949155 [debug] [Thread-1 (]: Began executing node test.stock_analytics.not_null_stg_market_data_symbol.478198cf66
[0m23:39:34.951498 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.not_null_stg_market_data_symbol.478198cf66"
[0m23:39:34.953438 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_stg_market_data_symbol.478198cf66"
[0m23:39:34.953862 [debug] [Thread-1 (]: On test.stock_analytics.not_null_stg_market_data_symbol.478198cf66: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select symbol
from USER_DB_OSTRICH.PUBLIC_STAGING.stg_market_data
where symbol is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stg_market_data_symbol.478198cf66"} */
[0m23:39:37.174875 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.220 seconds
[0m23:39:37.178494 [info ] [Thread-1 (]: 5 of 11 PASS not_null_stg_market_data_symbol ................................... [[32mPASS[0m in 2.24s]
[0m23:39:37.179290 [debug] [Thread-1 (]: Finished running node test.stock_analytics.not_null_stg_market_data_symbol.478198cf66
[0m23:39:37.179780 [debug] [Thread-1 (]: Began running node test.stock_analytics.not_null_stg_market_forecast_date.ca0f3ba00f
[0m23:39:37.180409 [info ] [Thread-1 (]: 6 of 11 START test not_null_stg_market_forecast_date ........................... [RUN]
[0m23:39:37.181044 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_stg_market_data_symbol.478198cf66, now test.stock_analytics.not_null_stg_market_forecast_date.ca0f3ba00f)
[0m23:39:37.181442 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.not_null_stg_market_forecast_date.ca0f3ba00f
[0m23:39:37.186644 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.not_null_stg_market_forecast_date.ca0f3ba00f"
[0m23:39:37.187870 [debug] [Thread-1 (]: Began executing node test.stock_analytics.not_null_stg_market_forecast_date.ca0f3ba00f
[0m23:39:37.190375 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.not_null_stg_market_forecast_date.ca0f3ba00f"
[0m23:39:37.191646 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_stg_market_forecast_date.ca0f3ba00f"
[0m23:39:37.191934 [debug] [Thread-1 (]: On test.stock_analytics.not_null_stg_market_forecast_date.ca0f3ba00f: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date
from USER_DB_OSTRICH.PUBLIC_STAGING.stg_market_forecast
where date is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stg_market_forecast_date.ca0f3ba00f"} */
[0m23:39:37.585408 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.393 seconds
[0m23:39:37.589516 [info ] [Thread-1 (]: 6 of 11 PASS not_null_stg_market_forecast_date ................................. [[32mPASS[0m in 0.41s]
[0m23:39:37.590165 [debug] [Thread-1 (]: Finished running node test.stock_analytics.not_null_stg_market_forecast_date.ca0f3ba00f
[0m23:39:37.590561 [debug] [Thread-1 (]: Began running node test.stock_analytics.not_null_stg_market_forecast_symbol.d304415e8d
[0m23:39:37.591065 [info ] [Thread-1 (]: 7 of 11 START test not_null_stg_market_forecast_symbol ......................... [RUN]
[0m23:39:37.591625 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_stg_market_forecast_date.ca0f3ba00f, now test.stock_analytics.not_null_stg_market_forecast_symbol.d304415e8d)
[0m23:39:37.591991 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.not_null_stg_market_forecast_symbol.d304415e8d
[0m23:39:37.596398 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.not_null_stg_market_forecast_symbol.d304415e8d"
[0m23:39:37.597135 [debug] [Thread-1 (]: Began executing node test.stock_analytics.not_null_stg_market_forecast_symbol.d304415e8d
[0m23:39:37.598916 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.not_null_stg_market_forecast_symbol.d304415e8d"
[0m23:39:37.599630 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_stg_market_forecast_symbol.d304415e8d"
[0m23:39:37.599871 [debug] [Thread-1 (]: On test.stock_analytics.not_null_stg_market_forecast_symbol.d304415e8d: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select symbol
from USER_DB_OSTRICH.PUBLIC_STAGING.stg_market_forecast
where symbol is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stg_market_forecast_symbol.d304415e8d"} */
[0m23:39:37.892379 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.292 seconds
[0m23:39:37.896145 [info ] [Thread-1 (]: 7 of 11 PASS not_null_stg_market_forecast_symbol ............................... [[32mPASS[0m in 0.30s]
[0m23:39:37.896745 [debug] [Thread-1 (]: Finished running node test.stock_analytics.not_null_stg_market_forecast_symbol.d304415e8d
[0m23:39:37.897098 [debug] [Thread-1 (]: Began running node test.stock_analytics.test_forecast_dates_future
[0m23:39:37.897426 [info ] [Thread-1 (]: 8 of 11 START test test_forecast_dates_future .................................. [RUN]
[0m23:39:37.897766 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_stg_market_forecast_symbol.d304415e8d, now test.stock_analytics.test_forecast_dates_future)
[0m23:39:37.898037 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.test_forecast_dates_future
[0m23:39:37.900795 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.test_forecast_dates_future"
[0m23:39:37.901342 [debug] [Thread-1 (]: Began executing node test.stock_analytics.test_forecast_dates_future
[0m23:39:37.902783 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.test_forecast_dates_future"
[0m23:39:37.903569 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.test_forecast_dates_future"
[0m23:39:37.903814 [debug] [Thread-1 (]: On test.stock_analytics.test_forecast_dates_future: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  with max_hist as (
  select symbol, max(date) as max_hist_date
  from USER_DB_OSTRICH.PUBLIC_STAGING.stg_market_data
  group by 1
)
select f.symbol, f.date
from USER_DB_OSTRICH.PUBLIC_ANALYTICS.mart_stock_analysis f
join max_hist m using (symbol)
where f.record_type = 'forecast'
  and f.date <= m.max_hist_date
  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.test_forecast_dates_future"} */
[0m23:39:38.006511 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.102 seconds
[0m23:39:38.010024 [info ] [Thread-1 (]: 8 of 11 PASS test_forecast_dates_future ........................................ [[32mPASS[0m in 0.11s]
[0m23:39:38.010906 [debug] [Thread-1 (]: Finished running node test.stock_analytics.test_forecast_dates_future
[0m23:39:38.011467 [debug] [Thread-1 (]: Began running node test.stock_analytics.unique_mart_stock_analysis_symbol__date__record_type.1fad36923d
[0m23:39:38.011978 [info ] [Thread-1 (]: 9 of 11 START test unique_mart_stock_analysis_symbol__date__record_type ........ [RUN]
[0m23:39:38.012587 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.test_forecast_dates_future, now test.stock_analytics.unique_mart_stock_analysis_symbol__date__record_type.1fad36923d)
[0m23:39:38.013003 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.unique_mart_stock_analysis_symbol__date__record_type.1fad36923d
[0m23:39:38.022169 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.unique_mart_stock_analysis_symbol__date__record_type.1fad36923d"
[0m23:39:38.023847 [debug] [Thread-1 (]: Began executing node test.stock_analytics.unique_mart_stock_analysis_symbol__date__record_type.1fad36923d
[0m23:39:38.026122 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.unique_mart_stock_analysis_symbol__date__record_type.1fad36923d"
[0m23:39:38.027015 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.unique_mart_stock_analysis_symbol__date__record_type.1fad36923d"
[0m23:39:38.027330 [debug] [Thread-1 (]: On test.stock_analytics.unique_mart_stock_analysis_symbol__date__record_type.1fad36923d: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    ['symbol', 'date', 'record_type'] as unique_field,
    count(*) as n_records

from USER_DB_OSTRICH.PUBLIC_ANALYTICS.mart_stock_analysis
where ['symbol', 'date', 'record_type'] is not null
group by ['symbol', 'date', 'record_type']
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.unique_mart_stock_analysis_symbol__date__record_type.1fad36923d"} */
[0m23:39:38.143478 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.116 seconds
[0m23:39:38.146997 [error] [Thread-1 (]: 9 of 11 FAIL 1 unique_mart_stock_analysis_symbol__date__record_type ............ [[31mFAIL 1[0m in 0.13s]
[0m23:39:38.147694 [debug] [Thread-1 (]: Finished running node test.stock_analytics.unique_mart_stock_analysis_symbol__date__record_type.1fad36923d
[0m23:39:38.148120 [debug] [Thread-1 (]: Began running node test.stock_analytics.unique_stg_market_data_symbol__date.3e1fafb254
[0m23:39:38.148574 [info ] [Thread-1 (]: 10 of 11 START test unique_stg_market_data_symbol__date ........................ [RUN]
[0m23:39:38.149071 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.unique_mart_stock_analysis_symbol__date__record_type.1fad36923d, now test.stock_analytics.unique_stg_market_data_symbol__date.3e1fafb254)
[0m23:39:38.149438 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.unique_stg_market_data_symbol__date.3e1fafb254
[0m23:39:38.153820 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.unique_stg_market_data_symbol__date.3e1fafb254"
[0m23:39:38.154897 [debug] [Thread-1 (]: Began executing node test.stock_analytics.unique_stg_market_data_symbol__date.3e1fafb254
[0m23:39:38.157964 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.unique_stg_market_data_symbol__date.3e1fafb254"
[0m23:39:38.159135 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.unique_stg_market_data_symbol__date.3e1fafb254"
[0m23:39:38.159489 [debug] [Thread-1 (]: On test.stock_analytics.unique_stg_market_data_symbol__date.3e1fafb254: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    ['symbol', 'date'] as unique_field,
    count(*) as n_records

from USER_DB_OSTRICH.PUBLIC_STAGING.stg_market_data
where ['symbol', 'date'] is not null
group by ['symbol', 'date']
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.unique_stg_market_data_symbol__date.3e1fafb254"} */
[0m23:39:38.713823 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.554 seconds
[0m23:39:38.717667 [error] [Thread-1 (]: 10 of 11 FAIL 1 unique_stg_market_data_symbol__date ............................ [[31mFAIL 1[0m in 0.57s]
[0m23:39:38.718406 [debug] [Thread-1 (]: Finished running node test.stock_analytics.unique_stg_market_data_symbol__date.3e1fafb254
[0m23:39:38.718849 [debug] [Thread-1 (]: Began running node test.stock_analytics.unique_stg_market_forecast_symbol__date.d55b034665
[0m23:39:38.719298 [info ] [Thread-1 (]: 11 of 11 START test unique_stg_market_forecast_symbol__date .................... [RUN]
[0m23:39:38.719848 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.unique_stg_market_data_symbol__date.3e1fafb254, now test.stock_analytics.unique_stg_market_forecast_symbol__date.d55b034665)
[0m23:39:38.720229 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.unique_stg_market_forecast_symbol__date.d55b034665
[0m23:39:38.724978 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.unique_stg_market_forecast_symbol__date.d55b034665"
[0m23:39:38.726070 [debug] [Thread-1 (]: Began executing node test.stock_analytics.unique_stg_market_forecast_symbol__date.d55b034665
[0m23:39:38.728829 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.unique_stg_market_forecast_symbol__date.d55b034665"
[0m23:39:38.729779 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.unique_stg_market_forecast_symbol__date.d55b034665"
[0m23:39:38.730081 [debug] [Thread-1 (]: On test.stock_analytics.unique_stg_market_forecast_symbol__date.d55b034665: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    ['symbol', 'date'] as unique_field,
    count(*) as n_records

from USER_DB_OSTRICH.PUBLIC_STAGING.stg_market_forecast
where ['symbol', 'date'] is not null
group by ['symbol', 'date']
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.unique_stg_market_forecast_symbol__date.d55b034665"} */
[0m23:39:39.222892 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.492 seconds
[0m23:39:39.226361 [error] [Thread-1 (]: 11 of 11 FAIL 1 unique_stg_market_forecast_symbol__date ........................ [[31mFAIL 1[0m in 0.51s]
[0m23:39:39.227110 [debug] [Thread-1 (]: Finished running node test.stock_analytics.unique_stg_market_forecast_symbol__date.d55b034665
[0m23:39:39.228894 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:39:39.229230 [debug] [MainThread]: Connection 'test.stock_analytics.unique_stg_market_forecast_symbol__date.d55b034665' was left open.
[0m23:39:39.229546 [debug] [MainThread]: On test.stock_analytics.unique_stg_market_forecast_symbol__date.d55b034665: Close
[0m23:39:39.354723 [info ] [MainThread]: 
[0m23:39:39.355465 [info ] [MainThread]: Finished running 11 data tests in 0 hours 0 minutes and 6.34 seconds (6.34s).
[0m23:39:39.357936 [debug] [MainThread]: Command end result
[0m23:39:39.382732 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/target/manifest.json
[0m23:39:39.384218 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/target/semantic_manifest.json
[0m23:39:39.389416 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/target/run_results.json
[0m23:39:39.389622 [info ] [MainThread]: 
[0m23:39:39.389839 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m23:39:39.389998 [info ] [MainThread]: 
[0m23:39:39.390204 [error] [MainThread]: [31mFailure in test unique_mart_stock_analysis_symbol__date__record_type (models/marts/mart_stock_analysis.yml)[0m
[0m23:39:39.390389 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m23:39:39.390513 [info ] [MainThread]: 
[0m23:39:39.390747 [info ] [MainThread]:   compiled code at target/compiled/stock_analytics/models/marts/mart_stock_analysis.yml/unique_mart_stock_analysis_symbol__date__record_type.sql
[0m23:39:39.390915 [info ] [MainThread]: 
[0m23:39:39.391102 [error] [MainThread]: [31mFailure in test unique_stg_market_data_symbol__date (models/staging/stg_market_data.yml)[0m
[0m23:39:39.391279 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m23:39:39.391407 [info ] [MainThread]: 
[0m23:39:39.391569 [info ] [MainThread]:   compiled code at target/compiled/stock_analytics/models/staging/stg_market_data.yml/unique_stg_market_data_symbol__date.sql
[0m23:39:39.391700 [info ] [MainThread]: 
[0m23:39:39.391866 [error] [MainThread]: [31mFailure in test unique_stg_market_forecast_symbol__date (models/staging/stg_market_forecast.yml)[0m
[0m23:39:39.392027 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m23:39:39.392141 [info ] [MainThread]: 
[0m23:39:39.392301 [info ] [MainThread]:   compiled code at target/compiled/stock_analytics/models/staging/stg_market_forecast.yml/unique_stg_market_forecast_symbol__date.sql
[0m23:39:39.392428 [info ] [MainThread]: 
[0m23:39:39.392586 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=3 SKIP=0 NO-OP=0 TOTAL=11
[0m23:39:39.392880 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m23:39:39.397792 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 7.730709, "process_in_blocks": "0", "process_kernel_time": 0.340594, "process_mem_max_rss": "253181952", "process_out_blocks": "0", "process_user_time": 1.661605}
[0m23:39:39.398009 [debug] [MainThread]: Command `dbt test` failed at 23:39:39.397960 after 7.73 seconds
[0m23:39:39.398200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123862ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123834690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1238342d0>]}
[0m23:39:39.398381 [debug] [MainThread]: Flushing usage events
[0m23:39:39.768778 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:41:22.660539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f73e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a37b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a37d90>]}


============================== 23:41:22.662948 | ac6b98dc-dcad-494b-8207-49be3827e789 ==============================
[0m23:41:22.662948 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m23:41:22.663191 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run -s mart_stock_analysis', 'target_path': 'None', 'version_check': 'True', 'no_print': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'warn_error': 'None', 'printer_width': '80', 'quiet': 'False', 'use_experimental_parser': 'False', 'empty': 'False', 'use_colors': 'True', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'static_parser': 'True', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'log_path': '/Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/logs', 'partial_parse': 'True', 'log_format': 'default', 'profiles_dir': '/Users/rahulmohandevi/.dbt', 'debug': 'False'}
[0m23:41:23.321183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ac6b98dc-dcad-494b-8207-49be3827e789', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10631c510>]}
[0m23:41:23.343616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ac6b98dc-dcad-494b-8207-49be3827e789', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1236ec270>]}
[0m23:41:23.344007 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m23:41:23.401812 [debug] [MainThread]: checksum: e63134dccc1251cfb572caf0e4aa952f030c125ee3634f3bf2c0a2e1bb6ae349, vars: {}, profile: , target: , version: 1.11.0b3
[0m23:41:23.469405 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:41:23.469563 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:41:23.487427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ac6b98dc-dcad-494b-8207-49be3827e789', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123beac50>]}
[0m23:41:23.523416 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/target/manifest.json
[0m23:41:23.524422 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/target/semantic_manifest.json
[0m23:41:23.533911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ac6b98dc-dcad-494b-8207-49be3827e789', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12369d400>]}
[0m23:41:23.534091 [info ] [MainThread]: Found 3 models, 11 data tests, 2 sources, 492 macros
[0m23:41:23.534216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac6b98dc-dcad-494b-8207-49be3827e789', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123f25550>]}
[0m23:41:23.534827 [info ] [MainThread]: 
[0m23:41:23.534947 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:41:23.535035 [info ] [MainThread]: 
[0m23:41:23.535210 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:41:23.535541 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_OSTRICH'
[0m23:41:23.561475 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_OSTRICH"
[0m23:41:23.561618 [debug] [ThreadPool]: On list_USER_DB_OSTRICH: show terse schemas in database USER_DB_OSTRICH
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_OSTRICH"} */
[0m23:41:23.561708 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:41:26.273171 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 2.711 seconds
[0m23:41:26.281116 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_OSTRICH, now list_USER_DB_OSTRICH_PUBLIC_STAGING)
[0m23:41:26.294815 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_OSTRICH_PUBLIC_STAGING"
[0m23:41:26.295202 [debug] [ThreadPool]: On list_USER_DB_OSTRICH_PUBLIC_STAGING: show objects in USER_DB_OSTRICH.PUBLIC_STAGING
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_OSTRICH_PUBLIC_STAGING"} */;
[0m23:41:26.391305 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.096 seconds
[0m23:41:26.394737 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_OSTRICH_PUBLIC_STAGING, now list_USER_DB_OSTRICH_PUBLIC_ANALYTICS)
[0m23:41:26.397643 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_OSTRICH_PUBLIC_ANALYTICS"
[0m23:41:26.397970 [debug] [ThreadPool]: On list_USER_DB_OSTRICH_PUBLIC_ANALYTICS: show objects in USER_DB_OSTRICH.PUBLIC_ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_OSTRICH_PUBLIC_ANALYTICS"} */;
[0m23:41:26.743320 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.345 seconds
[0m23:41:26.747103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac6b98dc-dcad-494b-8207-49be3827e789', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124bca4e0>]}
[0m23:41:26.752250 [debug] [Thread-1 (]: Began running node model.stock_analytics.mart_stock_analysis
[0m23:41:26.752961 [info ] [Thread-1 (]: 1 of 1 START sql table model PUBLIC_ANALYTICS.mart_stock_analysis .............. [RUN]
[0m23:41:26.753499 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_OSTRICH_PUBLIC_ANALYTICS, now model.stock_analytics.mart_stock_analysis)
[0m23:41:26.753881 [debug] [Thread-1 (]: Began compiling node model.stock_analytics.mart_stock_analysis
[0m23:41:26.762521 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_analytics.mart_stock_analysis"
[0m23:41:26.763629 [debug] [Thread-1 (]: Began executing node model.stock_analytics.mart_stock_analysis
[0m23:41:26.785269 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_analytics.mart_stock_analysis"
[0m23:41:26.786163 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.mart_stock_analysis"
[0m23:41:26.786385 [debug] [Thread-1 (]: On model.stock_analytics.mart_stock_analysis: create or replace transient table USER_DB_OSTRICH.PUBLIC_ANALYTICS.mart_stock_analysis
    
    
    
    as (

-- Historical slice (from staging)
with hist as (
  select
    symbol,
    date,
    close                as actual_price,
    cast(null as float)  as forecast_price,
    cast(null as float)  as lower_bound,
    cast(null as float)  as upper_bound,
    'historical'         as record_type
  from USER_DB_OSTRICH.PUBLIC_STAGING.stg_market_data
),

-- Forecast slice (from staging)
fut as (
  select
    symbol,
    date,
    cast(null as float)  as actual_price,
    forecast             as forecast_price,
    lower_bound,
    upper_bound,
    'forecast'           as record_type
  from USER_DB_OSTRICH.PUBLIC_STAGING.stg_market_forecast
)

-- Union both
, unioned as (
  select * from hist
  union all
  select * from fut
)

-- In case of any accidental dupes (shouldn't happen, but safe)
select distinct *
from (
  select
    *,
    row_number() over (partition by symbol, date, record_type order by date desc) as rn
  from unioned
)
where rn = 1
    )

/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.mart_stock_analysis"} */;
[0m23:41:27.801305 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.014 seconds
[0m23:41:27.823134 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac6b98dc-dcad-494b-8207-49be3827e789', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124d94110>]}
[0m23:41:27.823699 [info ] [Thread-1 (]: 1 of 1 OK created sql table model PUBLIC_ANALYTICS.mart_stock_analysis ......... [[32mSUCCESS 1[0m in 1.07s]
[0m23:41:27.824078 [debug] [Thread-1 (]: Finished running node model.stock_analytics.mart_stock_analysis
[0m23:41:27.825040 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:41:27.825271 [debug] [MainThread]: Connection 'model.stock_analytics.mart_stock_analysis' was left open.
[0m23:41:27.825445 [debug] [MainThread]: On model.stock_analytics.mart_stock_analysis: Close
[0m23:41:27.930499 [info ] [MainThread]: 
[0m23:41:27.931183 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.40 seconds (4.40s).
[0m23:41:27.932148 [debug] [MainThread]: Command end result
[0m23:41:27.962594 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/target/manifest.json
[0m23:41:27.963598 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/target/semantic_manifest.json
[0m23:41:27.967256 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/target/run_results.json
[0m23:41:27.967428 [info ] [MainThread]: 
[0m23:41:27.967624 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:41:27.967765 [info ] [MainThread]: 
[0m23:41:27.967922 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m23:41:27.972787 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.3393693, "process_in_blocks": "0", "process_kernel_time": 0.305607, "process_mem_max_rss": "244432896", "process_out_blocks": "0", "process_user_time": 1.385738}
[0m23:41:27.973027 [debug] [MainThread]: Command `dbt run` succeeded at 23:41:27.972977 after 5.34 seconds
[0m23:41:27.973211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124cf1910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124c15270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124c171b0>]}
[0m23:41:27.973390 [debug] [MainThread]: Flushing usage events
[0m23:41:28.347430 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:41:41.876190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c93e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a33b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a33d90>]}


============================== 23:41:41.878478 | 01e5d6b6-4021-4619-a2fa-8e4e564663ff ==============================
[0m23:41:41.878478 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m23:41:41.878727 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'target_path': 'None', 'printer_width': '80', 'version_check': 'True', 'log_path': '/Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/logs', 'empty': 'None', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/Users/rahulmohandevi/.dbt', 'no_print': 'None', 'log_format': 'default', 'partial_parse': 'True', 'indirect_selection': 'eager', 'debug': 'False', 'invocation_command': 'dbt test -s mart_stock_analysis', 'static_parser': 'True', 'quiet': 'False', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'write_json': 'True', 'log_cache_events': 'False'}
[0m23:41:42.790650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '01e5d6b6-4021-4619-a2fa-8e4e564663ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10513c510>]}
[0m23:41:42.813632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '01e5d6b6-4021-4619-a2fa-8e4e564663ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121eec270>]}
[0m23:41:42.814238 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m23:41:42.861967 [debug] [MainThread]: checksum: e63134dccc1251cfb572caf0e4aa952f030c125ee3634f3bf2c0a2e1bb6ae349, vars: {}, profile: , target: , version: 1.11.0b3
[0m23:41:42.930921 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:41:42.931096 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:41:42.949287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '01e5d6b6-4021-4619-a2fa-8e4e564663ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12232ad50>]}
[0m23:41:42.986534 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/target/manifest.json
[0m23:41:42.987563 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/target/semantic_manifest.json
[0m23:41:43.002003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '01e5d6b6-4021-4619-a2fa-8e4e564663ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1225ca4e0>]}
[0m23:41:43.002199 [info ] [MainThread]: Found 3 models, 11 data tests, 2 sources, 492 macros
[0m23:41:43.002321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '01e5d6b6-4021-4619-a2fa-8e4e564663ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1226417f0>]}
[0m23:41:43.002987 [info ] [MainThread]: 
[0m23:41:43.003108 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:41:43.003198 [info ] [MainThread]: 
[0m23:41:43.003370 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:41:43.005006 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_OSTRICH_PUBLIC_STAGING'
[0m23:41:43.032203 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_OSTRICH_PUBLIC_STAGING"
[0m23:41:43.032341 [debug] [ThreadPool]: On list_USER_DB_OSTRICH_PUBLIC_STAGING: show objects in USER_DB_OSTRICH.PUBLIC_STAGING
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_OSTRICH_PUBLIC_STAGING"} */;
[0m23:41:43.032436 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:41:45.529479 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 2.497 seconds
[0m23:41:45.533996 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_OSTRICH_PUBLIC_STAGING, now list_USER_DB_OSTRICH_PUBLIC_ANALYTICS)
[0m23:41:45.537164 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_OSTRICH_PUBLIC_ANALYTICS"
[0m23:41:45.537497 [debug] [ThreadPool]: On list_USER_DB_OSTRICH_PUBLIC_ANALYTICS: show objects in USER_DB_OSTRICH.PUBLIC_ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_OSTRICH_PUBLIC_ANALYTICS"} */;
[0m23:41:45.644608 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.107 seconds
[0m23:41:45.647927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '01e5d6b6-4021-4619-a2fa-8e4e564663ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1226bfa00>]}
[0m23:41:45.653145 [debug] [Thread-1 (]: Began running node test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316
[0m23:41:45.653673 [info ] [Thread-1 (]: 1 of 5 START test accepted_values_mart_stock_analysis_record_type__historical__forecast  [RUN]
[0m23:41:45.654204 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_OSTRICH_PUBLIC_ANALYTICS, now test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316)
[0m23:41:45.654595 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316
[0m23:41:45.669932 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316"
[0m23:41:45.670687 [debug] [Thread-1 (]: Began executing node test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316
[0m23:41:45.685898 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316"
[0m23:41:45.686729 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316"
[0m23:41:45.686948 [debug] [Thread-1 (]: On test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        record_type as value_field,
        count(*) as n_records

    from USER_DB_OSTRICH.PUBLIC_ANALYTICS.mart_stock_analysis
    group by record_type

)

select *
from all_values
where value_field not in (
    'historical','forecast'
)



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316"} */
[0m23:41:45.867688 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.180 seconds
[0m23:41:45.877964 [info ] [Thread-1 (]: 1 of 5 PASS accepted_values_mart_stock_analysis_record_type__historical__forecast  [[32mPASS[0m in 0.22s]
[0m23:41:45.878592 [debug] [Thread-1 (]: Finished running node test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316
[0m23:41:45.878964 [debug] [Thread-1 (]: Began running node test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5
[0m23:41:45.879370 [info ] [Thread-1 (]: 2 of 5 START test not_null_mart_stock_analysis_date ............................ [RUN]
[0m23:41:45.879764 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316, now test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5)
[0m23:41:45.880060 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5
[0m23:41:45.888500 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5"
[0m23:41:45.888950 [debug] [Thread-1 (]: Began executing node test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5
[0m23:41:45.889846 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5"
[0m23:41:45.890257 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5"
[0m23:41:45.890384 [debug] [Thread-1 (]: On test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date
from USER_DB_OSTRICH.PUBLIC_ANALYTICS.mart_stock_analysis
where date is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5"} */
[0m23:41:46.113229 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.222 seconds
[0m23:41:46.117006 [info ] [Thread-1 (]: 2 of 5 PASS not_null_mart_stock_analysis_date .................................. [[32mPASS[0m in 0.24s]
[0m23:41:46.117687 [debug] [Thread-1 (]: Finished running node test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5
[0m23:41:46.118099 [debug] [Thread-1 (]: Began running node test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e
[0m23:41:46.118544 [info ] [Thread-1 (]: 3 of 5 START test not_null_mart_stock_analysis_symbol .......................... [RUN]
[0m23:41:46.119029 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5, now test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e)
[0m23:41:46.119382 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e
[0m23:41:46.124144 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e"
[0m23:41:46.125100 [debug] [Thread-1 (]: Began executing node test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e
[0m23:41:46.127877 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e"
[0m23:41:46.129036 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e"
[0m23:41:46.129340 [debug] [Thread-1 (]: On test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select symbol
from USER_DB_OSTRICH.PUBLIC_ANALYTICS.mart_stock_analysis
where symbol is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e"} */
[0m23:41:46.500710 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.371 seconds
[0m23:41:46.504732 [info ] [Thread-1 (]: 3 of 5 PASS not_null_mart_stock_analysis_symbol ................................ [[32mPASS[0m in 0.39s]
[0m23:41:46.505493 [debug] [Thread-1 (]: Finished running node test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e
[0m23:41:46.505973 [debug] [Thread-1 (]: Began running node test.stock_analytics.test_forecast_dates_future
[0m23:41:46.506446 [info ] [Thread-1 (]: 4 of 5 START test test_forecast_dates_future ................................... [RUN]
[0m23:41:46.507002 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e, now test.stock_analytics.test_forecast_dates_future)
[0m23:41:46.507415 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.test_forecast_dates_future
[0m23:41:46.511369 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.test_forecast_dates_future"
[0m23:41:46.513672 [debug] [Thread-1 (]: Began executing node test.stock_analytics.test_forecast_dates_future
[0m23:41:46.516531 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.test_forecast_dates_future"
[0m23:41:46.518061 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.test_forecast_dates_future"
[0m23:41:46.518443 [debug] [Thread-1 (]: On test.stock_analytics.test_forecast_dates_future: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  with max_hist as (
  select symbol, max(date) as max_hist_date
  from USER_DB_OSTRICH.PUBLIC_STAGING.stg_market_data
  group by 1
)
select f.symbol, f.date
from USER_DB_OSTRICH.PUBLIC_ANALYTICS.mart_stock_analysis f
join max_hist m using (symbol)
where f.record_type = 'forecast'
  and f.date <= m.max_hist_date
  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.test_forecast_dates_future"} */
[0m23:41:46.902906 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.384 seconds
[0m23:41:46.906447 [info ] [Thread-1 (]: 4 of 5 PASS test_forecast_dates_future ......................................... [[32mPASS[0m in 0.40s]
[0m23:41:46.907197 [debug] [Thread-1 (]: Finished running node test.stock_analytics.test_forecast_dates_future
[0m23:41:46.907667 [debug] [Thread-1 (]: Began running node test.stock_analytics.unique_mart_stock_analysis_symbol__date__record_type.1fad36923d
[0m23:41:46.908148 [info ] [Thread-1 (]: 5 of 5 START test unique_mart_stock_analysis_symbol__date__record_type ......... [RUN]
[0m23:41:46.908722 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.test_forecast_dates_future, now test.stock_analytics.unique_mart_stock_analysis_symbol__date__record_type.1fad36923d)
[0m23:41:46.909140 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.unique_mart_stock_analysis_symbol__date__record_type.1fad36923d
[0m23:41:46.918186 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.unique_mart_stock_analysis_symbol__date__record_type.1fad36923d"
[0m23:41:46.920195 [debug] [Thread-1 (]: Began executing node test.stock_analytics.unique_mart_stock_analysis_symbol__date__record_type.1fad36923d
[0m23:41:46.923149 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.unique_mart_stock_analysis_symbol__date__record_type.1fad36923d"
[0m23:41:46.924306 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.unique_mart_stock_analysis_symbol__date__record_type.1fad36923d"
[0m23:41:46.924623 [debug] [Thread-1 (]: On test.stock_analytics.unique_mart_stock_analysis_symbol__date__record_type.1fad36923d: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    ['symbol', 'date', 'record_type'] as unique_field,
    count(*) as n_records

from USER_DB_OSTRICH.PUBLIC_ANALYTICS.mart_stock_analysis
where ['symbol', 'date', 'record_type'] is not null
group by ['symbol', 'date', 'record_type']
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.unique_mart_stock_analysis_symbol__date__record_type.1fad36923d"} */
[0m23:41:47.221817 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.297 seconds
[0m23:41:47.225611 [error] [Thread-1 (]: 5 of 5 FAIL 1 unique_mart_stock_analysis_symbol__date__record_type ............. [[31mFAIL 1[0m in 0.32s]
[0m23:41:47.226331 [debug] [Thread-1 (]: Finished running node test.stock_analytics.unique_mart_stock_analysis_symbol__date__record_type.1fad36923d
[0m23:41:47.228035 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:41:47.228365 [debug] [MainThread]: Connection 'test.stock_analytics.unique_mart_stock_analysis_symbol__date__record_type.1fad36923d' was left open.
[0m23:41:47.228763 [debug] [MainThread]: On test.stock_analytics.unique_mart_stock_analysis_symbol__date__record_type.1fad36923d: Close
[0m23:41:47.339341 [info ] [MainThread]: 
[0m23:41:47.340139 [info ] [MainThread]: Finished running 5 data tests in 0 hours 0 minutes and 4.34 seconds (4.34s).
[0m23:41:47.341717 [debug] [MainThread]: Command end result
[0m23:41:47.365113 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/target/manifest.json
[0m23:41:47.366468 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/target/semantic_manifest.json
[0m23:41:47.371627 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/target/run_results.json
[0m23:41:47.371817 [info ] [MainThread]: 
[0m23:41:47.372036 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m23:41:47.372202 [info ] [MainThread]: 
[0m23:41:47.372419 [error] [MainThread]: [31mFailure in test unique_mart_stock_analysis_symbol__date__record_type (models/marts/mart_stock_analysis.yml)[0m
[0m23:41:47.372617 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m23:41:47.372753 [info ] [MainThread]: 
[0m23:41:47.372935 [info ] [MainThread]:   compiled code at target/compiled/stock_analytics/models/marts/mart_stock_analysis.yml/unique_mart_stock_analysis_symbol__date__record_type.sql
[0m23:41:47.373081 [info ] [MainThread]: 
[0m23:41:47.373262 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=5
[0m23:41:47.378821 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 5.530918, "process_in_blocks": "0", "process_kernel_time": 0.33221, "process_mem_max_rss": "248823808", "process_out_blocks": "0", "process_user_time": 1.467822}
[0m23:41:47.379057 [debug] [MainThread]: Command `dbt test` failed at 23:41:47.379008 after 5.53 seconds
[0m23:41:47.379254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068425d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1234c0730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1234c0aa0>]}
[0m23:41:47.379423 [debug] [MainThread]: Flushing usage events
[0m23:41:47.679032 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:50:28.065307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111393e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114937b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114937d90>]}


============================== 23:50:28.067856 | 7f18e0ad-b7e7-44c7-b39d-a9e872d8423b ==============================
[0m23:50:28.067856 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m23:50:28.068106 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'static_parser': 'True', 'introspect': 'True', 'partial_parse': 'True', 'printer_width': '80', 'write_json': 'True', 'no_print': 'None', 'log_format': 'default', 'quiet': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'target_path': 'None', 'profiles_dir': '/Users/rahulmohandevi/.dbt', 'use_colors': 'True', 'invocation_command': 'dbt ls -s mart_stock_analysis', 'empty': 'None', 'log_path': '/Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/logs'}
[0m23:50:28.819835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7f18e0ad-b7e7-44c7-b39d-a9e872d8423b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c3c510>]}
[0m23:50:28.842965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7f18e0ad-b7e7-44c7-b39d-a9e872d8423b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125be0380>]}
[0m23:50:28.843459 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m23:50:28.895545 [debug] [MainThread]: checksum: e63134dccc1251cfb572caf0e4aa952f030c125ee3634f3bf2c0a2e1bb6ae349, vars: {}, profile: , target: , version: 1.11.0b3
[0m23:50:28.971329 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:50:28.971504 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:50:28.989940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7f18e0ad-b7e7-44c7-b39d-a9e872d8423b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1260e6d50>]}
[0m23:50:29.026535 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/target/manifest.json
[0m23:50:29.027656 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/target/semantic_manifest.json
[0m23:50:29.037204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7f18e0ad-b7e7-44c7-b39d-a9e872d8423b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1262b0aa0>]}
[0m23:50:29.037381 [info ] [MainThread]: Found 3 models, 11 data tests, 2 sources, 492 macros
[0m23:50:29.037500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7f18e0ad-b7e7-44c7-b39d-a9e872d8423b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12644cd70>]}
[0m23:50:29.037779 [info ] [MainThread]: stock_analytics.marts.mart_stock_analysis
[0m23:50:29.037894 [info ] [MainThread]: stock_analytics.marts.accepted_values_mart_stock_analysis_record_type__historical__forecast
[0m23:50:29.037978 [info ] [MainThread]: stock_analytics.marts.not_null_mart_stock_analysis_date
[0m23:50:29.038059 [info ] [MainThread]: stock_analytics.marts.not_null_mart_stock_analysis_symbol
[0m23:50:29.038134 [info ] [MainThread]: stock_analytics.test_forecast_dates_future
[0m23:50:29.038213 [info ] [MainThread]: stock_analytics.marts.unique_mart_stock_analysis_symbol__date__record_type
[0m23:50:29.041649 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 1.0066708, "process_in_blocks": "0", "process_kernel_time": 0.250334, "process_mem_max_rss": "221347840", "process_out_blocks": "0", "process_user_time": 1.088356}
[0m23:50:29.041794 [debug] [MainThread]: Command `dbt ls` succeeded at 23:50:29.041760 after 1.01 seconds
[0m23:50:29.041923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126410390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113f1e5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12626b650>]}
[0m23:50:29.042027 [debug] [MainThread]: Flushing usage events
[0m23:50:29.408228 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:50:40.323151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a2fe00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fabb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fabd90>]}


============================== 23:50:40.325010 | 4387de7d-3bf2-49a7-9aa1-db8eb7dc9e87 ==============================
[0m23:50:40.325010 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m23:50:40.325249 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'empty': 'False', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'static_parser': 'True', 'warn_error': 'None', 'partial_parse': 'True', 'invocation_command': 'dbt run -s mart_stock_analysis', 'write_json': 'True', 'log_format': 'default', 'introspect': 'True', 'indirect_selection': 'eager', 'printer_width': '80', 'use_colors': 'True', 'fail_fast': 'False', 'cache_selected_only': 'False', 'debug': 'False', 'profiles_dir': '/Users/rahulmohandevi/.dbt', 'log_cache_events': 'False', 'log_path': '/Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/logs', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'quiet': 'False'}
[0m23:50:40.754174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4387de7d-3bf2-49a7-9aa1-db8eb7dc9e87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dd8510>]}
[0m23:50:40.777560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4387de7d-3bf2-49a7-9aa1-db8eb7dc9e87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11adec270>]}
[0m23:50:40.777899 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m23:50:40.822337 [debug] [MainThread]: checksum: e63134dccc1251cfb572caf0e4aa952f030c125ee3634f3bf2c0a2e1bb6ae349, vars: {}, profile: , target: , version: 1.11.0b3
[0m23:50:40.884908 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:50:40.885076 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:50:40.903750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4387de7d-3bf2-49a7-9aa1-db8eb7dc9e87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bb0ac50>]}
[0m23:50:40.941107 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/target/manifest.json
[0m23:50:40.941923 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/target/semantic_manifest.json
[0m23:50:40.948443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4387de7d-3bf2-49a7-9aa1-db8eb7dc9e87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ad99400>]}
[0m23:50:40.948625 [info ] [MainThread]: Found 3 models, 11 data tests, 2 sources, 492 macros
[0m23:50:40.948752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4387de7d-3bf2-49a7-9aa1-db8eb7dc9e87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bd45550>]}
[0m23:50:40.949355 [info ] [MainThread]: 
[0m23:50:40.949479 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:50:40.949573 [info ] [MainThread]: 
[0m23:50:40.949748 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:50:40.950075 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_OSTRICH'
[0m23:50:41.007702 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_OSTRICH"
[0m23:50:41.007869 [debug] [ThreadPool]: On list_USER_DB_OSTRICH: show terse schemas in database USER_DB_OSTRICH
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_OSTRICH"} */
[0m23:50:41.007961 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:50:43.555598 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 2.547 seconds
[0m23:50:43.564680 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_OSTRICH, now list_USER_DB_OSTRICH_PUBLIC_STAGING)
[0m23:50:43.579115 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_OSTRICH_PUBLIC_STAGING"
[0m23:50:43.579503 [debug] [ThreadPool]: On list_USER_DB_OSTRICH_PUBLIC_STAGING: show objects in USER_DB_OSTRICH.PUBLIC_STAGING
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_OSTRICH_PUBLIC_STAGING"} */;
[0m23:50:43.828899 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.249 seconds
[0m23:50:43.833217 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_OSTRICH_PUBLIC_STAGING, now list_USER_DB_OSTRICH_PUBLIC_ANALYTICS)
[0m23:50:43.835465 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_OSTRICH_PUBLIC_ANALYTICS"
[0m23:50:43.835741 [debug] [ThreadPool]: On list_USER_DB_OSTRICH_PUBLIC_ANALYTICS: show objects in USER_DB_OSTRICH.PUBLIC_ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_OSTRICH_PUBLIC_ANALYTICS"} */;
[0m23:50:43.934182 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.098 seconds
[0m23:50:43.938277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4387de7d-3bf2-49a7-9aa1-db8eb7dc9e87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11dcca4e0>]}
[0m23:50:43.941970 [debug] [Thread-1 (]: Began running node model.stock_analytics.mart_stock_analysis
[0m23:50:43.942432 [info ] [Thread-1 (]: 1 of 1 START sql table model PUBLIC_ANALYTICS.mart_stock_analysis .............. [RUN]
[0m23:50:43.942806 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_OSTRICH_PUBLIC_ANALYTICS, now model.stock_analytics.mart_stock_analysis)
[0m23:50:43.943082 [debug] [Thread-1 (]: Began compiling node model.stock_analytics.mart_stock_analysis
[0m23:50:43.950021 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_analytics.mart_stock_analysis"
[0m23:50:43.950596 [debug] [Thread-1 (]: Began executing node model.stock_analytics.mart_stock_analysis
[0m23:50:43.969419 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_analytics.mart_stock_analysis"
[0m23:50:43.970235 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.mart_stock_analysis"
[0m23:50:43.970448 [debug] [Thread-1 (]: On model.stock_analytics.mart_stock_analysis: create or replace transient table USER_DB_OSTRICH.PUBLIC_ANALYTICS.mart_stock_analysis
    
    
    
    as (

-- Historical slice (from staging)
with hist as (
  select
    symbol,
    date,
    close                as actual_price,
    cast(null as float)  as forecast_price,
    cast(null as float)  as lower_bound,
    cast(null as float)  as upper_bound,
    'historical'         as record_type
  from USER_DB_OSTRICH.PUBLIC_STAGING.stg_market_data
),

-- Forecast slice (from staging)
fut as (
  select
    symbol,
    date,
    cast(null as float)  as actual_price,
    forecast             as forecast_price,
    lower_bound,
    upper_bound,
    'forecast'           as record_type
  from USER_DB_OSTRICH.PUBLIC_STAGING.stg_market_forecast
)

-- Union both
, unioned as (
  select * from hist
  union all
  select * from fut
)

-- In case of any accidental dupes (shouldn't happen, but safe)
select distinct *
from (
  select
    *,
    row_number() over (partition by symbol, date, record_type order by date desc) as rn
  from unioned
)
where rn = 1
    )

/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.mart_stock_analysis"} */;
[0m23:50:46.202829 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.232 seconds
[0m23:50:46.227352 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4387de7d-3bf2-49a7-9aa1-db8eb7dc9e87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11de94110>]}
[0m23:50:46.227840 [info ] [Thread-1 (]: 1 of 1 OK created sql table model PUBLIC_ANALYTICS.mart_stock_analysis ......... [[32mSUCCESS 1[0m in 2.28s]
[0m23:50:46.228180 [debug] [Thread-1 (]: Finished running node model.stock_analytics.mart_stock_analysis
[0m23:50:46.228990 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:50:46.229191 [debug] [MainThread]: Connection 'model.stock_analytics.mart_stock_analysis' was left open.
[0m23:50:46.229349 [debug] [MainThread]: On model.stock_analytics.mart_stock_analysis: Close
[0m23:50:46.687163 [info ] [MainThread]: 
[0m23:50:46.688112 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.74 seconds (5.74s).
[0m23:50:46.689164 [debug] [MainThread]: Command end result
[0m23:50:46.711483 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/target/manifest.json
[0m23:50:46.712429 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/target/semantic_manifest.json
[0m23:50:46.715208 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/target/run_results.json
[0m23:50:46.715349 [info ] [MainThread]: 
[0m23:50:46.715506 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:50:46.715615 [info ] [MainThread]: 
[0m23:50:46.715741 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m23:50:46.719185 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.421967, "process_in_blocks": "0", "process_kernel_time": 0.240005, "process_mem_max_rss": "245645312", "process_out_blocks": "0", "process_user_time": 1.324021}
[0m23:50:46.719363 [debug] [MainThread]: Command `dbt run` succeeded at 23:50:46.719324 after 6.42 seconds
[0m23:50:46.719516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ddf1910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11dd15270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11dd17390>]}
[0m23:50:46.719657 [debug] [MainThread]: Flushing usage events
[0m23:50:47.027928 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:55:40.708547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105957e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ed7b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ed7d90>]}


============================== 23:55:40.711177 | c26c6bf2-c49c-4834-8506-af4cdc51bfee ==============================
[0m23:55:40.711177 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m23:55:40.711428 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'log_format': 'default', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'quiet': 'False', 'use_experimental_parser': 'False', 'log_path': '/Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/logs', 'debug': 'False', 'indirect_selection': 'eager', 'partial_parse': 'True', 'empty': 'None', 'use_colors': 'True', 'static_parser': 'True', 'write_json': 'True', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'warn_error': 'None', 'log_cache_events': 'False', 'no_print': 'None', 'profiles_dir': '/Users/rahulmohandevi/.dbt', 'target_path': 'None', 'invocation_command': 'dbt ls --resource-type test'}
[0m23:55:41.451008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c26c6bf2-c49c-4834-8506-af4cdc51bfee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d00510>]}
[0m23:55:41.473704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c26c6bf2-c49c-4834-8506-af4cdc51bfee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e9f0380>]}
[0m23:55:41.474228 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m23:55:41.522189 [debug] [MainThread]: checksum: e63134dccc1251cfb572caf0e4aa952f030c125ee3634f3bf2c0a2e1bb6ae349, vars: {}, profile: , target: , version: 1.11.0b3
[0m23:55:41.593389 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:55:41.593702 [info ] [MainThread]: Unable to do partial parsing because an error occurred. Switching to full reparse.
[0m23:55:41.595270 [debug] [MainThread]: Partial parsing exception processing file stock_analytics://models/marts/mart_stock_analysis.yml
[0m23:55:41.595428 [debug] [MainThread]: PP exception info: {'location': 'line 920 in remove_tests', 'parse_file_type': 'schema', 'code': 'if child_test.attached_node:', 'exception': "AttributeError: 'SingularTestNode' object has no attribute 'attached_node'", 'traceback': 'Traceback (most recent call last):\n  File "/opt/anaconda3/lib/python3.13/site-packages/dbt/parser/manifest.py", line 548, in safe_update_project_parser_files_partially\n    project_parser_files = self.partial_parser.get_parsing_files()\n  File "/opt/anaconda3/lib/python3.13/site-packages/dbt/parser/partial.py", line 188, in get_parsing_files\n    self.change_schema_file(file_id)\n    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^\n  File "/opt/anaconda3/lib/python3.13/site-packages/dbt/parser/partial.py", line 642, in change_schema_file\n    self.handle_schema_file_changes(saved_schema_file, saved_yaml_dict, new_yaml_dict)\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/anaconda3/lib/python3.13/site-packages/dbt/parser/partial.py", line 679, in handle_schema_file_changes\n    self.delete_schema_mssa_links(schema_file, dict_key, elem)\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/anaconda3/lib/python3.13/site-packages/dbt/parser/partial.py", line 852, in delete_schema_mssa_links\n    self._delete_schema_mssa_links(schema_file, dict_key, elem, elem_unique_ids)\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/anaconda3/lib/python3.13/site-packages/dbt/parser/partial.py", line 905, in _delete_schema_mssa_links\n    self.remove_tests(schema_file, dict_key, elem["name"])\n    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/anaconda3/lib/python3.13/site-packages/dbt/parser/partial.py", line 920, in remove_tests\n    if child_test.attached_node:\n       ^^^^^^^^^^^^^^^^^^^^^^^^\nAttributeError: \'SingularTestNode\' object has no attribute \'attached_node\'\n'}
[0m23:55:41.595569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c26c6bf2-c49c-4834-8506-af4cdc51bfee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10edd2450>]}
[0m23:55:41.989014 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'mart_stock_analysis' in package 'stock_analytics'
(models/marts/mart_stock_analysis.yml). Arguments to generic tests should be
nested under the `arguments` property.
[0m23:55:41.989261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c26c6bf2-c49c-4834-8506-af4cdc51bfee', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f3008c0>]}
[0m23:55:42.073347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c26c6bf2-c49c-4834-8506-af4cdc51bfee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f15c590>]}
[0m23:55:42.108329 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/target/manifest.json
[0m23:55:42.109372 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/target/semantic_manifest.json
[0m23:55:42.118462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c26c6bf2-c49c-4834-8506-af4cdc51bfee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ed51230>]}
[0m23:55:42.118630 [info ] [MainThread]: Found 3 models, 11 data tests, 2 sources, 492 macros
[0m23:55:42.118743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c26c6bf2-c49c-4834-8506-af4cdc51bfee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eb42c90>]}
[0m23:55:42.119120 [info ] [MainThread]: stock_analytics.marts.accepted_values_mart_stock_analysis_record_type__historical__forecast
[0m23:55:42.119235 [info ] [MainThread]: stock_analytics.marts.not_null_mart_stock_analysis_date
[0m23:55:42.119318 [info ] [MainThread]: stock_analytics.marts.not_null_mart_stock_analysis_symbol
[0m23:55:42.119395 [info ] [MainThread]: stock_analytics.staging.not_null_stg_market_data_date
[0m23:55:42.119475 [info ] [MainThread]: stock_analytics.staging.not_null_stg_market_data_symbol
[0m23:55:42.119549 [info ] [MainThread]: stock_analytics.staging.not_null_stg_market_forecast_date
[0m23:55:42.119626 [info ] [MainThread]: stock_analytics.staging.not_null_stg_market_forecast_symbol
[0m23:55:42.119700 [info ] [MainThread]: stock_analytics.test_forecast_dates_future
[0m23:55:42.119776 [info ] [MainThread]: stock_analytics.marts.unique_mart_stock_analysis_symbol__date__record_type
[0m23:55:42.119850 [info ] [MainThread]: stock_analytics.staging.unique_stg_market_data_symbol__date
[0m23:55:42.119923 [info ] [MainThread]: stock_analytics.staging.unique_stg_market_forecast_symbol__date
[0m23:55:42.120104 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m23:55:42.123167 [debug] [MainThread]: Resource report: {"command_name": "list", "command_success": true, "command_wall_clock_time": 1.4443833, "process_in_blocks": "0", "process_kernel_time": 0.238845, "process_mem_max_rss": "226967552", "process_out_blocks": "0", "process_user_time": 1.502864}
[0m23:55:42.123304 [debug] [MainThread]: Command `dbt ls` succeeded at 23:55:42.123271 after 1.44 seconds
[0m23:55:42.123424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f44f490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10627edf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ec5b750>]}
[0m23:55:42.123523 [debug] [MainThread]: Flushing usage events
[0m23:55:43.316001 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:56:53.098183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a93e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11263bb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11263bd90>]}


============================== 23:56:53.100572 | 0a3342f7-aaed-49fb-a3b5-bcb8c0ab2386 ==============================
[0m23:56:53.100572 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m23:56:53.100817 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'log_path': '/Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/logs', 'indirect_selection': 'eager', 'invocation_command': 'dbt test --select test_type:generic', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'cache_selected_only': 'False', 'debug': 'False', 'warn_error': 'None', 'log_cache_events': 'False', 'write_json': 'True', 'static_parser': 'True', 'fail_fast': 'False', 'printer_width': '80', 'quiet': 'False', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'empty': 'None', 'profiles_dir': '/Users/rahulmohandevi/.dbt', 'use_experimental_parser': 'False', 'introspect': 'True', 'log_format': 'default'}
[0m23:56:53.773130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0a3342f7-aaed-49fb-a3b5-bcb8c0ab2386', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f3c510>]}
[0m23:56:53.795619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0a3342f7-aaed-49fb-a3b5-bcb8c0ab2386', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125cec270>]}
[0m23:56:53.796017 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m23:56:53.846440 [debug] [MainThread]: checksum: e63134dccc1251cfb572caf0e4aa952f030c125ee3634f3bf2c0a2e1bb6ae349, vars: {}, profile: , target: , version: 1.11.0b3
[0m23:56:53.913521 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:56:53.913696 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:56:53.931489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0a3342f7-aaed-49fb-a3b5-bcb8c0ab2386', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12612ac50>]}
[0m23:56:53.967815 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/target/manifest.json
[0m23:56:53.968791 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/target/semantic_manifest.json
[0m23:56:53.982962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0a3342f7-aaed-49fb-a3b5-bcb8c0ab2386', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1263be4e0>]}
[0m23:56:53.983160 [info ] [MainThread]: Found 3 models, 11 data tests, 2 sources, 492 macros
[0m23:56:53.983290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a3342f7-aaed-49fb-a3b5-bcb8c0ab2386', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1264417f0>]}
[0m23:56:53.983971 [info ] [MainThread]: 
[0m23:56:53.984094 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:56:53.984180 [info ] [MainThread]: 
[0m23:56:53.984355 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:56:53.985956 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_OSTRICH_PUBLIC_STAGING'
[0m23:56:54.045815 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_OSTRICH_PUBLIC_STAGING"
[0m23:56:54.045979 [debug] [ThreadPool]: On list_USER_DB_OSTRICH_PUBLIC_STAGING: show objects in USER_DB_OSTRICH.PUBLIC_STAGING
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_OSTRICH_PUBLIC_STAGING"} */;
[0m23:56:54.046073 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:56:56.886982 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 2.841 seconds
[0m23:56:56.889975 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_OSTRICH_PUBLIC_STAGING, now list_USER_DB_OSTRICH_PUBLIC_ANALYTICS)
[0m23:56:56.893473 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_OSTRICH_PUBLIC_ANALYTICS"
[0m23:56:56.893881 [debug] [ThreadPool]: On list_USER_DB_OSTRICH_PUBLIC_ANALYTICS: show objects in USER_DB_OSTRICH.PUBLIC_ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_OSTRICH_PUBLIC_ANALYTICS"} */;
[0m23:56:57.022011 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.128 seconds
[0m23:56:57.024729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a3342f7-aaed-49fb-a3b5-bcb8c0ab2386', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1264b2680>]}
[0m23:56:57.029147 [debug] [Thread-1 (]: Began running node test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316
[0m23:56:57.029792 [info ] [Thread-1 (]: 1 of 10 START test accepted_values_mart_stock_analysis_record_type__historical__forecast  [RUN]
[0m23:56:57.030473 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_OSTRICH_PUBLIC_ANALYTICS, now test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316)
[0m23:56:57.030871 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316
[0m23:56:57.044698 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316"
[0m23:56:57.045640 [debug] [Thread-1 (]: Began executing node test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316
[0m23:56:57.060488 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316"
[0m23:56:57.061340 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316"
[0m23:56:57.061559 [debug] [Thread-1 (]: On test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        record_type as value_field,
        count(*) as n_records

    from USER_DB_OSTRICH.PUBLIC_ANALYTICS.mart_stock_analysis
    group by record_type

)

select *
from all_values
where value_field not in (
    'historical','forecast'
)



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316"} */
[0m23:56:57.390678 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.329 seconds
[0m23:56:57.403189 [info ] [Thread-1 (]: 1 of 10 PASS accepted_values_mart_stock_analysis_record_type__historical__forecast  [[32mPASS[0m in 0.37s]
[0m23:56:57.404058 [debug] [Thread-1 (]: Finished running node test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316
[0m23:56:57.404444 [debug] [Thread-1 (]: Began running node test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5
[0m23:56:57.404865 [info ] [Thread-1 (]: 2 of 10 START test not_null_mart_stock_analysis_date ........................... [RUN]
[0m23:56:57.405280 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316, now test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5)
[0m23:56:57.405589 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5
[0m23:56:57.422053 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5"
[0m23:56:57.422881 [debug] [Thread-1 (]: Began executing node test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5
[0m23:56:57.424375 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5"
[0m23:56:57.425062 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5"
[0m23:56:57.425291 [debug] [Thread-1 (]: On test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date
from USER_DB_OSTRICH.PUBLIC_ANALYTICS.mart_stock_analysis
where date is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5"} */
[0m23:56:57.676764 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.251 seconds
[0m23:56:57.679915 [info ] [Thread-1 (]: 2 of 10 PASS not_null_mart_stock_analysis_date ................................. [[32mPASS[0m in 0.27s]
[0m23:56:57.680700 [debug] [Thread-1 (]: Finished running node test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5
[0m23:56:57.681170 [debug] [Thread-1 (]: Began running node test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e
[0m23:56:57.681669 [info ] [Thread-1 (]: 3 of 10 START test not_null_mart_stock_analysis_symbol ......................... [RUN]
[0m23:56:57.682214 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5, now test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e)
[0m23:56:57.682608 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e
[0m23:56:57.687453 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e"
[0m23:56:57.688151 [debug] [Thread-1 (]: Began executing node test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e
[0m23:56:57.690843 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e"
[0m23:56:57.691893 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e"
[0m23:56:57.692189 [debug] [Thread-1 (]: On test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select symbol
from USER_DB_OSTRICH.PUBLIC_ANALYTICS.mart_stock_analysis
where symbol is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e"} */
[0m23:56:57.985384 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.293 seconds
[0m23:56:57.990116 [info ] [Thread-1 (]: 3 of 10 PASS not_null_mart_stock_analysis_symbol ............................... [[32mPASS[0m in 0.31s]
[0m23:56:57.991042 [debug] [Thread-1 (]: Finished running node test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e
[0m23:56:57.991316 [debug] [Thread-1 (]: Began running node test.stock_analytics.not_null_stg_market_data_date.fb73c94489
[0m23:56:57.991628 [info ] [Thread-1 (]: 4 of 10 START test not_null_stg_market_data_date ............................... [RUN]
[0m23:56:57.992009 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e, now test.stock_analytics.not_null_stg_market_data_date.fb73c94489)
[0m23:56:57.992264 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.not_null_stg_market_data_date.fb73c94489
[0m23:56:57.995163 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.not_null_stg_market_data_date.fb73c94489"
[0m23:56:57.996579 [debug] [Thread-1 (]: Began executing node test.stock_analytics.not_null_stg_market_data_date.fb73c94489
[0m23:56:57.998292 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.not_null_stg_market_data_date.fb73c94489"
[0m23:56:57.998873 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_stg_market_data_date.fb73c94489"
[0m23:56:57.999082 [debug] [Thread-1 (]: On test.stock_analytics.not_null_stg_market_data_date.fb73c94489: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date
from USER_DB_OSTRICH.PUBLIC_STAGING.stg_market_data
where date is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stg_market_data_date.fb73c94489"} */
[0m23:56:58.105765 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.106 seconds
[0m23:56:58.108565 [info ] [Thread-1 (]: 4 of 10 PASS not_null_stg_market_data_date ..................................... [[32mPASS[0m in 0.12s]
[0m23:56:58.109348 [debug] [Thread-1 (]: Finished running node test.stock_analytics.not_null_stg_market_data_date.fb73c94489
[0m23:56:58.109868 [debug] [Thread-1 (]: Began running node test.stock_analytics.not_null_stg_market_data_symbol.478198cf66
[0m23:56:58.110358 [info ] [Thread-1 (]: 5 of 10 START test not_null_stg_market_data_symbol ............................. [RUN]
[0m23:56:58.110954 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_stg_market_data_date.fb73c94489, now test.stock_analytics.not_null_stg_market_data_symbol.478198cf66)
[0m23:56:58.111390 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.not_null_stg_market_data_symbol.478198cf66
[0m23:56:58.116180 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.not_null_stg_market_data_symbol.478198cf66"
[0m23:56:58.117951 [debug] [Thread-1 (]: Began executing node test.stock_analytics.not_null_stg_market_data_symbol.478198cf66
[0m23:56:58.120576 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.not_null_stg_market_data_symbol.478198cf66"
[0m23:56:58.121930 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_stg_market_data_symbol.478198cf66"
[0m23:56:58.122303 [debug] [Thread-1 (]: On test.stock_analytics.not_null_stg_market_data_symbol.478198cf66: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select symbol
from USER_DB_OSTRICH.PUBLIC_STAGING.stg_market_data
where symbol is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stg_market_data_symbol.478198cf66"} */
[0m23:56:58.394374 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.271 seconds
[0m23:56:58.398018 [info ] [Thread-1 (]: 5 of 10 PASS not_null_stg_market_data_symbol ................................... [[32mPASS[0m in 0.29s]
[0m23:56:58.398738 [debug] [Thread-1 (]: Finished running node test.stock_analytics.not_null_stg_market_data_symbol.478198cf66
[0m23:56:58.399181 [debug] [Thread-1 (]: Began running node test.stock_analytics.not_null_stg_market_forecast_date.ca0f3ba00f
[0m23:56:58.399632 [info ] [Thread-1 (]: 6 of 10 START test not_null_stg_market_forecast_date ........................... [RUN]
[0m23:56:58.400182 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_stg_market_data_symbol.478198cf66, now test.stock_analytics.not_null_stg_market_forecast_date.ca0f3ba00f)
[0m23:56:58.400575 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.not_null_stg_market_forecast_date.ca0f3ba00f
[0m23:56:58.404934 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.not_null_stg_market_forecast_date.ca0f3ba00f"
[0m23:56:58.405796 [debug] [Thread-1 (]: Began executing node test.stock_analytics.not_null_stg_market_forecast_date.ca0f3ba00f
[0m23:56:58.408100 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.not_null_stg_market_forecast_date.ca0f3ba00f"
[0m23:56:58.408994 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_stg_market_forecast_date.ca0f3ba00f"
[0m23:56:58.409283 [debug] [Thread-1 (]: On test.stock_analytics.not_null_stg_market_forecast_date.ca0f3ba00f: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date
from USER_DB_OSTRICH.PUBLIC_STAGING.stg_market_forecast
where date is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stg_market_forecast_date.ca0f3ba00f"} */
[0m23:56:58.598945 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.189 seconds
[0m23:56:58.603204 [info ] [Thread-1 (]: 6 of 10 PASS not_null_stg_market_forecast_date ................................. [[32mPASS[0m in 0.20s]
[0m23:56:58.603809 [debug] [Thread-1 (]: Finished running node test.stock_analytics.not_null_stg_market_forecast_date.ca0f3ba00f
[0m23:56:58.604169 [debug] [Thread-1 (]: Began running node test.stock_analytics.not_null_stg_market_forecast_symbol.d304415e8d
[0m23:56:58.604581 [info ] [Thread-1 (]: 7 of 10 START test not_null_stg_market_forecast_symbol ......................... [RUN]
[0m23:56:58.605021 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_stg_market_forecast_date.ca0f3ba00f, now test.stock_analytics.not_null_stg_market_forecast_symbol.d304415e8d)
[0m23:56:58.605321 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.not_null_stg_market_forecast_symbol.d304415e8d
[0m23:56:58.608729 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.not_null_stg_market_forecast_symbol.d304415e8d"
[0m23:56:58.609376 [debug] [Thread-1 (]: Began executing node test.stock_analytics.not_null_stg_market_forecast_symbol.d304415e8d
[0m23:56:58.611096 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.not_null_stg_market_forecast_symbol.d304415e8d"
[0m23:56:58.612022 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_stg_market_forecast_symbol.d304415e8d"
[0m23:56:58.612268 [debug] [Thread-1 (]: On test.stock_analytics.not_null_stg_market_forecast_symbol.d304415e8d: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select symbol
from USER_DB_OSTRICH.PUBLIC_STAGING.stg_market_forecast
where symbol is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stg_market_forecast_symbol.d304415e8d"} */
[0m23:56:58.804027 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.191 seconds
[0m23:56:58.808236 [info ] [Thread-1 (]: 7 of 10 PASS not_null_stg_market_forecast_symbol ............................... [[32mPASS[0m in 0.20s]
[0m23:56:58.808781 [debug] [Thread-1 (]: Finished running node test.stock_analytics.not_null_stg_market_forecast_symbol.d304415e8d
[0m23:56:58.809122 [debug] [Thread-1 (]: Began running node test.stock_analytics.unique_mart_stock_analysis_symbol__date__record_type.1fad36923d
[0m23:56:58.809493 [info ] [Thread-1 (]: 8 of 10 START test unique_mart_stock_analysis_symbol__date__record_type ........ [RUN]
[0m23:56:58.809845 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_stg_market_forecast_symbol.d304415e8d, now test.stock_analytics.unique_mart_stock_analysis_symbol__date__record_type.1fad36923d)
[0m23:56:58.810117 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.unique_mart_stock_analysis_symbol__date__record_type.1fad36923d
[0m23:56:58.816774 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.unique_mart_stock_analysis_symbol__date__record_type.1fad36923d"
[0m23:56:58.818100 [debug] [Thread-1 (]: Began executing node test.stock_analytics.unique_mart_stock_analysis_symbol__date__record_type.1fad36923d
[0m23:56:58.819572 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.unique_mart_stock_analysis_symbol__date__record_type.1fad36923d"
[0m23:56:58.820291 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.unique_mart_stock_analysis_symbol__date__record_type.1fad36923d"
[0m23:56:58.820545 [debug] [Thread-1 (]: On test.stock_analytics.unique_mart_stock_analysis_symbol__date__record_type.1fad36923d: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    ['symbol', 'date', 'record_type'] as unique_field,
    count(*) as n_records

from USER_DB_OSTRICH.PUBLIC_ANALYTICS.mart_stock_analysis
where ['symbol', 'date', 'record_type'] is not null
group by ['symbol', 'date', 'record_type']
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.unique_mart_stock_analysis_symbol__date__record_type.1fad36923d"} */
[0m23:56:59.112509 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.291 seconds
[0m23:56:59.116985 [error] [Thread-1 (]: 8 of 10 FAIL 1 unique_mart_stock_analysis_symbol__date__record_type ............ [[31mFAIL 1[0m in 0.31s]
[0m23:56:59.117533 [debug] [Thread-1 (]: Finished running node test.stock_analytics.unique_mart_stock_analysis_symbol__date__record_type.1fad36923d
[0m23:56:59.117838 [debug] [Thread-1 (]: Began running node test.stock_analytics.unique_stg_market_data_symbol__date.3e1fafb254
[0m23:56:59.118195 [info ] [Thread-1 (]: 9 of 10 START test unique_stg_market_data_symbol__date ......................... [RUN]
[0m23:56:59.118622 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.unique_mart_stock_analysis_symbol__date__record_type.1fad36923d, now test.stock_analytics.unique_stg_market_data_symbol__date.3e1fafb254)
[0m23:56:59.118912 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.unique_stg_market_data_symbol__date.3e1fafb254
[0m23:56:59.122628 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.unique_stg_market_data_symbol__date.3e1fafb254"
[0m23:56:59.124307 [debug] [Thread-1 (]: Began executing node test.stock_analytics.unique_stg_market_data_symbol__date.3e1fafb254
[0m23:56:59.125913 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.unique_stg_market_data_symbol__date.3e1fafb254"
[0m23:56:59.126606 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.unique_stg_market_data_symbol__date.3e1fafb254"
[0m23:56:59.126821 [debug] [Thread-1 (]: On test.stock_analytics.unique_stg_market_data_symbol__date.3e1fafb254: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    ['symbol', 'date'] as unique_field,
    count(*) as n_records

from USER_DB_OSTRICH.PUBLIC_STAGING.stg_market_data
where ['symbol', 'date'] is not null
group by ['symbol', 'date']
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.unique_stg_market_data_symbol__date.3e1fafb254"} */
[0m23:56:59.317517 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.190 seconds
[0m23:56:59.321092 [error] [Thread-1 (]: 9 of 10 FAIL 1 unique_stg_market_data_symbol__date ............................. [[31mFAIL 1[0m in 0.20s]
[0m23:56:59.321837 [debug] [Thread-1 (]: Finished running node test.stock_analytics.unique_stg_market_data_symbol__date.3e1fafb254
[0m23:56:59.322284 [debug] [Thread-1 (]: Began running node test.stock_analytics.unique_stg_market_forecast_symbol__date.d55b034665
[0m23:56:59.322735 [info ] [Thread-1 (]: 10 of 10 START test unique_stg_market_forecast_symbol__date .................... [RUN]
[0m23:56:59.323273 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.unique_stg_market_data_symbol__date.3e1fafb254, now test.stock_analytics.unique_stg_market_forecast_symbol__date.d55b034665)
[0m23:56:59.323693 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.unique_stg_market_forecast_symbol__date.d55b034665
[0m23:56:59.329027 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.unique_stg_market_forecast_symbol__date.d55b034665"
[0m23:56:59.329740 [debug] [Thread-1 (]: Began executing node test.stock_analytics.unique_stg_market_forecast_symbol__date.d55b034665
[0m23:56:59.331884 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.unique_stg_market_forecast_symbol__date.d55b034665"
[0m23:56:59.332982 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.unique_stg_market_forecast_symbol__date.d55b034665"
[0m23:56:59.333286 [debug] [Thread-1 (]: On test.stock_analytics.unique_stg_market_forecast_symbol__date.d55b034665: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    ['symbol', 'date'] as unique_field,
    count(*) as n_records

from USER_DB_OSTRICH.PUBLIC_STAGING.stg_market_forecast
where ['symbol', 'date'] is not null
group by ['symbol', 'date']
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.unique_stg_market_forecast_symbol__date.d55b034665"} */
[0m23:56:59.519600 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.186 seconds
[0m23:56:59.523769 [error] [Thread-1 (]: 10 of 10 FAIL 1 unique_stg_market_forecast_symbol__date ........................ [[31mFAIL 1[0m in 0.20s]
[0m23:56:59.524452 [debug] [Thread-1 (]: Finished running node test.stock_analytics.unique_stg_market_forecast_symbol__date.d55b034665
[0m23:56:59.526062 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:56:59.526467 [debug] [MainThread]: Connection 'test.stock_analytics.unique_stg_market_forecast_symbol__date.d55b034665' was left open.
[0m23:56:59.526757 [debug] [MainThread]: On test.stock_analytics.unique_stg_market_forecast_symbol__date.d55b034665: Close
[0m23:56:59.631014 [info ] [MainThread]: 
[0m23:56:59.631394 [info ] [MainThread]: Finished running 10 data tests in 0 hours 0 minutes and 5.65 seconds (5.65s).
[0m23:56:59.633075 [debug] [MainThread]: Command end result
[0m23:56:59.650085 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/target/manifest.json
[0m23:56:59.651126 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/target/semantic_manifest.json
[0m23:56:59.655525 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/target/run_results.json
[0m23:56:59.655687 [info ] [MainThread]: 
[0m23:56:59.655854 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m23:56:59.655987 [info ] [MainThread]: 
[0m23:56:59.656167 [error] [MainThread]: [31mFailure in test unique_mart_stock_analysis_symbol__date__record_type (models/marts/mart_stock_analysis.yml)[0m
[0m23:56:59.656329 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m23:56:59.656439 [info ] [MainThread]: 
[0m23:56:59.656594 [info ] [MainThread]:   compiled code at target/compiled/stock_analytics/models/marts/mart_stock_analysis.yml/unique_mart_stock_analysis_symbol__date__record_type.sql
[0m23:56:59.656716 [info ] [MainThread]: 
[0m23:56:59.656863 [error] [MainThread]: [31mFailure in test unique_stg_market_data_symbol__date (models/staging/stg_market_data.yml)[0m
[0m23:56:59.657009 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m23:56:59.657115 [info ] [MainThread]: 
[0m23:56:59.657255 [info ] [MainThread]:   compiled code at target/compiled/stock_analytics/models/staging/stg_market_data.yml/unique_stg_market_data_symbol__date.sql
[0m23:56:59.657369 [info ] [MainThread]: 
[0m23:56:59.657509 [error] [MainThread]: [31mFailure in test unique_stg_market_forecast_symbol__date (models/staging/stg_market_forecast.yml)[0m
[0m23:56:59.657652 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m23:56:59.657760 [info ] [MainThread]: 
[0m23:56:59.657897 [info ] [MainThread]:   compiled code at target/compiled/stock_analytics/models/staging/stg_market_forecast.yml/unique_stg_market_forecast_symbol__date.sql
[0m23:56:59.658015 [info ] [MainThread]: 
[0m23:56:59.658161 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=3 SKIP=0 NO-OP=0 TOTAL=10
[0m23:56:59.662865 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 6.5923567, "process_in_blocks": "0", "process_kernel_time": 0.324316, "process_mem_max_rss": "248250368", "process_out_blocks": "0", "process_user_time": 1.50174}
[0m23:56:59.663067 [debug] [MainThread]: Command `dbt test` failed at 23:56:59.663024 after 6.59 seconds
[0m23:56:59.663251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124425d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127435650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127435700>]}
[0m23:56:59.663412 [debug] [MainThread]: Flushing usage events
[0m23:56:59.986187 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:57:24.151369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104493e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f07b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f07d90>]}


============================== 23:57:24.153656 | 17a45c74-1630-4933-9449-0fcaba7b1f13 ==============================
[0m23:57:24.153656 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m23:57:24.153904 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/Users/rahulmohandevi/.dbt', 'log_format': 'default', 'printer_width': '80', 'debug': 'False', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'log_path': '/Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/logs', 'empty': 'None', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'warn_error': 'None', 'static_parser': 'True'}
[0m23:57:24.208440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '17a45c74-1630-4933-9449-0fcaba7b1f13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a3c510>]}
[0m23:57:24.221018 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.0963645, "process_in_blocks": "0", "process_kernel_time": 0.113067, "process_mem_max_rss": "121700352", "process_out_blocks": "0", "process_user_time": 0.573731}
[0m23:57:24.221171 [debug] [MainThread]: Command `dbt clean` succeeded at 23:57:24.221135 after 0.10 seconds
[0m23:57:24.221299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069e4380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069e47c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069d9d50>]}
[0m23:57:24.221411 [debug] [MainThread]: Flushing usage events
[0m23:57:24.558932 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:57:39.217380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040ebe00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10566bb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10566bd90>]}


============================== 23:57:39.219603 | 5cde1c92-f438-4a79-ae92-6586d191252a ==============================
[0m23:57:39.219603 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m23:57:39.219845 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run -s mart_stock_analysis --full-refresh', 'target_path': 'None', 'cache_selected_only': 'False', 'log_path': '/Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/logs', 'introspect': 'True', 'write_json': 'True', 'quiet': 'False', 'static_parser': 'True', 'warn_error': 'None', 'empty': 'False', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/Users/rahulmohandevi/.dbt', 'log_format': 'default', 'use_colors': 'True', 'printer_width': '80', 'version_check': 'True', 'indirect_selection': 'eager', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'debug': 'False'}
[0m23:57:39.918530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5cde1c92-f438-4a79-ae92-6586d191252a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104494510>]}
[0m23:57:39.941152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5cde1c92-f438-4a79-ae92-6586d191252a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ea0c270>]}
[0m23:57:39.941746 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m23:57:39.989560 [debug] [MainThread]: checksum: e63134dccc1251cfb572caf0e4aa952f030c125ee3634f3bf2c0a2e1bb6ae349, vars: {}, profile: , target: , version: 1.11.0b3
[0m23:57:39.989934 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m23:57:39.990077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5cde1c92-f438-4a79-ae92-6586d191252a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e903a50>]}
[0m23:57:40.414057 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'mart_stock_analysis' in package 'stock_analytics'
(models/marts/mart_stock_analysis.yml). Arguments to generic tests should be
nested under the `arguments` property.
[0m23:57:40.414324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5cde1c92-f438-4a79-ae92-6586d191252a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f0f6c60>]}
[0m23:57:40.498642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5cde1c92-f438-4a79-ae92-6586d191252a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f6220b0>]}
[0m23:57:40.534316 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/target/manifest.json
[0m23:57:40.535387 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/target/semantic_manifest.json
[0m23:57:40.544769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5cde1c92-f438-4a79-ae92-6586d191252a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f4ab110>]}
[0m23:57:40.544941 [info ] [MainThread]: Found 3 models, 11 data tests, 2 sources, 492 macros
[0m23:57:40.545057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5cde1c92-f438-4a79-ae92-6586d191252a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f2dff50>]}
[0m23:57:40.545693 [info ] [MainThread]: 
[0m23:57:40.545818 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:57:40.545909 [info ] [MainThread]: 
[0m23:57:40.546089 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:57:40.546408 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_OSTRICH'
[0m23:57:40.606300 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_OSTRICH"
[0m23:57:40.606473 [debug] [ThreadPool]: On list_USER_DB_OSTRICH: show terse schemas in database USER_DB_OSTRICH
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_OSTRICH"} */
[0m23:57:40.606572 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:57:43.205097 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 2.598 seconds
[0m23:57:43.213554 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_OSTRICH, now list_USER_DB_OSTRICH_PUBLIC_ANALYTICS)
[0m23:57:43.222936 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_OSTRICH_PUBLIC_ANALYTICS"
[0m23:57:43.223185 [debug] [ThreadPool]: On list_USER_DB_OSTRICH_PUBLIC_ANALYTICS: show objects in USER_DB_OSTRICH.PUBLIC_ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_OSTRICH_PUBLIC_ANALYTICS"} */;
[0m23:57:43.317492 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.094 seconds
[0m23:57:43.320462 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_OSTRICH_PUBLIC_ANALYTICS, now list_USER_DB_OSTRICH_PUBLIC_STAGING)
[0m23:57:43.323525 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_OSTRICH_PUBLIC_STAGING"
[0m23:57:43.323952 [debug] [ThreadPool]: On list_USER_DB_OSTRICH_PUBLIC_STAGING: show objects in USER_DB_OSTRICH.PUBLIC_STAGING
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_OSTRICH_PUBLIC_STAGING"} */;
[0m23:57:43.434921 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.110 seconds
[0m23:57:43.439342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5cde1c92-f438-4a79-ae92-6586d191252a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119eb92e0>]}
[0m23:57:43.443475 [debug] [Thread-1 (]: Began running node model.stock_analytics.mart_stock_analysis
[0m23:57:43.444051 [info ] [Thread-1 (]: 1 of 1 START sql table model PUBLIC_ANALYTICS.mart_stock_analysis .............. [RUN]
[0m23:57:43.444491 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_OSTRICH_PUBLIC_STAGING, now model.stock_analytics.mart_stock_analysis)
[0m23:57:43.444830 [debug] [Thread-1 (]: Began compiling node model.stock_analytics.mart_stock_analysis
[0m23:57:43.452455 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_analytics.mart_stock_analysis"
[0m23:57:43.453394 [debug] [Thread-1 (]: Began executing node model.stock_analytics.mart_stock_analysis
[0m23:57:43.472327 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_analytics.mart_stock_analysis"
[0m23:57:43.473356 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.mart_stock_analysis"
[0m23:57:43.473570 [debug] [Thread-1 (]: On model.stock_analytics.mart_stock_analysis: create or replace transient table USER_DB_OSTRICH.PUBLIC_ANALYTICS.mart_stock_analysis
    
    
    
    as (

-- Historical slice (from staging)
with hist as (
  select
    symbol,
    date,
    close                as actual_price,
    cast(null as float)  as forecast_price,
    cast(null as float)  as lower_bound,
    cast(null as float)  as upper_bound,
    'historical'         as record_type
  from USER_DB_OSTRICH.PUBLIC_STAGING.stg_market_data
),

-- Forecast slice (from staging)
fut as (
  select
    symbol,
    date,
    cast(null as float)  as actual_price,
    forecast             as forecast_price,
    lower_bound,
    upper_bound,
    'forecast'           as record_type
  from USER_DB_OSTRICH.PUBLIC_STAGING.stg_market_forecast
)

-- Union both
, unioned as (
  select * from hist
  union all
  select * from fut
)

-- In case of any accidental dupes (shouldn't happen, but safe)
select distinct *
from (
  select
    *,
    row_number() over (partition by symbol, date, record_type order by date desc) as rn
  from unioned
)
where rn = 1
    )

/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.mart_stock_analysis"} */;
[0m23:57:44.373821 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.900 seconds
[0m23:57:44.396112 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5cde1c92-f438-4a79-ae92-6586d191252a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044094f0>]}
[0m23:57:44.396647 [info ] [Thread-1 (]: 1 of 1 OK created sql table model PUBLIC_ANALYTICS.mart_stock_analysis ......... [[32mSUCCESS 1[0m in 0.95s]
[0m23:57:44.396995 [debug] [Thread-1 (]: Finished running node model.stock_analytics.mart_stock_analysis
[0m23:57:44.397950 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:57:44.398179 [debug] [MainThread]: Connection 'model.stock_analytics.mart_stock_analysis' was left open.
[0m23:57:44.398353 [debug] [MainThread]: On model.stock_analytics.mart_stock_analysis: Close
[0m23:57:44.528092 [info ] [MainThread]: 
[0m23:57:44.528797 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.98 seconds (3.98s).
[0m23:57:44.529783 [debug] [MainThread]: Command end result
[0m23:57:44.554477 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/target/manifest.json
[0m23:57:44.555856 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/target/semantic_manifest.json
[0m23:57:44.559653 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/target/run_results.json
[0m23:57:44.559837 [info ] [MainThread]: 
[0m23:57:44.560073 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:57:44.560233 [info ] [MainThread]: 
[0m23:57:44.560421 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m23:57:44.560774 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m23:57:44.566364 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.3750057, "process_in_blocks": "0", "process_kernel_time": 0.280575, "process_mem_max_rss": "249937920", "process_out_blocks": "0", "process_user_time": 1.703097}
[0m23:57:44.566647 [debug] [MainThread]: Command `dbt run` succeeded at 23:57:44.566591 after 5.38 seconds
[0m23:57:44.566846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f68dd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10441ded0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10569b070>]}
[0m23:57:44.567025 [debug] [MainThread]: Flushing usage events
[0m23:57:44.874957 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:58:04.160621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103a97e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105017b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105017d90>]}


============================== 23:58:04.163088 | 199def53-dda7-4010-8fd2-e23c860d5fb3 ==============================
[0m23:58:04.163088 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m23:58:04.163347 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'use_colors': 'True', 'use_experimental_parser': 'False', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'invocation_command': 'dbt test --select test_type:generic', 'warn_error': 'None', 'no_print': 'None', 'log_cache_events': 'False', 'log_format': 'default', 'fail_fast': 'False', 'debug': 'False', 'profiles_dir': '/Users/rahulmohandevi/.dbt', 'quiet': 'False', 'log_path': '/Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/logs', 'write_json': 'True', 'empty': 'None', 'target_path': 'None', 'cache_selected_only': 'False', 'version_check': 'True', 'partial_parse': 'True'}
[0m23:58:04.864890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '199def53-dda7-4010-8fd2-e23c860d5fb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e40510>]}
[0m23:58:04.887721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '199def53-dda7-4010-8fd2-e23c860d5fb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb68270>]}
[0m23:58:04.888327 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m23:58:04.937224 [debug] [MainThread]: checksum: e63134dccc1251cfb572caf0e4aa952f030c125ee3634f3bf2c0a2e1bb6ae349, vars: {}, profile: , target: , version: 1.11.0b3
[0m23:58:05.006739 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:58:05.006929 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:58:05.025256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '199def53-dda7-4010-8fd2-e23c860d5fb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cf52c50>]}
[0m23:58:05.061863 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/target/manifest.json
[0m23:58:05.063574 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/target/semantic_manifest.json
[0m23:58:05.078529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '199def53-dda7-4010-8fd2-e23c860d5fb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d1f24e0>]}
[0m23:58:05.078733 [info ] [MainThread]: Found 3 models, 11 data tests, 2 sources, 492 macros
[0m23:58:05.078855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '199def53-dda7-4010-8fd2-e23c860d5fb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d2697f0>]}
[0m23:58:05.079555 [info ] [MainThread]: 
[0m23:58:05.079677 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:58:05.079765 [info ] [MainThread]: 
[0m23:58:05.079941 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:58:05.081544 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_OSTRICH_PUBLIC_STAGING'
[0m23:58:05.108869 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_OSTRICH_PUBLIC_STAGING"
[0m23:58:05.109011 [debug] [ThreadPool]: On list_USER_DB_OSTRICH_PUBLIC_STAGING: show objects in USER_DB_OSTRICH.PUBLIC_STAGING
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_OSTRICH_PUBLIC_STAGING"} */;
[0m23:58:05.109103 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:58:07.735706 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 2.626 seconds
[0m23:58:07.739578 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_OSTRICH_PUBLIC_STAGING, now list_USER_DB_OSTRICH_PUBLIC_ANALYTICS)
[0m23:58:07.744367 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_OSTRICH_PUBLIC_ANALYTICS"
[0m23:58:07.744772 [debug] [ThreadPool]: On list_USER_DB_OSTRICH_PUBLIC_ANALYTICS: show objects in USER_DB_OSTRICH.PUBLIC_ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_OSTRICH_PUBLIC_ANALYTICS"} */;
[0m23:58:07.895587 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.150 seconds
[0m23:58:07.898886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '199def53-dda7-4010-8fd2-e23c860d5fb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d2ebad0>]}
[0m23:58:07.902782 [debug] [Thread-1 (]: Began running node test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316
[0m23:58:07.903277 [info ] [Thread-1 (]: 1 of 10 START test accepted_values_mart_stock_analysis_record_type__historical__forecast  [RUN]
[0m23:58:07.903750 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_OSTRICH_PUBLIC_ANALYTICS, now test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316)
[0m23:58:07.904118 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316
[0m23:58:07.919701 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316"
[0m23:58:07.920579 [debug] [Thread-1 (]: Began executing node test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316
[0m23:58:07.936393 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316"
[0m23:58:07.937192 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316"
[0m23:58:07.937415 [debug] [Thread-1 (]: On test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        record_type as value_field,
        count(*) as n_records

    from USER_DB_OSTRICH.PUBLIC_ANALYTICS.mart_stock_analysis
    group by record_type

)

select *
from all_values
where value_field not in (
    'historical','forecast'
)



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316"} */
[0m23:58:08.232947 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.295 seconds
[0m23:58:08.244950 [info ] [Thread-1 (]: 1 of 10 PASS accepted_values_mart_stock_analysis_record_type__historical__forecast  [[32mPASS[0m in 0.34s]
[0m23:58:08.245665 [debug] [Thread-1 (]: Finished running node test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316
[0m23:58:08.246054 [debug] [Thread-1 (]: Began running node test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5
[0m23:58:08.246516 [info ] [Thread-1 (]: 2 of 10 START test not_null_mart_stock_analysis_date ........................... [RUN]
[0m23:58:08.247023 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316, now test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5)
[0m23:58:08.247337 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5
[0m23:58:08.261879 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5"
[0m23:58:08.262644 [debug] [Thread-1 (]: Began executing node test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5
[0m23:58:08.264120 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5"
[0m23:58:08.264757 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5"
[0m23:58:08.264959 [debug] [Thread-1 (]: On test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date
from USER_DB_OSTRICH.PUBLIC_ANALYTICS.mart_stock_analysis
where date is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5"} */
[0m23:58:08.539325 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.274 seconds
[0m23:58:08.543668 [info ] [Thread-1 (]: 2 of 10 PASS not_null_mart_stock_analysis_date ................................. [[32mPASS[0m in 0.30s]
[0m23:58:08.544265 [debug] [Thread-1 (]: Finished running node test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5
[0m23:58:08.544621 [debug] [Thread-1 (]: Began running node test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e
[0m23:58:08.545037 [info ] [Thread-1 (]: 3 of 10 START test not_null_mart_stock_analysis_symbol ......................... [RUN]
[0m23:58:08.545403 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5, now test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e)
[0m23:58:08.545684 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e
[0m23:58:08.548865 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e"
[0m23:58:08.549480 [debug] [Thread-1 (]: Began executing node test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e
[0m23:58:08.551745 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e"
[0m23:58:08.552431 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e"
[0m23:58:08.552679 [debug] [Thread-1 (]: On test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select symbol
from USER_DB_OSTRICH.PUBLIC_ANALYTICS.mart_stock_analysis
where symbol is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e"} */
[0m23:58:08.744366 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.191 seconds
[0m23:58:08.749005 [info ] [Thread-1 (]: 3 of 10 PASS not_null_mart_stock_analysis_symbol ............................... [[32mPASS[0m in 0.20s]
[0m23:58:08.750325 [debug] [Thread-1 (]: Finished running node test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e
[0m23:58:08.751165 [debug] [Thread-1 (]: Began running node test.stock_analytics.not_null_stg_market_data_date.fb73c94489
[0m23:58:08.751810 [info ] [Thread-1 (]: 4 of 10 START test not_null_stg_market_data_date ............................... [RUN]
[0m23:58:08.752335 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e, now test.stock_analytics.not_null_stg_market_data_date.fb73c94489)
[0m23:58:08.752740 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.not_null_stg_market_data_date.fb73c94489
[0m23:58:08.757550 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.not_null_stg_market_data_date.fb73c94489"
[0m23:58:08.759166 [debug] [Thread-1 (]: Began executing node test.stock_analytics.not_null_stg_market_data_date.fb73c94489
[0m23:58:08.762240 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.not_null_stg_market_data_date.fb73c94489"
[0m23:58:08.763979 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_stg_market_data_date.fb73c94489"
[0m23:58:08.764347 [debug] [Thread-1 (]: On test.stock_analytics.not_null_stg_market_data_date.fb73c94489: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date
from USER_DB_OSTRICH.PUBLIC_STAGING.stg_market_data
where date is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stg_market_data_date.fb73c94489"} */
[0m23:58:08.866080 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.101 seconds
[0m23:58:08.869799 [info ] [Thread-1 (]: 4 of 10 PASS not_null_stg_market_data_date ..................................... [[32mPASS[0m in 0.12s]
[0m23:58:08.870497 [debug] [Thread-1 (]: Finished running node test.stock_analytics.not_null_stg_market_data_date.fb73c94489
[0m23:58:08.870951 [debug] [Thread-1 (]: Began running node test.stock_analytics.not_null_stg_market_data_symbol.478198cf66
[0m23:58:08.871392 [info ] [Thread-1 (]: 5 of 10 START test not_null_stg_market_data_symbol ............................. [RUN]
[0m23:58:08.871856 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_stg_market_data_date.fb73c94489, now test.stock_analytics.not_null_stg_market_data_symbol.478198cf66)
[0m23:58:08.872218 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.not_null_stg_market_data_symbol.478198cf66
[0m23:58:08.876765 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.not_null_stg_market_data_symbol.478198cf66"
[0m23:58:08.877516 [debug] [Thread-1 (]: Began executing node test.stock_analytics.not_null_stg_market_data_symbol.478198cf66
[0m23:58:08.880322 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.not_null_stg_market_data_symbol.478198cf66"
[0m23:58:08.881125 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_stg_market_data_symbol.478198cf66"
[0m23:58:08.881411 [debug] [Thread-1 (]: On test.stock_analytics.not_null_stg_market_data_symbol.478198cf66: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select symbol
from USER_DB_OSTRICH.PUBLIC_STAGING.stg_market_data
where symbol is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stg_market_data_symbol.478198cf66"} */
[0m23:58:08.985574 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.104 seconds
[0m23:58:08.989363 [info ] [Thread-1 (]: 5 of 10 PASS not_null_stg_market_data_symbol ................................... [[32mPASS[0m in 0.12s]
[0m23:58:08.990064 [debug] [Thread-1 (]: Finished running node test.stock_analytics.not_null_stg_market_data_symbol.478198cf66
[0m23:58:08.990509 [debug] [Thread-1 (]: Began running node test.stock_analytics.not_null_stg_market_forecast_date.ca0f3ba00f
[0m23:58:08.990945 [info ] [Thread-1 (]: 6 of 10 START test not_null_stg_market_forecast_date ........................... [RUN]
[0m23:58:08.991501 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_stg_market_data_symbol.478198cf66, now test.stock_analytics.not_null_stg_market_forecast_date.ca0f3ba00f)
[0m23:58:08.991852 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.not_null_stg_market_forecast_date.ca0f3ba00f
[0m23:58:08.996179 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.not_null_stg_market_forecast_date.ca0f3ba00f"
[0m23:58:08.997796 [debug] [Thread-1 (]: Began executing node test.stock_analytics.not_null_stg_market_forecast_date.ca0f3ba00f
[0m23:58:08.999613 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.not_null_stg_market_forecast_date.ca0f3ba00f"
[0m23:58:09.000471 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_stg_market_forecast_date.ca0f3ba00f"
[0m23:58:09.000760 [debug] [Thread-1 (]: On test.stock_analytics.not_null_stg_market_forecast_date.ca0f3ba00f: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date
from USER_DB_OSTRICH.PUBLIC_STAGING.stg_market_forecast
where date is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stg_market_forecast_date.ca0f3ba00f"} */
[0m23:58:09.126916 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.126 seconds
[0m23:58:09.131619 [info ] [Thread-1 (]: 6 of 10 PASS not_null_stg_market_forecast_date ................................. [[32mPASS[0m in 0.14s]
[0m23:58:09.132534 [debug] [Thread-1 (]: Finished running node test.stock_analytics.not_null_stg_market_forecast_date.ca0f3ba00f
[0m23:58:09.132816 [debug] [Thread-1 (]: Began running node test.stock_analytics.not_null_stg_market_forecast_symbol.d304415e8d
[0m23:58:09.133106 [info ] [Thread-1 (]: 7 of 10 START test not_null_stg_market_forecast_symbol ......................... [RUN]
[0m23:58:09.133445 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_stg_market_forecast_date.ca0f3ba00f, now test.stock_analytics.not_null_stg_market_forecast_symbol.d304415e8d)
[0m23:58:09.133679 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.not_null_stg_market_forecast_symbol.d304415e8d
[0m23:58:09.136329 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.not_null_stg_market_forecast_symbol.d304415e8d"
[0m23:58:09.136894 [debug] [Thread-1 (]: Began executing node test.stock_analytics.not_null_stg_market_forecast_symbol.d304415e8d
[0m23:58:09.138247 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.not_null_stg_market_forecast_symbol.d304415e8d"
[0m23:58:09.138853 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_stg_market_forecast_symbol.d304415e8d"
[0m23:58:09.139066 [debug] [Thread-1 (]: On test.stock_analytics.not_null_stg_market_forecast_symbol.d304415e8d: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select symbol
from USER_DB_OSTRICH.PUBLIC_STAGING.stg_market_forecast
where symbol is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stg_market_forecast_symbol.d304415e8d"} */
[0m23:58:09.464658 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.325 seconds
[0m23:58:09.467689 [info ] [Thread-1 (]: 7 of 10 PASS not_null_stg_market_forecast_symbol ............................... [[32mPASS[0m in 0.33s]
[0m23:58:09.468456 [debug] [Thread-1 (]: Finished running node test.stock_analytics.not_null_stg_market_forecast_symbol.d304415e8d
[0m23:58:09.468933 [debug] [Thread-1 (]: Began running node test.stock_analytics.unique_mart_stock_analysis_symbol__date__record_type.1fad36923d
[0m23:58:09.469373 [info ] [Thread-1 (]: 8 of 10 START test unique_mart_stock_analysis_symbol__date__record_type ........ [RUN]
[0m23:58:09.469855 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_stg_market_forecast_symbol.d304415e8d, now test.stock_analytics.unique_mart_stock_analysis_symbol__date__record_type.1fad36923d)
[0m23:58:09.470233 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.unique_mart_stock_analysis_symbol__date__record_type.1fad36923d
[0m23:58:09.479425 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.unique_mart_stock_analysis_symbol__date__record_type.1fad36923d"
[0m23:58:09.480167 [debug] [Thread-1 (]: Began executing node test.stock_analytics.unique_mart_stock_analysis_symbol__date__record_type.1fad36923d
[0m23:58:09.482034 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.unique_mart_stock_analysis_symbol__date__record_type.1fad36923d"
[0m23:58:09.482953 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.unique_mart_stock_analysis_symbol__date__record_type.1fad36923d"
[0m23:58:09.483237 [debug] [Thread-1 (]: On test.stock_analytics.unique_mart_stock_analysis_symbol__date__record_type.1fad36923d: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    ['symbol', 'date', 'record_type'] as unique_field,
    count(*) as n_records

from USER_DB_OSTRICH.PUBLIC_ANALYTICS.mart_stock_analysis
where ['symbol', 'date', 'record_type'] is not null
group by ['symbol', 'date', 'record_type']
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.unique_mart_stock_analysis_symbol__date__record_type.1fad36923d"} */
[0m23:58:09.600502 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.117 seconds
[0m23:58:09.603770 [error] [Thread-1 (]: 8 of 10 FAIL 1 unique_mart_stock_analysis_symbol__date__record_type ............ [[31mFAIL 1[0m in 0.13s]
[0m23:58:09.604471 [debug] [Thread-1 (]: Finished running node test.stock_analytics.unique_mart_stock_analysis_symbol__date__record_type.1fad36923d
[0m23:58:09.604883 [debug] [Thread-1 (]: Began running node test.stock_analytics.unique_stg_market_data_symbol__date.3e1fafb254
[0m23:58:09.605288 [info ] [Thread-1 (]: 9 of 10 START test unique_stg_market_data_symbol__date ......................... [RUN]
[0m23:58:09.605771 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.unique_mart_stock_analysis_symbol__date__record_type.1fad36923d, now test.stock_analytics.unique_stg_market_data_symbol__date.3e1fafb254)
[0m23:58:09.606125 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.unique_stg_market_data_symbol__date.3e1fafb254
[0m23:58:09.610888 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.unique_stg_market_data_symbol__date.3e1fafb254"
[0m23:58:09.611854 [debug] [Thread-1 (]: Began executing node test.stock_analytics.unique_stg_market_data_symbol__date.3e1fafb254
[0m23:58:09.613962 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.unique_stg_market_data_symbol__date.3e1fafb254"
[0m23:58:09.614813 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.unique_stg_market_data_symbol__date.3e1fafb254"
[0m23:58:09.615104 [debug] [Thread-1 (]: On test.stock_analytics.unique_stg_market_data_symbol__date.3e1fafb254: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    ['symbol', 'date'] as unique_field,
    count(*) as n_records

from USER_DB_OSTRICH.PUBLIC_STAGING.stg_market_data
where ['symbol', 'date'] is not null
group by ['symbol', 'date']
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.unique_stg_market_data_symbol__date.3e1fafb254"} */
[0m23:58:09.734355 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.119 seconds
[0m23:58:09.738576 [error] [Thread-1 (]: 9 of 10 FAIL 1 unique_stg_market_data_symbol__date ............................. [[31mFAIL 1[0m in 0.13s]
[0m23:58:09.739120 [debug] [Thread-1 (]: Finished running node test.stock_analytics.unique_stg_market_data_symbol__date.3e1fafb254
[0m23:58:09.739459 [debug] [Thread-1 (]: Began running node test.stock_analytics.unique_stg_market_forecast_symbol__date.d55b034665
[0m23:58:09.739832 [info ] [Thread-1 (]: 10 of 10 START test unique_stg_market_forecast_symbol__date .................... [RUN]
[0m23:58:09.740215 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.unique_stg_market_data_symbol__date.3e1fafb254, now test.stock_analytics.unique_stg_market_forecast_symbol__date.d55b034665)
[0m23:58:09.740486 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.unique_stg_market_forecast_symbol__date.d55b034665
[0m23:58:09.743972 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.unique_stg_market_forecast_symbol__date.d55b034665"
[0m23:58:09.744535 [debug] [Thread-1 (]: Began executing node test.stock_analytics.unique_stg_market_forecast_symbol__date.d55b034665
[0m23:58:09.746217 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.unique_stg_market_forecast_symbol__date.d55b034665"
[0m23:58:09.746932 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.unique_stg_market_forecast_symbol__date.d55b034665"
[0m23:58:09.747175 [debug] [Thread-1 (]: On test.stock_analytics.unique_stg_market_forecast_symbol__date.d55b034665: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    ['symbol', 'date'] as unique_field,
    count(*) as n_records

from USER_DB_OSTRICH.PUBLIC_STAGING.stg_market_forecast
where ['symbol', 'date'] is not null
group by ['symbol', 'date']
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.unique_stg_market_forecast_symbol__date.d55b034665"} */
[0m23:58:09.907623 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.160 seconds
[0m23:58:09.911159 [error] [Thread-1 (]: 10 of 10 FAIL 1 unique_stg_market_forecast_symbol__date ........................ [[31mFAIL 1[0m in 0.17s]
[0m23:58:09.911931 [debug] [Thread-1 (]: Finished running node test.stock_analytics.unique_stg_market_forecast_symbol__date.d55b034665
[0m23:58:09.913836 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:58:09.914232 [debug] [MainThread]: Connection 'test.stock_analytics.unique_stg_market_forecast_symbol__date.d55b034665' was left open.
[0m23:58:09.914582 [debug] [MainThread]: On test.stock_analytics.unique_stg_market_forecast_symbol__date.d55b034665: Close
[0m23:58:10.035831 [info ] [MainThread]: 
[0m23:58:10.036885 [info ] [MainThread]: Finished running 10 data tests in 0 hours 0 minutes and 4.96 seconds (4.96s).
[0m23:58:10.040234 [debug] [MainThread]: Command end result
[0m23:58:10.059010 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/target/manifest.json
[0m23:58:10.060294 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/target/semantic_manifest.json
[0m23:58:10.064689 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/target/run_results.json
[0m23:58:10.064857 [info ] [MainThread]: 
[0m23:58:10.065046 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m23:58:10.065197 [info ] [MainThread]: 
[0m23:58:10.065385 [error] [MainThread]: [31mFailure in test unique_mart_stock_analysis_symbol__date__record_type (models/marts/mart_stock_analysis.yml)[0m
[0m23:58:10.065565 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m23:58:10.065686 [info ] [MainThread]: 
[0m23:58:10.065853 [info ] [MainThread]:   compiled code at target/compiled/stock_analytics/models/marts/mart_stock_analysis.yml/unique_mart_stock_analysis_symbol__date__record_type.sql
[0m23:58:10.065985 [info ] [MainThread]: 
[0m23:58:10.066146 [error] [MainThread]: [31mFailure in test unique_stg_market_data_symbol__date (models/staging/stg_market_data.yml)[0m
[0m23:58:10.066306 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m23:58:10.066421 [info ] [MainThread]: 
[0m23:58:10.066577 [info ] [MainThread]:   compiled code at target/compiled/stock_analytics/models/staging/stg_market_data.yml/unique_stg_market_data_symbol__date.sql
[0m23:58:10.066700 [info ] [MainThread]: 
[0m23:58:10.066857 [error] [MainThread]: [31mFailure in test unique_stg_market_forecast_symbol__date (models/staging/stg_market_forecast.yml)[0m
[0m23:58:10.067015 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m23:58:10.067129 [info ] [MainThread]: 
[0m23:58:10.067270 [info ] [MainThread]:   compiled code at target/compiled/stock_analytics/models/staging/stg_market_forecast.yml/unique_stg_market_forecast_symbol__date.sql
[0m23:58:10.067390 [info ] [MainThread]: 
[0m23:58:10.067529 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=3 SKIP=0 NO-OP=0 TOTAL=10
[0m23:58:10.072387 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 5.9391303, "process_in_blocks": "0", "process_kernel_time": 0.318402, "process_mem_max_rss": "246317056", "process_out_blocks": "0", "process_user_time": 1.462821}
[0m23:58:10.072629 [debug] [MainThread]: Command `dbt test` failed at 23:58:10.072577 after 5.94 seconds
[0m23:58:10.072851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049465d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e0e5650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e0e5700>]}
[0m23:58:10.073031 [debug] [MainThread]: Flushing usage events
[0m23:58:10.393825 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:06:58.017925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10635be00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078e7b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078e7d90>]}


============================== 00:06:58.020469 | 61fd4e12-a594-4450-9e68-b28ea0182a21 ==============================
[0m00:06:58.020469 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m00:06:58.020742 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'printer_width': '80', 'partial_parse': 'True', 'target_path': 'None', 'static_parser': 'True', 'no_print': 'None', 'profiles_dir': '/Users/rahulmohandevi/.dbt', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'log_format': 'default', 'empty': 'None', 'indirect_selection': 'eager', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt test --select test_type:generic', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/logs', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True'}
[0m00:06:58.797286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '61fd4e12-a594-4450-9e68-b28ea0182a21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106710510>]}
[0m00:06:58.819576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '61fd4e12-a594-4450-9e68-b28ea0182a21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f428270>]}
[0m00:06:58.820066 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m00:06:58.868623 [debug] [MainThread]: checksum: e63134dccc1251cfb572caf0e4aa952f030c125ee3634f3bf2c0a2e1bb6ae349, vars: {}, profile: , target: , version: 1.11.0b3
[0m00:06:58.941235 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:06:58.941620 [info ] [MainThread]: Unable to do partial parsing because an error occurred. Switching to full reparse.
[0m00:06:58.943285 [debug] [MainThread]: Partial parsing exception processing file stock_analytics://models/marts/mart_stock_analysis.yml
[0m00:06:58.943465 [debug] [MainThread]: PP exception info: {'parse_file_type': 'schema', 'exception': "AttributeError: 'SingularTestNode' object has no attribute 'attached_node'", 'location': 'line 920 in remove_tests', 'traceback': 'Traceback (most recent call last):\n  File "/opt/anaconda3/lib/python3.13/site-packages/dbt/parser/manifest.py", line 548, in safe_update_project_parser_files_partially\n    project_parser_files = self.partial_parser.get_parsing_files()\n  File "/opt/anaconda3/lib/python3.13/site-packages/dbt/parser/partial.py", line 188, in get_parsing_files\n    self.change_schema_file(file_id)\n    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^\n  File "/opt/anaconda3/lib/python3.13/site-packages/dbt/parser/partial.py", line 642, in change_schema_file\n    self.handle_schema_file_changes(saved_schema_file, saved_yaml_dict, new_yaml_dict)\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/anaconda3/lib/python3.13/site-packages/dbt/parser/partial.py", line 679, in handle_schema_file_changes\n    self.delete_schema_mssa_links(schema_file, dict_key, elem)\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/anaconda3/lib/python3.13/site-packages/dbt/parser/partial.py", line 852, in delete_schema_mssa_links\n    self._delete_schema_mssa_links(schema_file, dict_key, elem, elem_unique_ids)\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/anaconda3/lib/python3.13/site-packages/dbt/parser/partial.py", line 905, in _delete_schema_mssa_links\n    self.remove_tests(schema_file, dict_key, elem["name"])\n    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/anaconda3/lib/python3.13/site-packages/dbt/parser/partial.py", line 920, in remove_tests\n    if child_test.attached_node:\n       ^^^^^^^^^^^^^^^^^^^^^^^^\nAttributeError: \'SingularTestNode\' object has no attribute \'attached_node\'\n', 'code': 'if child_test.attached_node:'}
[0m00:06:58.943613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '61fd4e12-a594-4450-9e68-b28ea0182a21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f81a450>]}
[0m00:06:59.336850 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'mart_stock_analysis' in package 'stock_analytics'
(models/marts/mart_stock_analysis.yml). Arguments to generic tests should be
nested under the `arguments` property.
[0m00:06:59.337098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '61fd4e12-a594-4450-9e68-b28ea0182a21', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fc80aa0>]}
[0m00:06:59.420258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '61fd4e12-a594-4450-9e68-b28ea0182a21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fba8d70>]}
[0m00:06:59.454922 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/target/manifest.json
[0m00:06:59.455987 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/target/semantic_manifest.json
[0m00:06:59.469975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '61fd4e12-a594-4450-9e68-b28ea0182a21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f9a53d0>]}
[0m00:06:59.470157 [info ] [MainThread]: Found 3 models, 11 data tests, 2 sources, 492 macros
[0m00:06:59.470275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '61fd4e12-a594-4450-9e68-b28ea0182a21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fc96510>]}
[0m00:06:59.470972 [info ] [MainThread]: 
[0m00:06:59.471093 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:06:59.471185 [info ] [MainThread]: 
[0m00:06:59.471353 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:06:59.473633 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_OSTRICH_PUBLIC_ANALYTICS'
[0m00:06:59.531864 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_OSTRICH_PUBLIC_ANALYTICS"
[0m00:06:59.532027 [debug] [ThreadPool]: On list_USER_DB_OSTRICH_PUBLIC_ANALYTICS: show objects in USER_DB_OSTRICH.PUBLIC_ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_OSTRICH_PUBLIC_ANALYTICS"} */;
[0m00:06:59.532127 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:07:00.129436 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.597 seconds
[0m00:07:00.133212 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_OSTRICH_PUBLIC_ANALYTICS, now list_USER_DB_OSTRICH_PUBLIC_STAGING)
[0m00:07:00.137374 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_OSTRICH_PUBLIC_STAGING"
[0m00:07:00.137808 [debug] [ThreadPool]: On list_USER_DB_OSTRICH_PUBLIC_STAGING: show objects in USER_DB_OSTRICH.PUBLIC_STAGING
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_OSTRICH_PUBLIC_STAGING"} */;
[0m00:07:00.308571 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.170 seconds
[0m00:07:00.313584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '61fd4e12-a594-4450-9e68-b28ea0182a21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f982200>]}
[0m00:07:00.317196 [debug] [Thread-1 (]: Began running node test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316
[0m00:07:00.317587 [info ] [Thread-1 (]: 1 of 10 START test accepted_values_mart_stock_analysis_record_type__historical__forecast  [RUN]
[0m00:07:00.317936 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_OSTRICH_PUBLIC_STAGING, now test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316)
[0m00:07:00.318196 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316
[0m00:07:00.324944 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316"
[0m00:07:00.325710 [debug] [Thread-1 (]: Began executing node test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316
[0m00:07:00.340373 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316"
[0m00:07:00.340994 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316"
[0m00:07:00.341198 [debug] [Thread-1 (]: On test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        record_type as value_field,
        count(*) as n_records

    from USER_DB_OSTRICH.PUBLIC_ANALYTICS.mart_stock_analysis
    group by record_type

)

select *
from all_values
where value_field not in (
    'historical','forecast'
)



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316"} */
[0m00:07:00.517360 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.176 seconds
[0m00:07:00.527651 [info ] [Thread-1 (]: 1 of 10 PASS accepted_values_mart_stock_analysis_record_type__historical__forecast  [[32mPASS[0m in 0.21s]
[0m00:07:00.528287 [debug] [Thread-1 (]: Finished running node test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316
[0m00:07:00.528643 [debug] [Thread-1 (]: Began running node test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5
[0m00:07:00.529021 [info ] [Thread-1 (]: 2 of 10 START test not_null_mart_stock_analysis_date ........................... [RUN]
[0m00:07:00.529442 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316, now test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5)
[0m00:07:00.529738 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5
[0m00:07:00.536024 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5"
[0m00:07:00.536839 [debug] [Thread-1 (]: Began executing node test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5
[0m00:07:00.538456 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5"
[0m00:07:00.539195 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5"
[0m00:07:00.539393 [debug] [Thread-1 (]: On test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date
from USER_DB_OSTRICH.PUBLIC_ANALYTICS.mart_stock_analysis
where date is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5"} */
[0m00:07:00.712841 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.173 seconds
[0m00:07:00.717039 [info ] [Thread-1 (]: 2 of 10 PASS not_null_mart_stock_analysis_date ................................. [[32mPASS[0m in 0.19s]
[0m00:07:00.717629 [debug] [Thread-1 (]: Finished running node test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5
[0m00:07:00.717988 [debug] [Thread-1 (]: Began running node test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e
[0m00:07:00.718395 [info ] [Thread-1 (]: 3 of 10 START test not_null_mart_stock_analysis_symbol ......................... [RUN]
[0m00:07:00.718775 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5, now test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e)
[0m00:07:00.719054 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e
[0m00:07:00.722349 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e"
[0m00:07:00.723771 [debug] [Thread-1 (]: Began executing node test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e
[0m00:07:00.734062 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e"
[0m00:07:00.735077 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e"
[0m00:07:00.735301 [debug] [Thread-1 (]: On test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select symbol
from USER_DB_OSTRICH.PUBLIC_ANALYTICS.mart_stock_analysis
where symbol is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e"} */
[0m00:07:01.020141 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.284 seconds
[0m00:07:01.023316 [info ] [Thread-1 (]: 3 of 10 PASS not_null_mart_stock_analysis_symbol ............................... [[32mPASS[0m in 0.30s]
[0m00:07:01.024112 [debug] [Thread-1 (]: Finished running node test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e
[0m00:07:01.024601 [debug] [Thread-1 (]: Began running node test.stock_analytics.not_null_stg_market_data_date.fb73c94489
[0m00:07:01.025086 [info ] [Thread-1 (]: 4 of 10 START test not_null_stg_market_data_date ............................... [RUN]
[0m00:07:01.025668 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e, now test.stock_analytics.not_null_stg_market_data_date.fb73c94489)
[0m00:07:01.026123 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.not_null_stg_market_data_date.fb73c94489
[0m00:07:01.030977 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.not_null_stg_market_data_date.fb73c94489"
[0m00:07:01.032121 [debug] [Thread-1 (]: Began executing node test.stock_analytics.not_null_stg_market_data_date.fb73c94489
[0m00:07:01.035255 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.not_null_stg_market_data_date.fb73c94489"
[0m00:07:01.036326 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_stg_market_data_date.fb73c94489"
[0m00:07:01.036626 [debug] [Thread-1 (]: On test.stock_analytics.not_null_stg_market_data_date.fb73c94489: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date
from USER_DB_OSTRICH.PUBLIC_STAGING.stg_market_data
where date is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stg_market_data_date.fb73c94489"} */
[0m00:07:01.224000 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.187 seconds
[0m00:07:01.226371 [info ] [Thread-1 (]: 4 of 10 PASS not_null_stg_market_data_date ..................................... [[32mPASS[0m in 0.20s]
[0m00:07:01.227103 [debug] [Thread-1 (]: Finished running node test.stock_analytics.not_null_stg_market_data_date.fb73c94489
[0m00:07:01.227625 [debug] [Thread-1 (]: Began running node test.stock_analytics.not_null_stg_market_data_symbol.478198cf66
[0m00:07:01.228081 [info ] [Thread-1 (]: 5 of 10 START test not_null_stg_market_data_symbol ............................. [RUN]
[0m00:07:01.228552 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_stg_market_data_date.fb73c94489, now test.stock_analytics.not_null_stg_market_data_symbol.478198cf66)
[0m00:07:01.228919 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.not_null_stg_market_data_symbol.478198cf66
[0m00:07:01.233411 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.not_null_stg_market_data_symbol.478198cf66"
[0m00:07:01.234276 [debug] [Thread-1 (]: Began executing node test.stock_analytics.not_null_stg_market_data_symbol.478198cf66
[0m00:07:01.236446 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.not_null_stg_market_data_symbol.478198cf66"
[0m00:07:01.237849 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_stg_market_data_symbol.478198cf66"
[0m00:07:01.238152 [debug] [Thread-1 (]: On test.stock_analytics.not_null_stg_market_data_symbol.478198cf66: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select symbol
from USER_DB_OSTRICH.PUBLIC_STAGING.stg_market_data
where symbol is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stg_market_data_symbol.478198cf66"} */
[0m00:07:01.399194 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.160 seconds
[0m00:07:01.403769 [info ] [Thread-1 (]: 5 of 10 PASS not_null_stg_market_data_symbol ................................... [[32mPASS[0m in 0.18s]
[0m00:07:01.404376 [debug] [Thread-1 (]: Finished running node test.stock_analytics.not_null_stg_market_data_symbol.478198cf66
[0m00:07:01.404696 [debug] [Thread-1 (]: Began running node test.stock_analytics.not_null_stg_market_forecast_date.ca0f3ba00f
[0m00:07:01.405053 [info ] [Thread-1 (]: 6 of 10 START test not_null_stg_market_forecast_date ........................... [RUN]
[0m00:07:01.405486 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_stg_market_data_symbol.478198cf66, now test.stock_analytics.not_null_stg_market_forecast_date.ca0f3ba00f)
[0m00:07:01.405784 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.not_null_stg_market_forecast_date.ca0f3ba00f
[0m00:07:01.409381 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.not_null_stg_market_forecast_date.ca0f3ba00f"
[0m00:07:01.410293 [debug] [Thread-1 (]: Began executing node test.stock_analytics.not_null_stg_market_forecast_date.ca0f3ba00f
[0m00:07:01.411904 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.not_null_stg_market_forecast_date.ca0f3ba00f"
[0m00:07:01.412829 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_stg_market_forecast_date.ca0f3ba00f"
[0m00:07:01.413091 [debug] [Thread-1 (]: On test.stock_analytics.not_null_stg_market_forecast_date.ca0f3ba00f: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date
from USER_DB_OSTRICH.PUBLIC_STAGING.stg_market_forecast
where date is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stg_market_forecast_date.ca0f3ba00f"} */
[0m00:07:01.570131 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.157 seconds
[0m00:07:01.573245 [info ] [Thread-1 (]: 6 of 10 PASS not_null_stg_market_forecast_date ................................. [[32mPASS[0m in 0.17s]
[0m00:07:01.574065 [debug] [Thread-1 (]: Finished running node test.stock_analytics.not_null_stg_market_forecast_date.ca0f3ba00f
[0m00:07:01.574557 [debug] [Thread-1 (]: Began running node test.stock_analytics.not_null_stg_market_forecast_symbol.d304415e8d
[0m00:07:01.575054 [info ] [Thread-1 (]: 7 of 10 START test not_null_stg_market_forecast_symbol ......................... [RUN]
[0m00:07:01.575629 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_stg_market_forecast_date.ca0f3ba00f, now test.stock_analytics.not_null_stg_market_forecast_symbol.d304415e8d)
[0m00:07:01.576060 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.not_null_stg_market_forecast_symbol.d304415e8d
[0m00:07:01.581817 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.not_null_stg_market_forecast_symbol.d304415e8d"
[0m00:07:01.582980 [debug] [Thread-1 (]: Began executing node test.stock_analytics.not_null_stg_market_forecast_symbol.d304415e8d
[0m00:07:01.585381 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.not_null_stg_market_forecast_symbol.d304415e8d"
[0m00:07:01.586390 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_stg_market_forecast_symbol.d304415e8d"
[0m00:07:01.586717 [debug] [Thread-1 (]: On test.stock_analytics.not_null_stg_market_forecast_symbol.d304415e8d: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select symbol
from USER_DB_OSTRICH.PUBLIC_STAGING.stg_market_forecast
where symbol is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stg_market_forecast_symbol.d304415e8d"} */
[0m00:07:01.760118 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.173 seconds
[0m00:07:01.763509 [info ] [Thread-1 (]: 7 of 10 PASS not_null_stg_market_forecast_symbol ............................... [[32mPASS[0m in 0.19s]
[0m00:07:01.764335 [debug] [Thread-1 (]: Finished running node test.stock_analytics.not_null_stg_market_forecast_symbol.d304415e8d
[0m00:07:01.764826 [debug] [Thread-1 (]: Began running node test.stock_analytics.unique_mart_stock_analysis_symbol__date.4cb324d403
[0m00:07:01.765295 [info ] [Thread-1 (]: 8 of 10 START test unique_mart_stock_analysis_symbol__date ..................... [RUN]
[0m00:07:01.765838 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_stg_market_forecast_symbol.d304415e8d, now test.stock_analytics.unique_mart_stock_analysis_symbol__date.4cb324d403)
[0m00:07:01.766235 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.unique_mart_stock_analysis_symbol__date.4cb324d403
[0m00:07:01.775478 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.unique_mart_stock_analysis_symbol__date.4cb324d403"
[0m00:07:01.776139 [debug] [Thread-1 (]: Began executing node test.stock_analytics.unique_mart_stock_analysis_symbol__date.4cb324d403
[0m00:07:01.778007 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.unique_mart_stock_analysis_symbol__date.4cb324d403"
[0m00:07:01.778861 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.unique_mart_stock_analysis_symbol__date.4cb324d403"
[0m00:07:01.779148 [debug] [Thread-1 (]: On test.stock_analytics.unique_mart_stock_analysis_symbol__date.4cb324d403: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    ['symbol', 'date'] as unique_field,
    count(*) as n_records

from USER_DB_OSTRICH.PUBLIC_ANALYTICS.mart_stock_analysis
where ['symbol', 'date'] is not null
group by ['symbol', 'date']
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.unique_mart_stock_analysis_symbol__date.4cb324d403"} */
[0m00:07:02.061310 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.282 seconds
[0m00:07:02.065066 [error] [Thread-1 (]: 8 of 10 FAIL 1 unique_mart_stock_analysis_symbol__date ......................... [[31mFAIL 1[0m in 0.30s]
[0m00:07:02.065895 [debug] [Thread-1 (]: Finished running node test.stock_analytics.unique_mart_stock_analysis_symbol__date.4cb324d403
[0m00:07:02.066380 [debug] [Thread-1 (]: Began running node test.stock_analytics.unique_stg_market_data_symbol__date.3e1fafb254
[0m00:07:02.066851 [info ] [Thread-1 (]: 9 of 10 START test unique_stg_market_data_symbol__date ......................... [RUN]
[0m00:07:02.067413 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.unique_mart_stock_analysis_symbol__date.4cb324d403, now test.stock_analytics.unique_stg_market_data_symbol__date.3e1fafb254)
[0m00:07:02.067836 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.unique_stg_market_data_symbol__date.3e1fafb254
[0m00:07:02.074764 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.unique_stg_market_data_symbol__date.3e1fafb254"
[0m00:07:02.075937 [debug] [Thread-1 (]: Began executing node test.stock_analytics.unique_stg_market_data_symbol__date.3e1fafb254
[0m00:07:02.078275 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.unique_stg_market_data_symbol__date.3e1fafb254"
[0m00:07:02.079247 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.unique_stg_market_data_symbol__date.3e1fafb254"
[0m00:07:02.079542 [debug] [Thread-1 (]: On test.stock_analytics.unique_stg_market_data_symbol__date.3e1fafb254: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    ['symbol', 'date'] as unique_field,
    count(*) as n_records

from USER_DB_OSTRICH.PUBLIC_STAGING.stg_market_data
where ['symbol', 'date'] is not null
group by ['symbol', 'date']
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.unique_stg_market_data_symbol__date.3e1fafb254"} */
[0m00:07:02.422446 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.342 seconds
[0m00:07:02.425628 [error] [Thread-1 (]: 9 of 10 FAIL 1 unique_stg_market_data_symbol__date ............................. [[31mFAIL 1[0m in 0.36s]
[0m00:07:02.426404 [debug] [Thread-1 (]: Finished running node test.stock_analytics.unique_stg_market_data_symbol__date.3e1fafb254
[0m00:07:02.426878 [debug] [Thread-1 (]: Began running node test.stock_analytics.unique_stg_market_forecast_symbol__date.d55b034665
[0m00:07:02.427310 [info ] [Thread-1 (]: 10 of 10 START test unique_stg_market_forecast_symbol__date .................... [RUN]
[0m00:07:02.427859 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.unique_stg_market_data_symbol__date.3e1fafb254, now test.stock_analytics.unique_stg_market_forecast_symbol__date.d55b034665)
[0m00:07:02.428242 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.unique_stg_market_forecast_symbol__date.d55b034665
[0m00:07:02.432878 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.unique_stg_market_forecast_symbol__date.d55b034665"
[0m00:07:02.434357 [debug] [Thread-1 (]: Began executing node test.stock_analytics.unique_stg_market_forecast_symbol__date.d55b034665
[0m00:07:02.436840 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.unique_stg_market_forecast_symbol__date.d55b034665"
[0m00:07:02.437697 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.unique_stg_market_forecast_symbol__date.d55b034665"
[0m00:07:02.437990 [debug] [Thread-1 (]: On test.stock_analytics.unique_stg_market_forecast_symbol__date.d55b034665: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    ['symbol', 'date'] as unique_field,
    count(*) as n_records

from USER_DB_OSTRICH.PUBLIC_STAGING.stg_market_forecast
where ['symbol', 'date'] is not null
group by ['symbol', 'date']
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.unique_stg_market_forecast_symbol__date.d55b034665"} */
[0m00:07:02.659054 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.220 seconds
[0m00:07:02.662806 [error] [Thread-1 (]: 10 of 10 FAIL 1 unique_stg_market_forecast_symbol__date ........................ [[31mFAIL 1[0m in 0.23s]
[0m00:07:02.663559 [debug] [Thread-1 (]: Finished running node test.stock_analytics.unique_stg_market_forecast_symbol__date.d55b034665
[0m00:07:02.665082 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:07:02.665474 [debug] [MainThread]: Connection 'test.stock_analytics.unique_stg_market_forecast_symbol__date.d55b034665' was left open.
[0m00:07:02.665768 [debug] [MainThread]: On test.stock_analytics.unique_stg_market_forecast_symbol__date.d55b034665: Close
[0m00:07:02.786353 [info ] [MainThread]: 
[0m00:07:02.786885 [info ] [MainThread]: Finished running 10 data tests in 0 hours 0 minutes and 3.31 seconds (3.31s).
[0m00:07:02.788788 [debug] [MainThread]: Command end result
[0m00:07:02.809014 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/target/manifest.json
[0m00:07:02.810237 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/target/semantic_manifest.json
[0m00:07:02.816816 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/target/run_results.json
[0m00:07:02.817275 [info ] [MainThread]: 
[0m00:07:02.817613 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m00:07:02.817877 [info ] [MainThread]: 
[0m00:07:02.818183 [error] [MainThread]: [31mFailure in test unique_mart_stock_analysis_symbol__date (models/marts/mart_stock_analysis.yml)[0m
[0m00:07:02.818532 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m00:07:02.818657 [info ] [MainThread]: 
[0m00:07:02.819004 [info ] [MainThread]:   compiled code at target/compiled/stock_analytics/models/marts/mart_stock_analysis.yml/unique_mart_stock_analysis_symbol__date.sql
[0m00:07:02.819197 [info ] [MainThread]: 
[0m00:07:02.819388 [error] [MainThread]: [31mFailure in test unique_stg_market_data_symbol__date (models/staging/stg_market_data.yml)[0m
[0m00:07:02.819520 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m00:07:02.819611 [info ] [MainThread]: 
[0m00:07:02.819743 [info ] [MainThread]:   compiled code at target/compiled/stock_analytics/models/staging/stg_market_data.yml/unique_stg_market_data_symbol__date.sql
[0m00:07:02.819890 [info ] [MainThread]: 
[0m00:07:02.820039 [error] [MainThread]: [31mFailure in test unique_stg_market_forecast_symbol__date (models/staging/stg_market_forecast.yml)[0m
[0m00:07:02.820218 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m00:07:02.820416 [info ] [MainThread]: 
[0m00:07:02.820573 [info ] [MainThread]:   compiled code at target/compiled/stock_analytics/models/staging/stg_market_forecast.yml/unique_stg_market_forecast_symbol__date.sql
[0m00:07:02.820715 [info ] [MainThread]: 
[0m00:07:02.820860 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=3 SKIP=0 NO-OP=0 TOTAL=10
[0m00:07:02.821120 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m00:07:02.827108 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 4.8390594, "process_in_blocks": "0", "process_kernel_time": 0.314037, "process_mem_max_rss": "252264448", "process_out_blocks": "0", "process_user_time": 1.877724}
[0m00:07:02.827403 [debug] [MainThread]: Command `dbt test` failed at 00:07:02.827354 after 4.84 seconds
[0m00:07:02.827591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115d46210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ff176e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ff2a3d0>]}
[0m00:07:02.827749 [debug] [MainThread]: Flushing usage events
[0m00:07:03.162460 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:12:05.799889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e3be00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107637b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107637d90>]}


============================== 00:12:05.802518 | f5957fe4-64f1-4971-9817-a85914cd48b8 ==============================
[0m00:12:05.802518 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m00:12:05.802790 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'version_check': 'True', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'debug': 'False', 'introspect': 'True', 'quiet': 'False', 'invocation_command': 'dbt test -s unique_mart_stock_analysis_symbol__date__record_type --store-failures', 'warn_error': 'None', 'log_format': 'default', 'log_path': '/Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'None', 'profiles_dir': '/Users/rahulmohandevi/.dbt', 'target_path': 'None', 'static_parser': 'True', 'write_json': 'True', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'use_colors': 'True', 'indirect_selection': 'eager'}
[0m00:12:06.518569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f5957fe4-64f1-4971-9817-a85914cd48b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061f0510>]}
[0m00:12:06.542017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f5957fe4-64f1-4971-9817-a85914cd48b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a4ec270>]}
[0m00:12:06.542543 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m00:12:06.593429 [debug] [MainThread]: checksum: e63134dccc1251cfb572caf0e4aa952f030c125ee3634f3bf2c0a2e1bb6ae349, vars: {}, profile: , target: , version: 1.11.0b3
[0m00:12:06.664305 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:12:06.664479 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:12:06.682392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f5957fe4-64f1-4971-9817-a85914cd48b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a8cac50>]}
[0m00:12:06.718829 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/target/manifest.json
[0m00:12:06.719962 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/target/semantic_manifest.json
[0m00:12:06.735203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f5957fe4-64f1-4971-9817-a85914cd48b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ac824e0>]}
[0m00:12:06.735403 [info ] [MainThread]: Found 3 models, 11 data tests, 2 sources, 492 macros
[0m00:12:06.735527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f5957fe4-64f1-4971-9817-a85914cd48b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11acfd7f0>]}
[0m00:12:06.735781 [warn ] [MainThread]: The selection criterion 'unique_mart_stock_analysis_symbol__date__record_type' does not match any enabled nodes
[0m00:12:06.736228 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m00:12:06.736930 [debug] [MainThread]: Command end result
[0m00:12:06.744685 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/target/manifest.json
[0m00:12:06.745264 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/target/semantic_manifest.json
[0m00:12:06.746629 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/target/run_results.json
[0m00:12:06.750024 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.9810143, "process_in_blocks": "0", "process_kernel_time": 0.24343, "process_mem_max_rss": "221659136", "process_out_blocks": "0", "process_user_time": 1.069107}
[0m00:12:06.750163 [debug] [MainThread]: Command `dbt test` succeeded at 00:12:06.750131 after 0.98 seconds
[0m00:12:06.750290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11acc3d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e425d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a90ebd0>]}
[0m00:12:06.750396 [debug] [MainThread]: Flushing usage events
[0m00:12:07.106413 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:10:48.776831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a17e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119d1fb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119d1fd90>]}


============================== 08:10:48.779351 | 303ac88c-f759-4bba-ac1c-616e9518949e ==============================
[0m08:10:48.779351 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m08:10:48.779595 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'partial_parse': 'True', 'printer_width': '80', 'introspect': 'True', 'log_cache_events': 'False', 'fail_fast': 'False', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'empty': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'log_path': '/Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/logs', 'target_path': 'None', 'profiles_dir': '/Users/rahulmohandevi/.dbt', 'no_print': 'None', 'indirect_selection': 'eager'}
[0m08:10:48.881588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '303ac88c-f759-4bba-ac1c-616e9518949e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11813c510>]}
[0m08:10:48.893655 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.14732662, "process_in_blocks": "0", "process_kernel_time": 0.138641, "process_mem_max_rss": "124829696", "process_out_blocks": "0", "process_user_time": 0.619531}
[0m08:10:48.893839 [debug] [MainThread]: Command `dbt clean` succeeded at 08:10:48.893799 after 0.15 seconds
[0m08:10:48.893973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119f90380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119f907c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119fc9e50>]}
[0m08:10:48.894094 [debug] [MainThread]: Flushing usage events
[0m08:10:49.226209 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:10:59.922600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078a3e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e23b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e23d90>]}


============================== 08:10:59.924373 | c4785bf9-e5f5-4149-b6f7-56f8527a9147 ==============================
[0m08:10:59.924373 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m08:10:59.924622 [debug] [MainThread]: running dbt with arguments {'empty': 'None', 'write_json': 'True', 'cache_selected_only': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'quiet': 'False', 'partial_parse': 'True', 'log_format': 'default', 'version_check': 'True', 'indirect_selection': 'eager', 'warn_error': 'None', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'target_path': 'None', 'use_colors': 'True', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'profiles_dir': '/Users/rahulmohandevi/.dbt', 'printer_width': '80', 'log_path': '/Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/logs', 'log_cache_events': 'False'}
[0m08:10:59.980784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c4785bf9-e5f5-4149-b6f7-56f8527a9147', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c58510>]}
[0m08:10:59.988338 [debug] [MainThread]: Set downloads directory='/var/folders/y9/363ww6xx1mj71820g9szqs7r0000gn/T/dbt-downloads-wnp_82pm'
[0m08:10:59.988499 [error] [MainThread]: Encountered an error:
">=1.1.1,<2.0.0" is not a valid semantic version.
[0m08:10:59.990617 [error] [MainThread]: Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.13/site-packages/dbt/cli/requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
                      ~~~~^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.13/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.13/site-packages/dbt/cli/requires.py", line 254, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.13/site-packages/dbt/cli/requires.py", line 303, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.13/site-packages/dbt/cli/main.py", line 461, in deps
    results = task.run()
  File "/opt/anaconda3/lib/python3.13/site-packages/dbt/task/deps.py", line 215, in run
    self.lock()
    ~~~~~~~~~^^
  File "/opt/anaconda3/lib/python3.13/site-packages/dbt/task/deps.py", line 187, in lock
    resolved_deps = resolve_packages(packages, self.project, self.cli_vars)
  File "/opt/anaconda3/lib/python3.13/site-packages/dbt/deps/resolver.py", line 121, in resolve_packages
    pending = PackageListing.from_contracts(packages)
  File "/opt/anaconda3/lib/python3.13/site-packages/dbt/deps/resolver.py", line 91, in from_contracts
    self.update_from(src)
    ~~~~~~~~~~~~~~~~^^^^^
  File "/opt/anaconda3/lib/python3.13/site-packages/dbt/deps/resolver.py", line 83, in update_from
    pkg = RegistryUnpinnedPackage.from_contract(contract)
  File "/opt/anaconda3/lib/python3.13/site-packages/dbt/deps/registry.py", line 83, in from_contract
    versions = [semver.VersionSpecifier.from_version_string(v) for v in raw_version]
                ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^
  File "/opt/anaconda3/lib/python3.13/site-packages/dbt_common/semver.py", line 99, in from_version_string
    raise dbt_common.exceptions.base.SemverError(
        f'"{version_string}" is not a valid semantic version.'
    )
dbt_common.exceptions.base.SemverError: ">=1.1.1,<2.0.0" is not a valid semantic version.

[0m08:10:59.991841 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": false, "command_wall_clock_time": 0.094168045, "process_in_blocks": "0", "process_kernel_time": 0.105662, "process_mem_max_rss": "122437632", "process_out_blocks": "0", "process_user_time": 0.572805}
[0m08:10:59.991983 [debug] [MainThread]: Command `dbt deps` failed at 08:10:59.991949 after 0.09 seconds
[0m08:10:59.992100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fd3ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fd3bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fcad50>]}
[0m08:10:59.992209 [debug] [MainThread]: Flushing usage events
[0m08:11:00.302954 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:14:09.460874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106093e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e2fb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e2fd90>]}


============================== 08:14:09.463383 | 19de2bb4-b583-43bc-96b3-b46a83376f82 ==============================
[0m08:14:09.463383 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m08:14:09.463647 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/Users/rahulmohandevi/.dbt', 'static_parser': 'True', 'quiet': 'False', 'debug': 'False', 'empty': 'None', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'invocation_command': 'dbt deps', 'log_format': 'default', 'no_print': 'None', 'log_path': '/Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/logs', 'introspect': 'True', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'partial_parse': 'True', 'indirect_selection': 'eager', 'printer_width': '80', 'target_path': 'None', 'cache_selected_only': 'False', 'fail_fast': 'False'}
[0m08:14:09.564361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '19de2bb4-b583-43bc-96b3-b46a83376f82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10653c510>]}
[0m08:14:09.574074 [debug] [MainThread]: Set downloads directory='/var/folders/y9/363ww6xx1mj71820g9szqs7r0000gn/T/dbt-downloads-ojk_q9id'
[0m08:14:09.574274 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m08:14:09.725018 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m08:14:09.725649 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m08:14:09.796305 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m08:14:09.802588 [error] [MainThread]: Encountered an error:
Could not find a matching compatible version for package dbt-labs/dbt_utils
  Requested range: =1.4.0, =1.4.0
  Compatible versions: ['0.0.1', '0.1.0', '0.1.1', '0.1.2', '0.1.3', '0.1.4', '0.1.5', '0.1.6', '0.1.7', '0.1.8', '0.1.9', '0.1.10', '0.1.11', '0.1.12', '0.1.13', '0.1.14', '0.1.15', '0.1.16', '0.1.17', '0.1.18', '0.1.19', '0.1.20', '0.1.21', '0.1.22', '0.1.23', '0.1.24', '0.1.25', '0.2.0', '0.2.1', '0.2.2', '0.2.3', '0.2.4', '0.2.5', '0.3.0', '0.4.0', '0.4.1', '0.5.0', '0.8.0', '0.8.1', '0.8.2', '0.8.3', '0.8.4', '0.8.5', '0.8.6', '0.9.0', '0.9.1', '0.9.2', '0.9.5', '0.9.6', '1.0.0', '1.1.0', '1.1.1', '1.2.0', '1.3.0', '1.3.1', '1.3.2']

  Not shown: package versions incompatible with installed version of dbt-core
  To include them, run 'dbt --no-version-check deps'
[0m08:14:09.808881 [error] [MainThread]: Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.13/site-packages/dbt/cli/requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
                      ~~~~^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.13/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.13/site-packages/dbt/cli/requires.py", line 254, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.13/site-packages/dbt/cli/requires.py", line 303, in wrapper
    return func(*args, **kwargs)
  File "/opt/anaconda3/lib/python3.13/site-packages/dbt/cli/main.py", line 461, in deps
    results = task.run()
  File "/opt/anaconda3/lib/python3.13/site-packages/dbt/task/deps.py", line 215, in run
    self.lock()
    ~~~~~~~~~^^
  File "/opt/anaconda3/lib/python3.13/site-packages/dbt/task/deps.py", line 187, in lock
    resolved_deps = resolve_packages(packages, self.project, self.cli_vars)
  File "/opt/anaconda3/lib/python3.13/site-packages/dbt/deps/resolver.py", line 131, in resolve_packages
    target = final[package].resolved().fetch_metadata(project, renderer)
             ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/opt/anaconda3/lib/python3.13/site-packages/dbt/deps/registry.py", line 124, in resolved
    raise PackageVersionNotFoundError(
        self.package, range_, installable, should_version_check
    )
dbt.exceptions.PackageVersionNotFoundError: Could not find a matching compatible version for package dbt-labs/dbt_utils
  Requested range: =1.4.0, =1.4.0
  Compatible versions: ['0.0.1', '0.1.0', '0.1.1', '0.1.2', '0.1.3', '0.1.4', '0.1.5', '0.1.6', '0.1.7', '0.1.8', '0.1.9', '0.1.10', '0.1.11', '0.1.12', '0.1.13', '0.1.14', '0.1.15', '0.1.16', '0.1.17', '0.1.18', '0.1.19', '0.1.20', '0.1.21', '0.1.22', '0.1.23', '0.1.24', '0.1.25', '0.2.0', '0.2.1', '0.2.2', '0.2.3', '0.2.4', '0.2.5', '0.3.0', '0.4.0', '0.4.1', '0.5.0', '0.8.0', '0.8.1', '0.8.2', '0.8.3', '0.8.4', '0.8.5', '0.8.6', '0.9.0', '0.9.1', '0.9.2', '0.9.5', '0.9.6', '1.0.0', '1.1.0', '1.1.1', '1.2.0', '1.3.0', '1.3.1', '1.3.2']

  Not shown: package versions incompatible with installed version of dbt-core
  To include them, run 'dbt --no-version-check deps'

[0m08:14:09.813912 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": false, "command_wall_clock_time": 0.3827586, "process_in_blocks": "0", "process_kernel_time": 0.132955, "process_mem_max_rss": "124321792", "process_out_blocks": "0", "process_user_time": 0.588061}
[0m08:14:09.814305 [debug] [MainThread]: Command `dbt deps` failed at 08:14:09.814217 after 0.38 seconds
[0m08:14:09.814611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fd9260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fdbce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fd2f50>]}
[0m08:14:09.814920 [debug] [MainThread]: Flushing usage events
[0m08:14:10.190797 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:16:27.480253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10577fe00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cf7b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cf7d90>]}


============================== 08:16:27.482740 | 4706b543-6840-4289-aa7a-ba14b4481693 ==============================
[0m08:16:27.482740 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m08:16:27.482988 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'debug': 'False', 'empty': 'None', 'partial_parse': 'True', 'write_json': 'True', 'fail_fast': 'False', 'version_check': 'True', 'log_cache_events': 'False', 'printer_width': '80', 'introspect': 'True', 'target_path': 'None', 'cache_selected_only': 'False', 'quiet': 'False', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'use_experimental_parser': 'False', 'warn_error': 'None', 'use_colors': 'True', 'log_path': '/Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/logs', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'profiles_dir': '/Users/rahulmohandevi/.dbt', 'invocation_command': 'dbt clean'}
[0m08:16:27.581008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4706b543-6840-4289-aa7a-ba14b4481693', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b28510>]}
[0m08:16:27.590584 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.13838908, "process_in_blocks": "0", "process_kernel_time": 0.128784, "process_mem_max_rss": "119635968", "process_out_blocks": "0", "process_user_time": 0.56339}
[0m08:16:27.590741 [debug] [MainThread]: Command `dbt clean` succeeded at 08:16:27.590702 after 0.14 seconds
[0m08:16:27.590862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106eac380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106eac7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ea1d50>]}
[0m08:16:27.590976 [debug] [MainThread]: Flushing usage events
[0m08:16:27.970028 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:16:37.015467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f23e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105497b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105497d90>]}


============================== 08:16:37.017208 | 8f7e822f-be7f-4ce8-baf9-ba2c9fc278cf ==============================
[0m08:16:37.017208 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m08:16:37.017452 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'introspect': 'True', 'quiet': 'False', 'profiles_dir': '/Users/rahulmohandevi/.dbt', 'use_experimental_parser': 'False', 'write_json': 'True', 'log_path': '/Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/logs', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'target_path': 'None', 'no_print': 'None', 'version_check': 'False', 'printer_width': '80', 'invocation_command': 'dbt deps --no-version-check', 'log_cache_events': 'False', 'empty': 'None', 'indirect_selection': 'eager', 'use_colors': 'True'}
[0m08:16:37.069892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8f7e822f-be7f-4ce8-baf9-ba2c9fc278cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042cc510>]}
[0m08:16:37.076841 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m08:16:37.077144 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m08:16:37.078295 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.08743617, "process_in_blocks": "0", "process_kernel_time": 0.096296, "process_mem_max_rss": "120111104", "process_out_blocks": "0", "process_user_time": 0.568299}
[0m08:16:37.078439 [debug] [MainThread]: Command `dbt deps` succeeded at 08:16:37.078403 after 0.09 seconds
[0m08:16:37.078557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105658c00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105659260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104defd50>]}
[0m08:16:37.078665 [debug] [MainThread]: Flushing usage events
[0m08:16:37.386142 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:24:04.954199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107593e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111027b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111027d90>]}


============================== 08:24:04.956877 | e926e0ee-db86-43fe-b90a-16fcbab9d22a ==============================
[0m08:24:04.956877 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m08:24:04.957155 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt clean', 'indirect_selection': 'eager', 'use_colors': 'True', 'warn_error': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'cache_selected_only': 'False', 'empty': 'None', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'log_path': '/Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/rahulmohandevi/.dbt', 'no_print': 'None', 'log_cache_events': 'False', 'write_json': 'True', 'debug': 'False', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'send_anonymous_usage_stats': 'True'}
[0m08:24:05.054571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e926e0ee-db86-43fe-b90a-16fcbab9d22a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b3c510>]}
[0m08:24:05.063991 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.13809645, "process_in_blocks": "0", "process_kernel_time": 0.10934, "process_mem_max_rss": "122634240", "process_out_blocks": "0", "process_user_time": 0.576068}
[0m08:24:05.064145 [debug] [MainThread]: Command `dbt clean` succeeded at 08:24:05.064107 after 0.14 seconds
[0m08:24:05.064262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111e4380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111e47c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111d9d50>]}
[0m08:24:05.064372 [debug] [MainThread]: Flushing usage events
[0m08:24:05.447221 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:24:18.208128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10395fe00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ee7b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ee7d90>]}


============================== 08:24:18.209919 | c99e7f9d-9f4f-4e33-bd92-344240fc5052 ==============================
[0m08:24:18.209919 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m08:24:18.210156 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'cache_selected_only': 'False', 'write_json': 'True', 'profiles_dir': '/Users/rahulmohandevi/.dbt', 'log_cache_events': 'False', 'use_colors': 'True', 'log_path': '/Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/logs', 'printer_width': '80', 'static_parser': 'True', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'indirect_selection': 'eager', 'quiet': 'False', 'empty': 'False', 'partial_parse': 'True', 'introspect': 'True', 'fail_fast': 'False', 'debug': 'False', 'version_check': 'True', 'use_experimental_parser': 'False', 'invocation_command': 'dbt run -s stg_market_data stg_market_forecast', 'log_format': 'default'}
[0m08:24:19.005900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c99e7f9d-9f4f-4e33-bd92-344240fc5052', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d14510>]}
[0m08:24:19.027993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c99e7f9d-9f4f-4e33-bd92-344240fc5052', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1205ec270>]}
[0m08:24:19.028596 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m08:24:19.076088 [debug] [MainThread]: checksum: e63134dccc1251cfb572caf0e4aa952f030c125ee3634f3bf2c0a2e1bb6ae349, vars: {}, profile: , target: , version: 1.11.0b3
[0m08:24:19.076459 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m08:24:19.076608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c99e7f9d-9f4f-4e33-bd92-344240fc5052', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1204e3a50>]}
[0m08:24:19.494637 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'mart_stock_analysis' in package 'stock_analytics'
(models/marts/mart_stock_analysis.yml). Arguments to generic tests should be
nested under the `arguments` property.
[0m08:24:19.494877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c99e7f9d-9f4f-4e33-bd92-344240fc5052', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12059b6b0>]}
[0m08:24:19.578007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c99e7f9d-9f4f-4e33-bd92-344240fc5052', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12191e0b0>]}
[0m08:24:19.612731 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/target/manifest.json
[0m08:24:19.613787 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/target/semantic_manifest.json
[0m08:24:19.620618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c99e7f9d-9f4f-4e33-bd92-344240fc5052', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1219b7110>]}
[0m08:24:19.620784 [info ] [MainThread]: Found 3 models, 11 data tests, 2 sources, 492 macros
[0m08:24:19.620900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c99e7f9d-9f4f-4e33-bd92-344240fc5052', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120d43f50>]}
[0m08:24:19.621567 [info ] [MainThread]: 
[0m08:24:19.621687 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:24:19.621776 [info ] [MainThread]: 
[0m08:24:19.621948 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:24:19.623516 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_OSTRICH'
[0m08:24:19.680867 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_OSTRICH"
[0m08:24:19.681036 [debug] [ThreadPool]: On list_USER_DB_OSTRICH: show terse schemas in database USER_DB_OSTRICH
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_OSTRICH"} */
[0m08:24:19.681131 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:24:22.488408 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 2.807 seconds
[0m08:24:22.493248 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_OSTRICH, now list_USER_DB_OSTRICH_PUBLIC_STAGING)
[0m08:24:22.506297 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_OSTRICH_PUBLIC_STAGING"
[0m08:24:22.506659 [debug] [ThreadPool]: On list_USER_DB_OSTRICH_PUBLIC_STAGING: show objects in USER_DB_OSTRICH.PUBLIC_STAGING
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_OSTRICH_PUBLIC_STAGING"} */;
[0m08:24:22.899677 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.393 seconds
[0m08:24:22.902704 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_OSTRICH_PUBLIC_STAGING, now list_USER_DB_OSTRICH_PUBLIC_ANALYTICS)
[0m08:24:22.905962 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_OSTRICH_PUBLIC_ANALYTICS"
[0m08:24:22.906326 [debug] [ThreadPool]: On list_USER_DB_OSTRICH_PUBLIC_ANALYTICS: show objects in USER_DB_OSTRICH.PUBLIC_ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_OSTRICH_PUBLIC_ANALYTICS"} */;
[0m08:24:23.411453 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.505 seconds
[0m08:24:23.416383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c99e7f9d-9f4f-4e33-bd92-344240fc5052', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1219b2af0>]}
[0m08:24:23.420051 [debug] [Thread-1 (]: Began running node model.stock_analytics.stg_market_data
[0m08:24:23.420499 [info ] [Thread-1 (]: 1 of 2 START sql view model PUBLIC_STAGING.stg_market_data ..................... [RUN]
[0m08:24:23.420835 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_OSTRICH_PUBLIC_ANALYTICS, now model.stock_analytics.stg_market_data)
[0m08:24:23.421074 [debug] [Thread-1 (]: Began compiling node model.stock_analytics.stg_market_data
[0m08:24:23.427344 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_analytics.stg_market_data"
[0m08:24:23.428185 [debug] [Thread-1 (]: Began executing node model.stock_analytics.stg_market_data
[0m08:24:23.444684 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_analytics.stg_market_data"
[0m08:24:23.445492 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.stg_market_data"
[0m08:24:23.445680 [debug] [Thread-1 (]: On model.stock_analytics.stg_market_data: create or replace   view USER_DB_OSTRICH.PUBLIC_STAGING.stg_market_data
  
  
  
  
  as (
    

select distinct
  upper(symbol)                        as symbol,
  cast(date as date)                   as date,
  cast(open  as float)                 as open,
  cast(high  as float)                 as high,
  cast(low   as float)                 as low,
  cast(close as float)                 as close,
  cast(volume as float)                as volume,
  -- single-column pk for generic dbt `unique` test
  concat(upper(symbol), '|', to_varchar(cast(date as date))) as pk_symbol_date
from USER_DB_OSTRICH.RAW.MARKET_DATA
where date is not null
  )
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.stg_market_data"} */;
[0m08:24:24.127188 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.681 seconds
[0m08:24:24.154888 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c99e7f9d-9f4f-4e33-bd92-344240fc5052', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c854f0>]}
[0m08:24:24.155517 [info ] [Thread-1 (]: 1 of 2 OK created sql view model PUBLIC_STAGING.stg_market_data ................ [[32mSUCCESS 1[0m in 0.73s]
[0m08:24:24.155946 [debug] [Thread-1 (]: Finished running node model.stock_analytics.stg_market_data
[0m08:24:24.156233 [debug] [Thread-1 (]: Began running node model.stock_analytics.stg_market_forecast
[0m08:24:24.156663 [info ] [Thread-1 (]: 2 of 2 START sql view model PUBLIC_STAGING.stg_market_forecast ................. [RUN]
[0m08:24:24.157060 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.stock_analytics.stg_market_data, now model.stock_analytics.stg_market_forecast)
[0m08:24:24.157323 [debug] [Thread-1 (]: Began compiling node model.stock_analytics.stg_market_forecast
[0m08:24:24.159466 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_analytics.stg_market_forecast"
[0m08:24:24.160018 [debug] [Thread-1 (]: Began executing node model.stock_analytics.stg_market_forecast
[0m08:24:24.161920 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_analytics.stg_market_forecast"
[0m08:24:24.162881 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.stg_market_forecast"
[0m08:24:24.163126 [debug] [Thread-1 (]: On model.stock_analytics.stg_market_forecast: create or replace   view USER_DB_OSTRICH.PUBLIC_STAGING.stg_market_forecast
  
  
  
  
  as (
    

with src as (
  select
    upper(symbol)                         as symbol,
    cast(date as date)                    as date,
    cast(actual as float)                 as actual,
    cast(forecast as float)               as forecast,
    cast(lower_bound as float)            as lower_bound,
    cast(upper_bound as float)            as upper_bound
  from USER_DB_OSTRICH.ANALYTICS.MARKET_DATA
  where date is not null
),
future_only as (
  select
    symbol, date, forecast, lower_bound, upper_bound
  from src
  where actual is null
)
select distinct
  symbol,
  date,
  forecast,
  lower_bound,
  upper_bound,
  -- single-column pk for generic dbt `unique` test
  concat(symbol, '|', to_varchar(date)) as pk_symbol_date
from future_only
  )
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.stg_market_forecast"} */;
[0m08:24:24.545897 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.382 seconds
[0m08:24:24.551040 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c99e7f9d-9f4f-4e33-bd92-344240fc5052', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120f11050>]}
[0m08:24:24.552394 [info ] [Thread-1 (]: 2 of 2 OK created sql view model PUBLIC_STAGING.stg_market_forecast ............ [[32mSUCCESS 1[0m in 0.39s]
[0m08:24:24.553260 [debug] [Thread-1 (]: Finished running node model.stock_analytics.stg_market_forecast
[0m08:24:24.554441 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:24:24.554673 [debug] [MainThread]: Connection 'model.stock_analytics.stg_market_forecast' was left open.
[0m08:24:24.554875 [debug] [MainThread]: On model.stock_analytics.stg_market_forecast: Close
[0m08:24:24.662575 [info ] [MainThread]: 
[0m08:24:24.663335 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 5.04 seconds (5.04s).
[0m08:24:24.664451 [debug] [MainThread]: Command end result
[0m08:24:24.688843 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/target/manifest.json
[0m08:24:24.690224 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/target/semantic_manifest.json
[0m08:24:24.694280 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/target/run_results.json
[0m08:24:24.694468 [info ] [MainThread]: 
[0m08:24:24.694685 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:24:24.694844 [info ] [MainThread]: 
[0m08:24:24.695032 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m08:24:24.695391 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m08:24:24.700404 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.5173526, "process_in_blocks": "0", "process_kernel_time": 0.292094, "process_mem_max_rss": "256524288", "process_out_blocks": "0", "process_user_time": 1.809699}
[0m08:24:24.700659 [debug] [MainThread]: Command `dbt run` succeeded at 08:24:24.700607 after 6.52 seconds
[0m08:24:24.700855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f1b070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100da1cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1229922d0>]}
[0m08:24:24.701039 [debug] [MainThread]: Flushing usage events
[0m08:24:25.004763 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:24:37.198106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056e3e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c63b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c63d90>]}


============================== 08:24:37.199865 | 3df191fa-2482-4b00-9f1b-d0b10ccceb13 ==============================
[0m08:24:37.199865 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m08:24:37.200104 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'log_path': '/Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/logs', 'quiet': 'False', 'printer_width': '80', 'debug': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'static_parser': 'True', 'log_cache_events': 'False', 'version_check': 'True', 'invocation_command': 'dbt run -s mart_stock_analysis --full-refresh', 'cache_selected_only': 'False', 'target_path': 'None', 'log_format': 'default', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'empty': 'False', 'fail_fast': 'False', 'profiles_dir': '/Users/rahulmohandevi/.dbt', 'indirect_selection': 'eager'}
[0m08:24:37.613126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3df191fa-2482-4b00-9f1b-d0b10ccceb13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a8c510>]}
[0m08:24:37.635001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3df191fa-2482-4b00-9f1b-d0b10ccceb13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118aec270>]}
[0m08:24:37.635332 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m08:24:37.677267 [debug] [MainThread]: checksum: e63134dccc1251cfb572caf0e4aa952f030c125ee3634f3bf2c0a2e1bb6ae349, vars: {}, profile: , target: , version: 1.11.0b3
[0m08:24:37.737673 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:24:37.737818 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:24:37.755432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3df191fa-2482-4b00-9f1b-d0b10ccceb13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118feed50>]}
[0m08:24:37.791200 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/target/manifest.json
[0m08:24:37.791943 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/target/semantic_manifest.json
[0m08:24:37.797339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3df191fa-2482-4b00-9f1b-d0b10ccceb13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118a99400>]}
[0m08:24:37.797507 [info ] [MainThread]: Found 3 models, 11 data tests, 2 sources, 492 macros
[0m08:24:37.797627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3df191fa-2482-4b00-9f1b-d0b10ccceb13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a231550>]}
[0m08:24:37.798209 [info ] [MainThread]: 
[0m08:24:37.798331 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:24:37.798421 [info ] [MainThread]: 
[0m08:24:37.798596 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:24:37.798901 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_OSTRICH'
[0m08:24:37.821996 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_OSTRICH"
[0m08:24:37.822153 [debug] [ThreadPool]: On list_USER_DB_OSTRICH: show terse schemas in database USER_DB_OSTRICH
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_OSTRICH"} */
[0m08:24:37.822248 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:24:40.524120 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 2.702 seconds
[0m08:24:40.534629 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_OSTRICH, now list_USER_DB_OSTRICH_PUBLIC_ANALYTICS)
[0m08:24:40.549216 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_OSTRICH_PUBLIC_ANALYTICS"
[0m08:24:40.549643 [debug] [ThreadPool]: On list_USER_DB_OSTRICH_PUBLIC_ANALYTICS: show objects in USER_DB_OSTRICH.PUBLIC_ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_OSTRICH_PUBLIC_ANALYTICS"} */;
[0m08:24:40.715257 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.165 seconds
[0m08:24:40.718925 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_OSTRICH_PUBLIC_ANALYTICS, now list_USER_DB_OSTRICH_PUBLIC_STAGING)
[0m08:24:40.722306 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_OSTRICH_PUBLIC_STAGING"
[0m08:24:40.722745 [debug] [ThreadPool]: On list_USER_DB_OSTRICH_PUBLIC_STAGING: show objects in USER_DB_OSTRICH.PUBLIC_STAGING
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_OSTRICH_PUBLIC_STAGING"} */;
[0m08:24:41.023152 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.300 seconds
[0m08:24:41.026968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3df191fa-2482-4b00-9f1b-d0b10ccceb13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d0d9300>]}
[0m08:24:41.032735 [debug] [Thread-1 (]: Began running node model.stock_analytics.mart_stock_analysis
[0m08:24:41.033407 [info ] [Thread-1 (]: 1 of 1 START sql table model PUBLIC_ANALYTICS.mart_stock_analysis .............. [RUN]
[0m08:24:41.033916 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_OSTRICH_PUBLIC_STAGING, now model.stock_analytics.mart_stock_analysis)
[0m08:24:41.034272 [debug] [Thread-1 (]: Began compiling node model.stock_analytics.mart_stock_analysis
[0m08:24:41.043211 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_analytics.mart_stock_analysis"
[0m08:24:41.044217 [debug] [Thread-1 (]: Began executing node model.stock_analytics.mart_stock_analysis
[0m08:24:41.065198 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_analytics.mart_stock_analysis"
[0m08:24:41.066222 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.mart_stock_analysis"
[0m08:24:41.066449 [debug] [Thread-1 (]: On model.stock_analytics.mart_stock_analysis: create or replace transient table USER_DB_OSTRICH.PUBLIC_ANALYTICS.mart_stock_analysis
    
    
    
    as (

-- Historical slice
with hist as (
  select
    symbol,
    date,
    close                  as actual_price,
    cast(null as float)    as forecast_price,
    cast(null as float)    as lower_bound,
    cast(null as float)    as upper_bound,
    'historical'           as record_type,
    -- pk carried at the mart level too
    concat(symbol, '|', to_varchar(date)) as pk_symbol_date
  from USER_DB_OSTRICH.PUBLIC_STAGING.stg_market_data
),

-- Forecast slice (already filtered to future in staging)
fut as (
  select
    symbol,
    date,
    cast(null as float)    as actual_price,
    forecast               as forecast_price,
    lower_bound,
    upper_bound,
    'forecast'             as record_type,
    concat(symbol, '|', to_varchar(date)) as pk_symbol_date
  from USER_DB_OSTRICH.PUBLIC_STAGING.stg_market_forecast
),

-- Optional guard to ensure no overlap; if you want stricter boundary, join to max(hist) per symbol.
unioned as (
  select * from hist
  union all
  select * from fut
)

select *
from (
  select
    *,
    row_number() over (
      partition by symbol, date, record_type
      order by date desc
    ) as rn
  from unioned
)
where rn = 1
    )

/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.mart_stock_analysis"} */;
[0m08:24:42.865716 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.799 seconds
[0m08:24:42.893744 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3df191fa-2482-4b00-9f1b-d0b10ccceb13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d580290>]}
[0m08:24:42.894388 [info ] [Thread-1 (]: 1 of 1 OK created sql table model PUBLIC_ANALYTICS.mart_stock_analysis ......... [[32mSUCCESS 1[0m in 1.86s]
[0m08:24:42.894836 [debug] [Thread-1 (]: Finished running node model.stock_analytics.mart_stock_analysis
[0m08:24:42.896060 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:24:42.896354 [debug] [MainThread]: Connection 'model.stock_analytics.mart_stock_analysis' was left open.
[0m08:24:42.896575 [debug] [MainThread]: On model.stock_analytics.mart_stock_analysis: Close
[0m08:24:43.037387 [info ] [MainThread]: 
[0m08:24:43.038122 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.24 seconds (5.24s).
[0m08:24:43.039648 [debug] [MainThread]: Command end result
[0m08:24:43.075299 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/target/manifest.json
[0m08:24:43.076530 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/target/semantic_manifest.json
[0m08:24:43.080069 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/target/run_results.json
[0m08:24:43.080231 [info ] [MainThread]: 
[0m08:24:43.080420 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:24:43.080555 [info ] [MainThread]: 
[0m08:24:43.080715 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m08:24:43.085169 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.9120603, "process_in_blocks": "0", "process_kernel_time": 0.241234, "process_mem_max_rss": "243810304", "process_out_blocks": "0", "process_user_time": 1.321476}
[0m08:24:43.085408 [debug] [MainThread]: Command `dbt run` succeeded at 08:24:43.085357 after 5.91 seconds
[0m08:24:43.085606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d4f1910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d4176b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d4153b0>]}
[0m08:24:43.085773 [debug] [MainThread]: Flushing usage events
[0m08:24:43.390921 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:25:01.302136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110493e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11343bb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11343bd90>]}


============================== 08:25:01.304171 | 4f824643-effb-45e5-a54a-6bf2ff6c5ee4 ==============================
[0m08:25:01.304171 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m08:25:01.304431 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'cache_selected_only': 'False', 'introspect': 'True', 'debug': 'False', 'use_colors': 'True', 'empty': 'None', 'profiles_dir': '/Users/rahulmohandevi/.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'target_path': 'None', 'log_format': 'default', 'use_experimental_parser': 'False', 'version_check': 'True', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'printer_width': '80', 'no_print': 'None', 'warn_error': 'None', 'invocation_command': 'dbt test -s stg_market_data stg_market_forecast mart_stock_analysis', 'log_path': '/Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/logs', 'write_json': 'True', 'quiet': 'False'}
[0m08:25:01.725869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4f824643-effb-45e5-a54a-6bf2ff6c5ee4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e3c510>]}
[0m08:25:01.747916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4f824643-effb-45e5-a54a-6bf2ff6c5ee4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1257ec270>]}
[0m08:25:01.748215 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m08:25:01.791258 [debug] [MainThread]: checksum: e63134dccc1251cfb572caf0e4aa952f030c125ee3634f3bf2c0a2e1bb6ae349, vars: {}, profile: , target: , version: 1.11.0b3
[0m08:25:01.849967 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:25:01.850112 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:25:01.867731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4f824643-effb-45e5-a54a-6bf2ff6c5ee4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125d06c50>]}
[0m08:25:01.903149 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/target/manifest.json
[0m08:25:01.903917 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/target/semantic_manifest.json
[0m08:25:01.914701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4f824643-effb-45e5-a54a-6bf2ff6c5ee4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125fa24e0>]}
[0m08:25:01.914880 [info ] [MainThread]: Found 3 models, 11 data tests, 2 sources, 492 macros
[0m08:25:01.915001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f824643-effb-45e5-a54a-6bf2ff6c5ee4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1260197f0>]}
[0m08:25:01.915766 [info ] [MainThread]: 
[0m08:25:01.915889 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:25:01.915978 [info ] [MainThread]: 
[0m08:25:01.916154 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:25:01.917725 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_OSTRICH_PUBLIC_ANALYTICS'
[0m08:25:01.941539 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_OSTRICH_PUBLIC_ANALYTICS"
[0m08:25:01.941668 [debug] [ThreadPool]: On list_USER_DB_OSTRICH_PUBLIC_ANALYTICS: show objects in USER_DB_OSTRICH.PUBLIC_ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_OSTRICH_PUBLIC_ANALYTICS"} */;
[0m08:25:01.941761 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:25:02.495113 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.553 seconds
[0m08:25:02.497945 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_OSTRICH_PUBLIC_ANALYTICS, now list_USER_DB_OSTRICH_PUBLIC_STAGING)
[0m08:25:02.501523 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_OSTRICH_PUBLIC_STAGING"
[0m08:25:02.501894 [debug] [ThreadPool]: On list_USER_DB_OSTRICH_PUBLIC_STAGING: show objects in USER_DB_OSTRICH.PUBLIC_STAGING
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_OSTRICH_PUBLIC_STAGING"} */;
[0m08:25:02.603696 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.101 seconds
[0m08:25:02.608397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f824643-effb-45e5-a54a-6bf2ff6c5ee4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1262865b0>]}
[0m08:25:02.613552 [debug] [Thread-1 (]: Began running node test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316
[0m08:25:02.614196 [info ] [Thread-1 (]: 1 of 11 START test accepted_values_mart_stock_analysis_record_type__historical__forecast  [RUN]
[0m08:25:02.614753 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_OSTRICH_PUBLIC_STAGING, now test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316)
[0m08:25:02.615124 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316
[0m08:25:02.625787 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316"
[0m08:25:02.626571 [debug] [Thread-1 (]: Began executing node test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316
[0m08:25:02.641655 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316"
[0m08:25:02.642356 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316"
[0m08:25:02.642556 [debug] [Thread-1 (]: On test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        record_type as value_field,
        count(*) as n_records

    from USER_DB_OSTRICH.PUBLIC_ANALYTICS.mart_stock_analysis
    group by record_type

)

select *
from all_values
where value_field not in (
    'historical','forecast'
)



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316"} */
[0m08:25:03.318414 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.675 seconds
[0m08:25:03.330522 [info ] [Thread-1 (]: 1 of 11 PASS accepted_values_mart_stock_analysis_record_type__historical__forecast  [[32mPASS[0m in 0.72s]
[0m08:25:03.331119 [debug] [Thread-1 (]: Finished running node test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316
[0m08:25:03.331414 [debug] [Thread-1 (]: Began running node test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5
[0m08:25:03.331758 [info ] [Thread-1 (]: 2 of 11 START test not_null_mart_stock_analysis_date ........................... [RUN]
[0m08:25:03.332126 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316, now test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5)
[0m08:25:03.332377 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5
[0m08:25:03.345739 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5"
[0m08:25:03.346241 [debug] [Thread-1 (]: Began executing node test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5
[0m08:25:03.347401 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5"
[0m08:25:03.347900 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5"
[0m08:25:03.348074 [debug] [Thread-1 (]: On test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date
from USER_DB_OSTRICH.PUBLIC_ANALYTICS.mart_stock_analysis
where date is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5"} */
[0m08:25:03.756859 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.408 seconds
[0m08:25:03.760612 [info ] [Thread-1 (]: 2 of 11 PASS not_null_mart_stock_analysis_date ................................. [[32mPASS[0m in 0.43s]
[0m08:25:03.761379 [debug] [Thread-1 (]: Finished running node test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5
[0m08:25:03.761757 [debug] [Thread-1 (]: Began running node test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e
[0m08:25:03.762163 [info ] [Thread-1 (]: 3 of 11 START test not_null_mart_stock_analysis_symbol ......................... [RUN]
[0m08:25:03.762587 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5, now test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e)
[0m08:25:03.762905 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e
[0m08:25:03.766770 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e"
[0m08:25:03.767396 [debug] [Thread-1 (]: Began executing node test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e
[0m08:25:03.769153 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e"
[0m08:25:03.769923 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e"
[0m08:25:03.770209 [debug] [Thread-1 (]: On test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select symbol
from USER_DB_OSTRICH.PUBLIC_ANALYTICS.mart_stock_analysis
where symbol is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e"} */
[0m08:25:04.164353 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.394 seconds
[0m08:25:04.167320 [info ] [Thread-1 (]: 3 of 11 PASS not_null_mart_stock_analysis_symbol ............................... [[32mPASS[0m in 0.40s]
[0m08:25:04.168012 [debug] [Thread-1 (]: Finished running node test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e
[0m08:25:04.168441 [debug] [Thread-1 (]: Began running node test.stock_analytics.not_null_stg_market_data_date.fb73c94489
[0m08:25:04.168930 [info ] [Thread-1 (]: 4 of 11 START test not_null_stg_market_data_date ............................... [RUN]
[0m08:25:04.169441 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e, now test.stock_analytics.not_null_stg_market_data_date.fb73c94489)
[0m08:25:04.169835 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.not_null_stg_market_data_date.fb73c94489
[0m08:25:04.174665 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.not_null_stg_market_data_date.fb73c94489"
[0m08:25:04.176381 [debug] [Thread-1 (]: Began executing node test.stock_analytics.not_null_stg_market_data_date.fb73c94489
[0m08:25:04.179728 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.not_null_stg_market_data_date.fb73c94489"
[0m08:25:04.180631 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_stg_market_data_date.fb73c94489"
[0m08:25:04.180895 [debug] [Thread-1 (]: On test.stock_analytics.not_null_stg_market_data_date.fb73c94489: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date
from USER_DB_OSTRICH.PUBLIC_STAGING.stg_market_data
where date is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stg_market_data_date.fb73c94489"} */
[0m08:25:04.676288 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.495 seconds
[0m08:25:04.679970 [info ] [Thread-1 (]: 4 of 11 PASS not_null_stg_market_data_date ..................................... [[32mPASS[0m in 0.51s]
[0m08:25:04.680816 [debug] [Thread-1 (]: Finished running node test.stock_analytics.not_null_stg_market_data_date.fb73c94489
[0m08:25:04.681329 [debug] [Thread-1 (]: Began running node test.stock_analytics.not_null_stg_market_data_symbol.478198cf66
[0m08:25:04.681841 [info ] [Thread-1 (]: 5 of 11 START test not_null_stg_market_data_symbol ............................. [RUN]
[0m08:25:04.682440 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_stg_market_data_date.fb73c94489, now test.stock_analytics.not_null_stg_market_data_symbol.478198cf66)
[0m08:25:04.682878 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.not_null_stg_market_data_symbol.478198cf66
[0m08:25:04.687905 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.not_null_stg_market_data_symbol.478198cf66"
[0m08:25:04.689182 [debug] [Thread-1 (]: Began executing node test.stock_analytics.not_null_stg_market_data_symbol.478198cf66
[0m08:25:04.692384 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.not_null_stg_market_data_symbol.478198cf66"
[0m08:25:04.693712 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_stg_market_data_symbol.478198cf66"
[0m08:25:04.694104 [debug] [Thread-1 (]: On test.stock_analytics.not_null_stg_market_data_symbol.478198cf66: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select symbol
from USER_DB_OSTRICH.PUBLIC_STAGING.stg_market_data
where symbol is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stg_market_data_symbol.478198cf66"} */
[0m08:25:05.597753 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.903 seconds
[0m08:25:05.601105 [info ] [Thread-1 (]: 5 of 11 PASS not_null_stg_market_data_symbol ................................... [[32mPASS[0m in 0.92s]
[0m08:25:05.601777 [debug] [Thread-1 (]: Finished running node test.stock_analytics.not_null_stg_market_data_symbol.478198cf66
[0m08:25:05.602205 [debug] [Thread-1 (]: Began running node test.stock_analytics.not_null_stg_market_forecast_date.ca0f3ba00f
[0m08:25:05.602647 [info ] [Thread-1 (]: 6 of 11 START test not_null_stg_market_forecast_date ........................... [RUN]
[0m08:25:05.603133 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_stg_market_data_symbol.478198cf66, now test.stock_analytics.not_null_stg_market_forecast_date.ca0f3ba00f)
[0m08:25:05.603499 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.not_null_stg_market_forecast_date.ca0f3ba00f
[0m08:25:05.608351 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.not_null_stg_market_forecast_date.ca0f3ba00f"
[0m08:25:05.609665 [debug] [Thread-1 (]: Began executing node test.stock_analytics.not_null_stg_market_forecast_date.ca0f3ba00f
[0m08:25:05.612548 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.not_null_stg_market_forecast_date.ca0f3ba00f"
[0m08:25:05.613827 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_stg_market_forecast_date.ca0f3ba00f"
[0m08:25:05.614192 [debug] [Thread-1 (]: On test.stock_analytics.not_null_stg_market_forecast_date.ca0f3ba00f: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date
from USER_DB_OSTRICH.PUBLIC_STAGING.stg_market_forecast
where date is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stg_market_forecast_date.ca0f3ba00f"} */
[0m08:25:06.416762 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.802 seconds
[0m08:25:06.420655 [info ] [Thread-1 (]: 6 of 11 PASS not_null_stg_market_forecast_date ................................. [[32mPASS[0m in 0.82s]
[0m08:25:06.421486 [debug] [Thread-1 (]: Finished running node test.stock_analytics.not_null_stg_market_forecast_date.ca0f3ba00f
[0m08:25:06.421959 [debug] [Thread-1 (]: Began running node test.stock_analytics.not_null_stg_market_forecast_symbol.d304415e8d
[0m08:25:06.422369 [info ] [Thread-1 (]: 7 of 11 START test not_null_stg_market_forecast_symbol ......................... [RUN]
[0m08:25:06.422848 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_stg_market_forecast_date.ca0f3ba00f, now test.stock_analytics.not_null_stg_market_forecast_symbol.d304415e8d)
[0m08:25:06.423358 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.not_null_stg_market_forecast_symbol.d304415e8d
[0m08:25:06.427407 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.not_null_stg_market_forecast_symbol.d304415e8d"
[0m08:25:06.428234 [debug] [Thread-1 (]: Began executing node test.stock_analytics.not_null_stg_market_forecast_symbol.d304415e8d
[0m08:25:06.430160 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.not_null_stg_market_forecast_symbol.d304415e8d"
[0m08:25:06.431019 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_stg_market_forecast_symbol.d304415e8d"
[0m08:25:06.431264 [debug] [Thread-1 (]: On test.stock_analytics.not_null_stg_market_forecast_symbol.d304415e8d: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select symbol
from USER_DB_OSTRICH.PUBLIC_STAGING.stg_market_forecast
where symbol is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_stg_market_forecast_symbol.d304415e8d"} */
[0m08:25:07.359920 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.928 seconds
[0m08:25:07.366040 [info ] [Thread-1 (]: 7 of 11 PASS not_null_stg_market_forecast_symbol ............................... [[32mPASS[0m in 0.94s]
[0m08:25:07.366986 [debug] [Thread-1 (]: Finished running node test.stock_analytics.not_null_stg_market_forecast_symbol.d304415e8d
[0m08:25:07.367272 [debug] [Thread-1 (]: Began running node test.stock_analytics.test_forecast_dates_future
[0m08:25:07.367610 [info ] [Thread-1 (]: 8 of 11 START test test_forecast_dates_future .................................. [RUN]
[0m08:25:07.368019 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_stg_market_forecast_symbol.d304415e8d, now test.stock_analytics.test_forecast_dates_future)
[0m08:25:07.368284 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.test_forecast_dates_future
[0m08:25:07.370619 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.test_forecast_dates_future"
[0m08:25:07.371285 [debug] [Thread-1 (]: Began executing node test.stock_analytics.test_forecast_dates_future
[0m08:25:07.372673 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.test_forecast_dates_future"
[0m08:25:07.373464 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.test_forecast_dates_future"
[0m08:25:07.373689 [debug] [Thread-1 (]: On test.stock_analytics.test_forecast_dates_future: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  with max_hist as (
  select symbol, max(date) as max_hist_date
  from USER_DB_OSTRICH.PUBLIC_STAGING.stg_market_data
  group by 1
)
select f.symbol, f.date
from USER_DB_OSTRICH.PUBLIC_ANALYTICS.mart_stock_analysis f
join max_hist m using (symbol)
where f.record_type = 'forecast'
  and f.date <= m.max_hist_date
  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.test_forecast_dates_future"} */
[0m08:25:08.158485 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.784 seconds
[0m08:25:08.162183 [info ] [Thread-1 (]: 8 of 11 PASS test_forecast_dates_future ........................................ [[32mPASS[0m in 0.79s]
[0m08:25:08.162862 [debug] [Thread-1 (]: Finished running node test.stock_analytics.test_forecast_dates_future
[0m08:25:08.163268 [debug] [Thread-1 (]: Began running node test.stock_analytics.unique_mart_stock_analysis_pk_symbol_date.2ccccb8eaa
[0m08:25:08.163669 [info ] [Thread-1 (]: 9 of 11 START test unique_mart_stock_analysis_pk_symbol_date ................... [RUN]
[0m08:25:08.164133 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.test_forecast_dates_future, now test.stock_analytics.unique_mart_stock_analysis_pk_symbol_date.2ccccb8eaa)
[0m08:25:08.164469 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.unique_mart_stock_analysis_pk_symbol_date.2ccccb8eaa
[0m08:25:08.171252 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.unique_mart_stock_analysis_pk_symbol_date.2ccccb8eaa"
[0m08:25:08.172025 [debug] [Thread-1 (]: Began executing node test.stock_analytics.unique_mart_stock_analysis_pk_symbol_date.2ccccb8eaa
[0m08:25:08.173860 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.unique_mart_stock_analysis_pk_symbol_date.2ccccb8eaa"
[0m08:25:08.174733 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.unique_mart_stock_analysis_pk_symbol_date.2ccccb8eaa"
[0m08:25:08.174985 [debug] [Thread-1 (]: On test.stock_analytics.unique_mart_stock_analysis_pk_symbol_date.2ccccb8eaa: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    pk_symbol_date as unique_field,
    count(*) as n_records

from USER_DB_OSTRICH.PUBLIC_ANALYTICS.mart_stock_analysis
where pk_symbol_date is not null
group by pk_symbol_date
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.unique_mart_stock_analysis_pk_symbol_date.2ccccb8eaa"} */
[0m08:25:08.777150 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.602 seconds
[0m08:25:08.780704 [info ] [Thread-1 (]: 9 of 11 PASS unique_mart_stock_analysis_pk_symbol_date ......................... [[32mPASS[0m in 0.62s]
[0m08:25:08.781429 [debug] [Thread-1 (]: Finished running node test.stock_analytics.unique_mart_stock_analysis_pk_symbol_date.2ccccb8eaa
[0m08:25:08.781822 [debug] [Thread-1 (]: Began running node test.stock_analytics.unique_stg_market_data_pk_symbol_date.2341399852
[0m08:25:08.782258 [info ] [Thread-1 (]: 10 of 11 START test unique_stg_market_data_pk_symbol_date ...................... [RUN]
[0m08:25:08.782742 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.unique_mart_stock_analysis_pk_symbol_date.2ccccb8eaa, now test.stock_analytics.unique_stg_market_data_pk_symbol_date.2341399852)
[0m08:25:08.783109 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.unique_stg_market_data_pk_symbol_date.2341399852
[0m08:25:08.787881 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.unique_stg_market_data_pk_symbol_date.2341399852"
[0m08:25:08.788746 [debug] [Thread-1 (]: Began executing node test.stock_analytics.unique_stg_market_data_pk_symbol_date.2341399852
[0m08:25:08.790887 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.unique_stg_market_data_pk_symbol_date.2341399852"
[0m08:25:08.791932 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.unique_stg_market_data_pk_symbol_date.2341399852"
[0m08:25:08.792245 [debug] [Thread-1 (]: On test.stock_analytics.unique_stg_market_data_pk_symbol_date.2341399852: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    pk_symbol_date as unique_field,
    count(*) as n_records

from USER_DB_OSTRICH.PUBLIC_STAGING.stg_market_data
where pk_symbol_date is not null
group by pk_symbol_date
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.unique_stg_market_data_pk_symbol_date.2341399852"} */
[0m08:25:09.087504 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.295 seconds
[0m08:25:09.090725 [info ] [Thread-1 (]: 10 of 11 PASS unique_stg_market_data_pk_symbol_date ............................ [[32mPASS[0m in 0.31s]
[0m08:25:09.091475 [debug] [Thread-1 (]: Finished running node test.stock_analytics.unique_stg_market_data_pk_symbol_date.2341399852
[0m08:25:09.091945 [debug] [Thread-1 (]: Began running node test.stock_analytics.unique_stg_market_forecast_pk_symbol_date.21a5b606c9
[0m08:25:09.092419 [info ] [Thread-1 (]: 11 of 11 START test unique_stg_market_forecast_pk_symbol_date .................. [RUN]
[0m08:25:09.093010 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.unique_stg_market_data_pk_symbol_date.2341399852, now test.stock_analytics.unique_stg_market_forecast_pk_symbol_date.21a5b606c9)
[0m08:25:09.093409 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.unique_stg_market_forecast_pk_symbol_date.21a5b606c9
[0m08:25:09.099223 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.unique_stg_market_forecast_pk_symbol_date.21a5b606c9"
[0m08:25:09.100303 [debug] [Thread-1 (]: Began executing node test.stock_analytics.unique_stg_market_forecast_pk_symbol_date.21a5b606c9
[0m08:25:09.102691 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.unique_stg_market_forecast_pk_symbol_date.21a5b606c9"
[0m08:25:09.103700 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.unique_stg_market_forecast_pk_symbol_date.21a5b606c9"
[0m08:25:09.104014 [debug] [Thread-1 (]: On test.stock_analytics.unique_stg_market_forecast_pk_symbol_date.21a5b606c9: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    pk_symbol_date as unique_field,
    count(*) as n_records

from USER_DB_OSTRICH.PUBLIC_STAGING.stg_market_forecast
where pk_symbol_date is not null
group by pk_symbol_date
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.unique_stg_market_forecast_pk_symbol_date.21a5b606c9"} */
[0m08:25:09.460393 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.356 seconds
[0m08:25:09.463308 [info ] [Thread-1 (]: 11 of 11 PASS unique_stg_market_forecast_pk_symbol_date ........................ [[32mPASS[0m in 0.37s]
[0m08:25:09.463981 [debug] [Thread-1 (]: Finished running node test.stock_analytics.unique_stg_market_forecast_pk_symbol_date.21a5b606c9
[0m08:25:09.465497 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:25:09.465852 [debug] [MainThread]: Connection 'test.stock_analytics.unique_stg_market_forecast_pk_symbol_date.21a5b606c9' was left open.
[0m08:25:09.466172 [debug] [MainThread]: On test.stock_analytics.unique_stg_market_forecast_pk_symbol_date.21a5b606c9: Close
[0m08:25:09.577049 [info ] [MainThread]: 
[0m08:25:09.577653 [info ] [MainThread]: Finished running 11 data tests in 0 hours 0 minutes and 7.66 seconds (7.66s).
[0m08:25:09.580016 [debug] [MainThread]: Command end result
[0m08:25:09.600903 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/target/manifest.json
[0m08:25:09.602485 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/target/semantic_manifest.json
[0m08:25:09.607741 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/target/run_results.json
[0m08:25:09.607940 [info ] [MainThread]: 
[0m08:25:09.608157 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:25:09.608322 [info ] [MainThread]: 
[0m08:25:09.608502 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=11
[0m08:25:09.612413 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 8.338568, "process_in_blocks": "0", "process_kernel_time": 0.240489, "process_mem_max_rss": "244236288", "process_out_blocks": "0", "process_user_time": 1.424438}
[0m08:25:09.612650 [debug] [MainThread]: Command `dbt test` succeeded at 08:25:09.612598 after 8.34 seconds
[0m08:25:09.612863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c425d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127135440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127134890>]}
[0m08:25:09.613062 [debug] [MainThread]: Flushing usage events
[0m08:25:09.975439 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:29:54.845902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122893e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124513b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124513d90>]}


============================== 08:29:54.848465 | fd46da19-bd3b-48d6-9127-ffd60d9d9760 ==============================
[0m08:29:54.848465 [info ] [MainThread]: Running with dbt=1.11.0-b3
[0m08:29:54.848742 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'invocation_command': 'dbt test -s tests/test_forecast_dates_future.sql', 'log_cache_events': 'False', 'warn_error': 'None', 'no_print': 'None', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'use_colors': 'True', 'debug': 'False', 'fail_fast': 'False', 'printer_width': '80', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'introspect': 'True', 'log_path': '/Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/logs', 'profiles_dir': '/Users/rahulmohandevi/.dbt', 'empty': 'None', 'cache_selected_only': 'False', 'version_check': 'True', 'use_experimental_parser': 'False'}
[0m08:29:55.537291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fd46da19-bd3b-48d6-9127-ffd60d9d9760', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122f3c510>]}
[0m08:29:55.558893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fd46da19-bd3b-48d6-9127-ffd60d9d9760', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13690c270>]}
[0m08:29:55.559372 [info ] [MainThread]: Registered adapter: snowflake=1.10.2
[0m08:29:55.606541 [debug] [MainThread]: checksum: e63134dccc1251cfb572caf0e4aa952f030c125ee3634f3bf2c0a2e1bb6ae349, vars: {}, profile: , target: , version: 1.11.0b3
[0m08:29:55.674164 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:29:55.674422 [debug] [MainThread]: Partial parsing: updated file: stock_analytics://tests/test_forecast_dates_future.sql
[0m08:29:55.744161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fd46da19-bd3b-48d6-9127-ffd60d9d9760', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136cff850>]}
[0m08:29:55.779501 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/target/manifest.json
[0m08:29:55.780606 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/target/semantic_manifest.json
[0m08:29:55.794870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fd46da19-bd3b-48d6-9127-ffd60d9d9760', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13733be30>]}
[0m08:29:55.795059 [info ] [MainThread]: Found 3 models, 11 data tests, 2 sources, 492 macros
[0m08:29:55.795184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd46da19-bd3b-48d6-9127-ffd60d9d9760', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1373a6430>]}
[0m08:29:55.795982 [info ] [MainThread]: 
[0m08:29:55.796110 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:29:55.796204 [info ] [MainThread]: 
[0m08:29:55.796383 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:29:55.798014 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_OSTRICH_PUBLIC_ANALYTICS'
[0m08:29:55.856404 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_OSTRICH_PUBLIC_ANALYTICS"
[0m08:29:55.856575 [debug] [ThreadPool]: On list_USER_DB_OSTRICH_PUBLIC_ANALYTICS: show objects in USER_DB_OSTRICH.PUBLIC_ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_OSTRICH_PUBLIC_ANALYTICS"} */;
[0m08:29:55.856670 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:29:59.689803 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 3.833 seconds
[0m08:29:59.694859 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_OSTRICH_PUBLIC_ANALYTICS, now list_USER_DB_OSTRICH_PUBLIC_STAGING)
[0m08:29:59.697605 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_OSTRICH_PUBLIC_STAGING"
[0m08:29:59.697913 [debug] [ThreadPool]: On list_USER_DB_OSTRICH_PUBLIC_STAGING: show objects in USER_DB_OSTRICH.PUBLIC_STAGING
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_OSTRICH_PUBLIC_STAGING"} */;
[0m08:29:59.893650 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.195 seconds
[0m08:29:59.898160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd46da19-bd3b-48d6-9127-ffd60d9d9760', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1370df6c0>]}
[0m08:29:59.904099 [debug] [Thread-1 (]: Began running node test.stock_analytics.test_forecast_dates_future
[0m08:29:59.904694 [info ] [Thread-1 (]: 1 of 1 START test test_forecast_dates_future ................................... [RUN]
[0m08:29:59.905314 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_OSTRICH_PUBLIC_STAGING, now test.stock_analytics.test_forecast_dates_future)
[0m08:29:59.905884 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.test_forecast_dates_future
[0m08:29:59.913680 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.test_forecast_dates_future"
[0m08:29:59.914777 [debug] [Thread-1 (]: Began executing node test.stock_analytics.test_forecast_dates_future
[0m08:29:59.932371 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.test_forecast_dates_future"
[0m08:29:59.933328 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.test_forecast_dates_future"
[0m08:29:59.933557 [debug] [Thread-1 (]: On test.stock_analytics.test_forecast_dates_future: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- Fail if any forecast date is not strictly after the latest historical date for that symbol.
with max_hist as (
  select symbol, max(date) as max_hist_date
  from USER_DB_OSTRICH.PUBLIC_ANALYTICS.mart_stock_analysis
  where record_type = 'historical'
  group by 1
)

select f.symbol, f.date, f.record_type, f.forecast_price, m.max_hist_date
from USER_DB_OSTRICH.PUBLIC_ANALYTICS.mart_stock_analysis f
join max_hist m using (symbol)
where f.record_type = 'forecast'
  and f.date <= m.max_hist_date
  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.0b3", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.test_forecast_dates_future"} */
[0m08:30:00.124848 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.191 seconds
[0m08:30:00.136603 [info ] [Thread-1 (]: 1 of 1 PASS test_forecast_dates_future ......................................... [[32mPASS[0m in 0.23s]
[0m08:30:00.137536 [debug] [Thread-1 (]: Finished running node test.stock_analytics.test_forecast_dates_future
[0m08:30:00.139320 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:30:00.139652 [debug] [MainThread]: Connection 'test.stock_analytics.test_forecast_dates_future' was left open.
[0m08:30:00.139945 [debug] [MainThread]: On test.stock_analytics.test_forecast_dates_future: Close
[0m08:30:00.261804 [info ] [MainThread]: 
[0m08:30:00.262516 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 4.47 seconds (4.47s).
[0m08:30:00.263395 [debug] [MainThread]: Command end result
[0m08:30:00.283075 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/target/manifest.json
[0m08:30:00.284447 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/target/semantic_manifest.json
[0m08:30:00.289382 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rahulmohandevi/Desktop/Knowledge/DAT_226/Lab_2/dbt/stock_analytics/target/run_results.json
[0m08:30:00.289564 [info ] [MainThread]: 
[0m08:30:00.289774 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:30:00.289915 [info ] [MainThread]: 
[0m08:30:00.290095 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m08:30:00.295291 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 5.4778523, "process_in_blocks": "0", "process_kernel_time": 0.290062, "process_mem_max_rss": "246480896", "process_out_blocks": "0", "process_user_time": 1.335059}
[0m08:30:00.295558 [debug] [MainThread]: Command `dbt test` succeeded at 08:30:00.295503 after 5.48 seconds
[0m08:30:00.295768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12431e5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x148a98e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x148a98aa0>]}
[0m08:30:00.295958 [debug] [MainThread]: Flushing usage events
[0m08:30:00.646412 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:29:09.895333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0ef0a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9fa1bf20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f4d7fe0>]}


============================== 23:29:09.898906 | 5b2cd6b6-1450-430d-9438-ab01b594212d ==============================
[0m23:29:09.898906 [info ] [MainThread]: Running with dbt=1.11.0-rc1
[0m23:29:09.899419 [debug] [MainThread]: running dbt with arguments {'log_path': '/opt/airflow/dbt/stock_analytics/logs', 'quiet': 'False', 'cache_selected_only': 'False', 'warn_error': 'None', 'introspect': 'True', 'partial_parse': 'True', 'empty': 'None', 'use_colors': 'True', 'no_print': 'None', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'write_json': 'True', 'log_cache_events': 'False', 'log_format': 'default', 'debug': 'False', 'version_check': 'True', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'invocation_command': 'dbt debug --profiles-dir /opt/airflow/dbt'}
[0m23:29:09.903345 [info ] [MainThread]: dbt version: 1.11.0-rc1
[0m23:29:09.903593 [info ] [MainThread]: python version: 3.12.5
[0m23:29:09.903751 [info ] [MainThread]: python path: /opt/airflow/dbt_venv/bin/python3.12
[0m23:29:09.903920 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.36
[0m23:29:09.904098 [info ] [MainThread]: Using profiles dir at /opt/airflow/dbt
[0m23:29:09.904261 [info ] [MainThread]: Using profiles.yml file at /opt/airflow/dbt/profiles.yml
[0m23:29:09.904394 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/dbt/stock_analytics/dbt_project.yml
[0m23:29:09.943953 [info ] [MainThread]: Configuration:
[0m23:29:09.944259 [info ] [MainThread]:   profiles.yml file [[31mERROR not found[0m]
[0m23:29:09.944449 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m23:29:09.944653 [info ] [MainThread]: Required dependencies:
[0m23:29:09.944840 [debug] [MainThread]: Executing "git --help"
[0m23:29:09.947002 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m23:29:09.947275 [debug] [MainThread]: STDERR: "b''"
[0m23:29:09.947441 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m23:29:09.947627 [info ] [MainThread]: Connection test skipped since no profile was found
[0m23:29:09.947841 [info ] [MainThread]: [31m1 check failed:[0m
[0m23:29:09.948006 [info ] [MainThread]: dbt looked for a profiles.yml file in /opt/airflow/dbt/profiles.yml, but did
not find one. For more information on configuring your profile, consult the
documentation:

https://docs.getdbt.com/docs/configure-your-profile


[0m23:29:09.948546 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.0764455, "process_in_blocks": "296", "process_kernel_time": 0.092071, "process_mem_max_rss": "103320", "process_out_blocks": "10", "process_user_time": 0.887692}
[0m23:29:09.948830 [debug] [MainThread]: Command `dbt debug` failed at 23:29:09.948774 after 0.08 seconds
[0m23:29:09.949040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f4551f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9eebc230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ef8e180>]}
[0m23:29:09.949247 [debug] [MainThread]: Flushing usage events
[0m23:29:10.352824 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:34:11.696124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c9fc140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b812540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a814bf0>]}


============================== 23:34:11.699574 | 2651f9bc-7103-4c14-87aa-a1d82176fc2e ==============================
[0m23:34:11.699574 [info ] [MainThread]: Running with dbt=1.11.0-rc1
[0m23:34:11.699996 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'indirect_selection': 'eager', 'target_path': 'None', 'invocation_command': 'dbt debug --profiles-dir /opt/airflow/dbt', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'quiet': 'False', 'partial_parse': 'True', 'printer_width': '80', 'cache_selected_only': 'False', 'empty': 'None', 'log_path': '/opt/airflow/dbt/stock_analytics/logs', 'warn_error': 'None', 'use_experimental_parser': 'False', 'no_print': 'None', 'introspect': 'True', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'log_format': 'default', 'write_json': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:34:11.703748 [info ] [MainThread]: dbt version: 1.11.0-rc1
[0m23:34:11.703974 [info ] [MainThread]: python version: 3.12.5
[0m23:34:11.704121 [info ] [MainThread]: python path: /opt/airflow/dbt_venv/bin/python3.12
[0m23:34:11.704336 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.36
[0m23:34:11.800131 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m23:34:11.800472 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m23:34:11.800701 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m23:34:11.823578 [info ] [MainThread]: Using profiles dir at /opt/airflow/dbt
[0m23:34:11.823968 [info ] [MainThread]: Using profiles.yml file at /opt/airflow/dbt/profiles.yml
[0m23:34:11.824142 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/dbt/stock_analytics/dbt_project.yml
[0m23:34:11.824440 [info ] [MainThread]: adapter type: snowflake
[0m23:34:11.824600 [info ] [MainThread]: adapter version: 1.10.3
[0m23:34:11.863509 [info ] [MainThread]: Configuration:
[0m23:34:11.863770 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m23:34:11.863953 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m23:34:11.864152 [info ] [MainThread]: Required dependencies:
[0m23:34:11.864386 [debug] [MainThread]: Executing "git --help"
[0m23:34:11.865855 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m23:34:11.866046 [debug] [MainThread]: STDERR: "b''"
[0m23:34:11.866230 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m23:34:11.866451 [info ] [MainThread]: Connection:
[0m23:34:11.866667 [info ] [MainThread]:   account: sfedu02-lvb17920
[0m23:34:11.866830 [info ] [MainThread]:   user: OSTRICH
[0m23:34:11.867028 [info ] [MainThread]:   database: USER_DB_OSTRICH
[0m23:34:11.867203 [info ] [MainThread]:   warehouse: OSTRICH_QUERY_WH
[0m23:34:11.867399 [info ] [MainThread]:   role: TRAINING_ROLE
[0m23:34:11.867579 [info ] [MainThread]:   schema: PUBLIC
[0m23:34:11.867790 [info ] [MainThread]:   authenticator: None
[0m23:34:11.867968 [info ] [MainThread]:   oauth_client_id: None
[0m23:34:11.868160 [info ] [MainThread]:   query_tag: None
[0m23:34:11.868333 [info ] [MainThread]:   client_session_keep_alive: False
[0m23:34:11.868526 [info ] [MainThread]:   host: None
[0m23:34:11.868688 [info ] [MainThread]:   port: None
[0m23:34:11.868870 [info ] [MainThread]:   proxy_host: None
[0m23:34:11.869026 [info ] [MainThread]:   proxy_port: None
[0m23:34:11.869211 [info ] [MainThread]:   protocol: None
[0m23:34:11.869372 [info ] [MainThread]:   connect_retries: 1
[0m23:34:11.869559 [info ] [MainThread]:   connect_timeout: None
[0m23:34:11.869719 [info ] [MainThread]:   retry_on_database_errors: False
[0m23:34:11.869909 [info ] [MainThread]:   retry_all: False
[0m23:34:11.870071 [info ] [MainThread]:   insecure_mode: False
[0m23:34:11.870259 [info ] [MainThread]:   reuse_connections: True
[0m23:34:11.870426 [info ] [MainThread]:   s3_stage_vpce_dns_name: None
[0m23:34:11.870616 [info ] [MainThread]:   platform_detection_timeout_seconds: 0.0
[0m23:34:11.870850 [info ] [MainThread]: Registered adapter: snowflake=1.10.3
[0m23:34:11.903445 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m23:34:11.916370 [debug] [MainThread]: Using snowflake connection "debug"
[0m23:34:11.916619 [debug] [MainThread]: On debug: select 1 as id
[0m23:34:11.916788 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:34:12.447151 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.530 seconds
[0m23:34:12.447985 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m23:34:12.448474 [info ] [MainThread]: [32mAll checks passed![0m
[0m23:34:12.449291 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.77639776, "process_in_blocks": "0", "process_kernel_time": 0.120927, "process_mem_max_rss": "138280", "process_out_blocks": "2278", "process_user_time": 1.101336}
[0m23:34:12.449634 [debug] [MainThread]: Command `dbt debug` succeeded at 23:34:12.449576 after 0.78 seconds
[0m23:34:12.449896 [debug] [MainThread]: Connection 'debug' was left open.
[0m23:34:12.450171 [debug] [MainThread]: On debug: Close
[0m23:34:12.583936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a8810d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87f743b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a881370>]}
[0m23:34:12.584582 [debug] [MainThread]: Flushing usage events
[0m23:34:12.952583 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:34:13.975258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff929ee330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9216f2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9216e870>]}


============================== 23:34:13.978258 | 42c7ee9b-923d-4b64-9490-d002f6e5a8cf ==============================
[0m23:34:13.978258 [info ] [MainThread]: Running with dbt=1.11.0-rc1
[0m23:34:13.978700 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'invocation_command': 'dbt run -s mart_stock_analysis --profiles-dir /opt/airflow/dbt', 'indirect_selection': 'eager', 'target_path': 'None', 'log_cache_events': 'False', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'no_print': 'None', 'log_format': 'default', 'write_json': 'True', 'log_path': '/opt/airflow/dbt/stock_analytics/logs', 'cache_selected_only': 'False', 'introspect': 'True', 'fail_fast': 'False', 'debug': 'False', 'use_experimental_parser': 'False', 'profiles_dir': '/opt/airflow/dbt', 'partial_parse': 'True', 'printer_width': '80', 'empty': 'False', 'static_parser': 'True', 'quiet': 'False'}
[0m23:34:14.055560 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m23:34:14.055898 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m23:34:14.056106 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m23:34:14.125090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '42c7ee9b-923d-4b64-9490-d002f6e5a8cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9267ef00>]}
[0m23:34:14.147997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '42c7ee9b-923d-4b64-9490-d002f6e5a8cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90a059d0>]}
[0m23:34:14.148367 [info ] [MainThread]: Registered adapter: snowflake=1.10.3
[0m23:34:14.182440 [debug] [MainThread]: checksum: bdedcbc4566463a53095072aa091a5f5b73db413e58224228390aa7e9748abcc, vars: {}, profile: , target: , version: 1.11.0rc1
[0m23:34:14.225992 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m23:34:14.226430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '42c7ee9b-923d-4b64-9490-d002f6e5a8cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9053d940>]}
[0m23:34:14.704114 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'mart_stock_analysis' in package 'stock_analytics'
(models/marts/mart_stock_analysis.yml). Arguments to generic tests should be
nested under the `arguments` property.
[0m23:34:14.704604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '42c7ee9b-923d-4b64-9490-d002f6e5a8cf', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff907da180>]}
[0m23:34:14.792122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '42c7ee9b-923d-4b64-9490-d002f6e5a8cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f759bb0>]}
[0m23:34:14.834423 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/stock_analytics/target/manifest.json
[0m23:34:14.836033 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/stock_analytics/target/semantic_manifest.json
[0m23:34:14.849683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '42c7ee9b-923d-4b64-9490-d002f6e5a8cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f76e1b0>]}
[0m23:34:14.850640 [info ] [MainThread]: Found 3 models, 11 data tests, 2 sources, 504 macros
[0m23:34:14.851724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '42c7ee9b-923d-4b64-9490-d002f6e5a8cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff903368d0>]}
[0m23:34:14.853082 [info ] [MainThread]: 
[0m23:34:14.853779 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:34:14.854780 [info ] [MainThread]: 
[0m23:34:14.856559 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:34:14.861293 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_OSTRICH'
[0m23:34:14.895510 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_OSTRICH"
[0m23:34:14.897350 [debug] [ThreadPool]: On list_USER_DB_OSTRICH: show terse schemas in database USER_DB_OSTRICH
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.0rc1", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_OSTRICH"} */
[0m23:34:14.900044 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:34:15.541107 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.641 seconds
[0m23:34:15.550473 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_OSTRICH, now list_USER_DB_OSTRICH_PUBLIC_ANALYTICS)
[0m23:34:15.565791 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_OSTRICH_PUBLIC_ANALYTICS"
[0m23:34:15.566436 [debug] [ThreadPool]: On list_USER_DB_OSTRICH_PUBLIC_ANALYTICS: show objects in USER_DB_OSTRICH.PUBLIC_ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.0rc1", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_OSTRICH_PUBLIC_ANALYTICS"} */;
[0m23:34:15.713257 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.146 seconds
[0m23:34:15.715472 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_OSTRICH_PUBLIC_ANALYTICS, now list_USER_DB_OSTRICH_PUBLIC_STAGING)
[0m23:34:15.718422 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_OSTRICH_PUBLIC_STAGING"
[0m23:34:15.718810 [debug] [ThreadPool]: On list_USER_DB_OSTRICH_PUBLIC_STAGING: show objects in USER_DB_OSTRICH.PUBLIC_STAGING
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.0rc1", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_OSTRICH_PUBLIC_STAGING"} */;
[0m23:34:15.846541 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.127 seconds
[0m23:34:15.850373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '42c7ee9b-923d-4b64-9490-d002f6e5a8cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff926afcb0>]}
[0m23:34:15.857661 [debug] [Thread-1 (]: Began running node model.stock_analytics.mart_stock_analysis
[0m23:34:15.858313 [info ] [Thread-1 (]: 1 of 1 START sql table model PUBLIC_ANALYTICS.mart_stock_analysis .............. [RUN]
[0m23:34:15.859340 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_OSTRICH_PUBLIC_STAGING, now model.stock_analytics.mart_stock_analysis)
[0m23:34:15.859813 [debug] [Thread-1 (]: Began compiling node model.stock_analytics.mart_stock_analysis
[0m23:34:15.868240 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_analytics.mart_stock_analysis"
[0m23:34:15.870358 [debug] [Thread-1 (]: Began executing node model.stock_analytics.mart_stock_analysis
[0m23:34:15.889870 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_analytics.mart_stock_analysis"
[0m23:34:15.891904 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.mart_stock_analysis"
[0m23:34:15.892199 [debug] [Thread-1 (]: On model.stock_analytics.mart_stock_analysis: create or replace transient table USER_DB_OSTRICH.PUBLIC_ANALYTICS.mart_stock_analysis
    
    
    
    as (

-- Historical slice
with hist as (
  select
    symbol,
    date,
    close                  as actual_price,
    cast(null as float)    as forecast_price,
    cast(null as float)    as lower_bound,
    cast(null as float)    as upper_bound,
    'historical'           as record_type,
    -- pk carried at the mart level too
    concat(symbol, '|', to_varchar(date)) as pk_symbol_date
  from USER_DB_OSTRICH.PUBLIC_STAGING.stg_market_data
),

-- Forecast slice (already filtered to future in staging)
fut as (
  select
    symbol,
    date,
    cast(null as float)    as actual_price,
    forecast               as forecast_price,
    lower_bound,
    upper_bound,
    'forecast'             as record_type,
    concat(symbol, '|', to_varchar(date)) as pk_symbol_date
  from USER_DB_OSTRICH.PUBLIC_STAGING.stg_market_forecast
),

-- Optional guard to ensure no overlap; if you want stricter boundary, join to max(hist) per symbol.
unioned as (
  select * from hist
  union all
  select * from fut
)

select *
from (
  select
    *,
    row_number() over (
      partition by symbol, date, record_type
      order by date desc
    ) as rn
  from unioned
)
where rn = 1
    )

/* {"app": "dbt", "dbt_version": "1.11.0rc1", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.mart_stock_analysis"} */;
[0m23:34:17.640802 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.748 seconds
[0m23:34:17.668262 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42c7ee9b-923d-4b64-9490-d002f6e5a8cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f77a150>]}
[0m23:34:17.668768 [info ] [Thread-1 (]: 1 of 1 OK created sql table model PUBLIC_ANALYTICS.mart_stock_analysis ......... [[32mSUCCESS 1[0m in 1.81s]
[0m23:34:17.669347 [debug] [Thread-1 (]: Finished running node model.stock_analytics.mart_stock_analysis
[0m23:34:17.670153 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:34:17.670372 [debug] [MainThread]: Connection 'model.stock_analytics.mart_stock_analysis' was left open.
[0m23:34:17.670593 [debug] [MainThread]: On model.stock_analytics.mart_stock_analysis: Close
[0m23:34:17.847160 [info ] [MainThread]: 
[0m23:34:17.847929 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.99 seconds (2.99s).
[0m23:34:17.848657 [debug] [MainThread]: Command end result
[0m23:34:17.871976 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/stock_analytics/target/manifest.json
[0m23:34:17.873447 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/stock_analytics/target/semantic_manifest.json
[0m23:34:17.876948 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/stock_analytics/target/run_results.json
[0m23:34:17.877151 [info ] [MainThread]: 
[0m23:34:17.877517 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:34:17.877697 [info ] [MainThread]: 
[0m23:34:17.877905 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m23:34:17.878205 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m23:34:17.878806 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.925464, "process_in_blocks": "104", "process_kernel_time": 0.095347, "process_mem_max_rss": "151744", "process_out_blocks": "3289", "process_user_time": 1.983833}
[0m23:34:17.879067 [debug] [MainThread]: Command `dbt run` succeeded at 23:34:17.879022 after 3.93 seconds
[0m23:34:17.879297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff923bea20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93be9ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff922e0920>]}
[0m23:34:17.879517 [debug] [MainThread]: Flushing usage events
[0m23:34:18.215036 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:34:19.815972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c9c0980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d5def60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a6e7c80>]}


============================== 23:34:19.819024 | ac28a5aa-15ec-4e03-8789-9e58e207bbca ==============================
[0m23:34:19.819024 [info ] [MainThread]: Running with dbt=1.11.0-rc1
[0m23:34:19.819523 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'use_colors': 'True', 'indirect_selection': 'eager', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'no_print': 'None', 'log_cache_events': 'False', 'log_path': '/opt/airflow/dbt/stock_analytics/logs', 'printer_width': '80', 'empty': 'None', 'static_parser': 'True', 'debug': 'False', 'target_path': 'None', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'introspect': 'True', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'invocation_command': 'dbt test -s mart_stock_analysis --profiles-dir /opt/airflow/dbt', 'cache_selected_only': 'False'}
[0m23:34:19.900012 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m23:34:19.900370 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m23:34:19.900583 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m23:34:19.964237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ac28a5aa-15ec-4e03-8789-9e58e207bbca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b109f40>]}
[0m23:34:19.986953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ac28a5aa-15ec-4e03-8789-9e58e207bbca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b532c00>]}
[0m23:34:19.987347 [info ] [MainThread]: Registered adapter: snowflake=1.10.3
[0m23:34:20.021037 [debug] [MainThread]: checksum: bdedcbc4566463a53095072aa091a5f5b73db413e58224228390aa7e9748abcc, vars: {}, profile: , target: , version: 1.11.0rc1
[0m23:34:20.077510 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:34:20.077774 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:34:20.097216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ac28a5aa-15ec-4e03-8789-9e58e207bbca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88f2c290>]}
[0m23:34:20.191112 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/stock_analytics/target/manifest.json
[0m23:34:20.192309 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/stock_analytics/target/semantic_manifest.json
[0m23:34:20.206247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ac28a5aa-15ec-4e03-8789-9e58e207bbca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88cc7830>]}
[0m23:34:20.206538 [info ] [MainThread]: Found 3 models, 11 data tests, 2 sources, 504 macros
[0m23:34:20.206897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac28a5aa-15ec-4e03-8789-9e58e207bbca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cee1f10>]}
[0m23:34:20.207598 [info ] [MainThread]: 
[0m23:34:20.207827 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:34:20.207992 [info ] [MainThread]: 
[0m23:34:20.208296 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:34:20.210345 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_OSTRICH_PUBLIC_STAGING'
[0m23:34:20.229536 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_OSTRICH_PUBLIC_STAGING"
[0m23:34:20.229923 [debug] [ThreadPool]: On list_USER_DB_OSTRICH_PUBLIC_STAGING: show objects in USER_DB_OSTRICH.PUBLIC_STAGING
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.0rc1", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_OSTRICH_PUBLIC_STAGING"} */;
[0m23:34:20.230188 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:34:20.589202 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.359 seconds
[0m23:34:20.591072 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_OSTRICH_PUBLIC_STAGING, now list_USER_DB_OSTRICH_PUBLIC_ANALYTICS)
[0m23:34:20.593285 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_OSTRICH_PUBLIC_ANALYTICS"
[0m23:34:20.593580 [debug] [ThreadPool]: On list_USER_DB_OSTRICH_PUBLIC_ANALYTICS: show objects in USER_DB_OSTRICH.PUBLIC_ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.0rc1", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_OSTRICH_PUBLIC_ANALYTICS"} */;
[0m23:34:20.700125 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.106 seconds
[0m23:34:20.704133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac28a5aa-15ec-4e03-8789-9e58e207bbca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cfd1fa0>]}
[0m23:34:20.709880 [debug] [Thread-1 (]: Began running node test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316
[0m23:34:20.711202 [info ] [Thread-1 (]: 1 of 5 START test accepted_values_mart_stock_analysis_record_type__historical__forecast  [RUN]
[0m23:34:20.712147 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_OSTRICH_PUBLIC_ANALYTICS, now test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316)
[0m23:34:20.714101 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316
[0m23:34:20.730440 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316"
[0m23:34:20.732305 [debug] [Thread-1 (]: Began executing node test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316
[0m23:34:20.747632 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316"
[0m23:34:20.749074 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316"
[0m23:34:20.749367 [debug] [Thread-1 (]: On test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        record_type as value_field,
        count(*) as n_records

    from USER_DB_OSTRICH.PUBLIC_ANALYTICS.mart_stock_analysis
    group by record_type

)

select *
from all_values
where value_field not in (
    'historical','forecast'
)



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.0rc1", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316"} */
[0m23:34:20.961381 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.211 seconds
[0m23:34:20.974805 [info ] [Thread-1 (]: 1 of 5 PASS accepted_values_mart_stock_analysis_record_type__historical__forecast  [[32mPASS[0m in 0.26s]
[0m23:34:20.976212 [debug] [Thread-1 (]: Finished running node test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316
[0m23:34:20.976755 [debug] [Thread-1 (]: Began running node test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5
[0m23:34:20.977339 [info ] [Thread-1 (]: 2 of 5 START test not_null_mart_stock_analysis_date ............................ [RUN]
[0m23:34:20.977953 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316, now test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5)
[0m23:34:20.978461 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5
[0m23:34:20.984964 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5"
[0m23:34:20.986465 [debug] [Thread-1 (]: Began executing node test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5
[0m23:34:20.989771 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5"
[0m23:34:20.990926 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5"
[0m23:34:20.991227 [debug] [Thread-1 (]: On test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date
from USER_DB_OSTRICH.PUBLIC_ANALYTICS.mart_stock_analysis
where date is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.0rc1", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5"} */
[0m23:34:21.308951 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.317 seconds
[0m23:34:21.313117 [info ] [Thread-1 (]: 2 of 5 PASS not_null_mart_stock_analysis_date .................................. [[32mPASS[0m in 0.33s]
[0m23:34:21.314721 [debug] [Thread-1 (]: Finished running node test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5
[0m23:34:21.315432 [debug] [Thread-1 (]: Began running node test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e
[0m23:34:21.316055 [info ] [Thread-1 (]: 3 of 5 START test not_null_mart_stock_analysis_symbol .......................... [RUN]
[0m23:34:21.316882 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5, now test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e)
[0m23:34:21.317424 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e
[0m23:34:21.323352 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e"
[0m23:34:21.325696 [debug] [Thread-1 (]: Began executing node test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e
[0m23:34:21.329466 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e"
[0m23:34:21.332116 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e"
[0m23:34:21.332635 [debug] [Thread-1 (]: On test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select symbol
from USER_DB_OSTRICH.PUBLIC_ANALYTICS.mart_stock_analysis
where symbol is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.0rc1", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e"} */
[0m23:34:21.720741 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.387 seconds
[0m23:34:21.725626 [info ] [Thread-1 (]: 3 of 5 PASS not_null_mart_stock_analysis_symbol ................................ [[32mPASS[0m in 0.41s]
[0m23:34:21.729545 [debug] [Thread-1 (]: Finished running node test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e
[0m23:34:21.730798 [debug] [Thread-1 (]: Began running node test.stock_analytics.test_forecast_dates_future
[0m23:34:21.731565 [info ] [Thread-1 (]: 4 of 5 START test test_forecast_dates_future ................................... [RUN]
[0m23:34:21.733202 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e, now test.stock_analytics.test_forecast_dates_future)
[0m23:34:21.734181 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.test_forecast_dates_future
[0m23:34:21.738496 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.test_forecast_dates_future"
[0m23:34:21.740710 [debug] [Thread-1 (]: Began executing node test.stock_analytics.test_forecast_dates_future
[0m23:34:21.743514 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.test_forecast_dates_future"
[0m23:34:21.745202 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.test_forecast_dates_future"
[0m23:34:21.745591 [debug] [Thread-1 (]: On test.stock_analytics.test_forecast_dates_future: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- Fail if any forecast date is not strictly after the latest historical date for that symbol.
with max_hist as (
  select symbol, max(date) as max_hist_date
  from USER_DB_OSTRICH.PUBLIC_ANALYTICS.mart_stock_analysis
  where record_type = 'historical'
  group by 1
)

select f.symbol, f.date, f.record_type, f.forecast_price, m.max_hist_date
from USER_DB_OSTRICH.PUBLIC_ANALYTICS.mart_stock_analysis f
join max_hist m using (symbol)
where f.record_type = 'forecast'
  and f.date <= m.max_hist_date
  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.0rc1", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.test_forecast_dates_future"} */
[0m23:34:22.127743 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.382 seconds
[0m23:34:22.132650 [error] [Thread-1 (]: 4 of 5 FAIL 1 test_forecast_dates_future ....................................... [[31mFAIL 1[0m in 0.40s]
[0m23:34:22.134605 [debug] [Thread-1 (]: Finished running node test.stock_analytics.test_forecast_dates_future
[0m23:34:22.135518 [debug] [Thread-1 (]: Began running node test.stock_analytics.unique_mart_stock_analysis_pk_symbol_date.2ccccb8eaa
[0m23:34:22.136406 [info ] [Thread-1 (]: 5 of 5 START test unique_mart_stock_analysis_pk_symbol_date .................... [RUN]
[0m23:34:22.137790 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.test_forecast_dates_future, now test.stock_analytics.unique_mart_stock_analysis_pk_symbol_date.2ccccb8eaa)
[0m23:34:22.138483 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.unique_mart_stock_analysis_pk_symbol_date.2ccccb8eaa
[0m23:34:22.146564 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.unique_mart_stock_analysis_pk_symbol_date.2ccccb8eaa"
[0m23:34:22.149291 [debug] [Thread-1 (]: Began executing node test.stock_analytics.unique_mart_stock_analysis_pk_symbol_date.2ccccb8eaa
[0m23:34:22.151824 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.unique_mart_stock_analysis_pk_symbol_date.2ccccb8eaa"
[0m23:34:22.153393 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.unique_mart_stock_analysis_pk_symbol_date.2ccccb8eaa"
[0m23:34:22.153798 [debug] [Thread-1 (]: On test.stock_analytics.unique_mart_stock_analysis_pk_symbol_date.2ccccb8eaa: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    pk_symbol_date as unique_field,
    count(*) as n_records

from USER_DB_OSTRICH.PUBLIC_ANALYTICS.mart_stock_analysis
where pk_symbol_date is not null
group by pk_symbol_date
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.0rc1", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.unique_mart_stock_analysis_pk_symbol_date.2ccccb8eaa"} */
[0m23:34:22.508492 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.354 seconds
[0m23:34:22.509742 [error] [Thread-1 (]: 5 of 5 FAIL 1 unique_mart_stock_analysis_pk_symbol_date ........................ [[31mFAIL 1[0m in 0.37s]
[0m23:34:22.510206 [debug] [Thread-1 (]: Finished running node test.stock_analytics.unique_mart_stock_analysis_pk_symbol_date.2ccccb8eaa
[0m23:34:22.510990 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:34:22.511171 [debug] [MainThread]: Connection 'test.stock_analytics.unique_mart_stock_analysis_pk_symbol_date.2ccccb8eaa' was left open.
[0m23:34:22.511369 [debug] [MainThread]: On test.stock_analytics.unique_mart_stock_analysis_pk_symbol_date.2ccccb8eaa: Close
[0m23:34:22.634065 [info ] [MainThread]: 
[0m23:34:22.634423 [info ] [MainThread]: Finished running 5 data tests in 0 hours 0 minutes and 2.43 seconds (2.43s).
[0m23:34:22.635113 [debug] [MainThread]: Command end result
[0m23:34:22.651796 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/stock_analytics/target/manifest.json
[0m23:34:22.653103 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/stock_analytics/target/semantic_manifest.json
[0m23:34:22.656515 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/stock_analytics/target/run_results.json
[0m23:34:22.656729 [info ] [MainThread]: 
[0m23:34:22.657077 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m23:34:22.657252 [info ] [MainThread]: 
[0m23:34:22.657488 [error] [MainThread]: [31mFailure in test test_forecast_dates_future (tests/test_forecast_dates_future.sql)[0m
[0m23:34:22.657660 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m23:34:22.657819 [info ] [MainThread]: 
[0m23:34:22.657981 [info ] [MainThread]:   compiled code at target/compiled/stock_analytics/tests/test_forecast_dates_future.sql
[0m23:34:22.658134 [info ] [MainThread]: 
[0m23:34:22.658300 [error] [MainThread]: [31mFailure in test unique_mart_stock_analysis_pk_symbol_date (models/marts/mart_stock_analysis.yml)[0m
[0m23:34:22.658463 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m23:34:22.658594 [info ] [MainThread]: 
[0m23:34:22.658753 [info ] [MainThread]:   compiled code at target/compiled/stock_analytics/models/marts/mart_stock_analysis.yml/unique_mart_stock_analysis_pk_symbol_date.sql
[0m23:34:22.658891 [info ] [MainThread]: 
[0m23:34:22.659055 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=2 SKIP=0 NO-OP=0 TOTAL=5
[0m23:34:22.659573 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 2.8654764, "process_in_blocks": "0", "process_kernel_time": 0.083794, "process_mem_max_rss": "145928", "process_out_blocks": "2248", "process_user_time": 1.418519}
[0m23:34:22.659805 [debug] [MainThread]: Command `dbt test` failed at 23:34:22.659766 after 2.87 seconds
[0m23:34:22.660008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8acf9bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a6e7c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d44ec00>]}
[0m23:34:22.660195 [debug] [MainThread]: Flushing usage events
[0m23:34:22.976530 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:39:24.646706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b922a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8912cb30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff890c0560>]}


============================== 23:39:24.650393 | 0df90a09-c383-4cde-b337-e96c28bfe7d1 ==============================
[0m23:39:24.650393 [info ] [MainThread]: Running with dbt=1.11.0-rc1
[0m23:39:24.650849 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'empty': 'None', 'printer_width': '80', 'log_format': 'default', 'fail_fast': 'False', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/opt/airflow/dbt', 'no_print': 'None', 'warn_error': 'None', 'invocation_command': 'dbt test -s mart_stock_analysis --profiles-dir /opt/airflow/dbt', 'use_colors': 'True', 'quiet': 'False', 'static_parser': 'True', 'log_path': '/opt/airflow/dbt/stock_analytics/logs', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'write_json': 'True', 'cache_selected_only': 'False', 'indirect_selection': 'eager'}
[0m23:39:24.737380 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m23:39:24.737706 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m23:39:24.737934 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m23:39:24.805540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0df90a09-c383-4cde-b337-e96c28bfe7d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87dbb320>]}
[0m23:39:24.828648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0df90a09-c383-4cde-b337-e96c28bfe7d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff874f0080>]}
[0m23:39:24.829048 [info ] [MainThread]: Registered adapter: snowflake=1.10.3
[0m23:39:24.863738 [debug] [MainThread]: checksum: bdedcbc4566463a53095072aa091a5f5b73db413e58224228390aa7e9748abcc, vars: {}, profile: , target: , version: 1.11.0rc1
[0m23:39:24.920962 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:39:24.921209 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:39:24.940922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0df90a09-c383-4cde-b337-e96c28bfe7d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87300ce0>]}
[0m23:39:25.151779 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/stock_analytics/target/manifest.json
[0m23:39:25.153590 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/stock_analytics/target/semantic_manifest.json
[0m23:39:25.171348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0df90a09-c383-4cde-b337-e96c28bfe7d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff874f1400>]}
[0m23:39:25.171706 [info ] [MainThread]: Found 3 models, 11 data tests, 2 sources, 504 macros
[0m23:39:25.172296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0df90a09-c383-4cde-b337-e96c28bfe7d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8745ade0>]}
[0m23:39:25.173171 [info ] [MainThread]: 
[0m23:39:25.173530 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:39:25.173759 [info ] [MainThread]: 
[0m23:39:25.174182 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:39:25.176689 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_OSTRICH_PUBLIC_STAGING'
[0m23:39:25.199305 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_OSTRICH_PUBLIC_STAGING"
[0m23:39:25.199622 [debug] [ThreadPool]: On list_USER_DB_OSTRICH_PUBLIC_STAGING: show objects in USER_DB_OSTRICH.PUBLIC_STAGING
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.0rc1", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_OSTRICH_PUBLIC_STAGING"} */;
[0m23:39:25.199887 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:39:25.851249 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.651 seconds
[0m23:39:25.854817 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_OSTRICH_PUBLIC_STAGING, now list_USER_DB_OSTRICH_PUBLIC_ANALYTICS)
[0m23:39:25.858690 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_OSTRICH_PUBLIC_ANALYTICS"
[0m23:39:25.859324 [debug] [ThreadPool]: On list_USER_DB_OSTRICH_PUBLIC_ANALYTICS: show objects in USER_DB_OSTRICH.PUBLIC_ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.0rc1", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_OSTRICH_PUBLIC_ANALYTICS"} */;
[0m23:39:25.991813 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.132 seconds
[0m23:39:25.996848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0df90a09-c383-4cde-b337-e96c28bfe7d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b319df0>]}
[0m23:39:26.002409 [debug] [Thread-1 (]: Began running node test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316
[0m23:39:26.003048 [info ] [Thread-1 (]: 1 of 5 START test accepted_values_mart_stock_analysis_record_type__historical__forecast  [RUN]
[0m23:39:26.004263 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_OSTRICH_PUBLIC_ANALYTICS, now test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316)
[0m23:39:26.004762 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316
[0m23:39:26.018623 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316"
[0m23:39:26.020643 [debug] [Thread-1 (]: Began executing node test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316
[0m23:39:26.034659 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316"
[0m23:39:26.035749 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316"
[0m23:39:26.036009 [debug] [Thread-1 (]: On test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        record_type as value_field,
        count(*) as n_records

    from USER_DB_OSTRICH.PUBLIC_ANALYTICS.mart_stock_analysis
    group by record_type

)

select *
from all_values
where value_field not in (
    'historical','forecast'
)



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.0rc1", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316"} */
[0m23:39:26.212411 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.176 seconds
[0m23:39:26.218587 [info ] [Thread-1 (]: 1 of 5 PASS accepted_values_mart_stock_analysis_record_type__historical__forecast  [[32mPASS[0m in 0.21s]
[0m23:39:26.219213 [debug] [Thread-1 (]: Finished running node test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316
[0m23:39:26.219534 [debug] [Thread-1 (]: Began running node test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5
[0m23:39:26.219837 [info ] [Thread-1 (]: 2 of 5 START test not_null_mart_stock_analysis_date ............................ [RUN]
[0m23:39:26.220285 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316, now test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5)
[0m23:39:26.220620 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5
[0m23:39:26.224567 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5"
[0m23:39:26.225370 [debug] [Thread-1 (]: Began executing node test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5
[0m23:39:26.227725 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5"
[0m23:39:26.228578 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5"
[0m23:39:26.228825 [debug] [Thread-1 (]: On test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date
from USER_DB_OSTRICH.PUBLIC_ANALYTICS.mart_stock_analysis
where date is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.0rc1", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5"} */
[0m23:39:26.357391 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.128 seconds
[0m23:39:26.359878 [info ] [Thread-1 (]: 2 of 5 PASS not_null_mart_stock_analysis_date .................................. [[32mPASS[0m in 0.14s]
[0m23:39:26.360811 [debug] [Thread-1 (]: Finished running node test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5
[0m23:39:26.361358 [debug] [Thread-1 (]: Began running node test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e
[0m23:39:26.361776 [info ] [Thread-1 (]: 3 of 5 START test not_null_mart_stock_analysis_symbol .......................... [RUN]
[0m23:39:26.362418 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5, now test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e)
[0m23:39:26.362972 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e
[0m23:39:26.367413 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e"
[0m23:39:26.368576 [debug] [Thread-1 (]: Began executing node test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e
[0m23:39:26.370890 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e"
[0m23:39:26.372200 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e"
[0m23:39:26.372607 [debug] [Thread-1 (]: On test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select symbol
from USER_DB_OSTRICH.PUBLIC_ANALYTICS.mart_stock_analysis
where symbol is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.0rc1", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e"} */
[0m23:39:26.532594 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.159 seconds
[0m23:39:26.536700 [info ] [Thread-1 (]: 3 of 5 PASS not_null_mart_stock_analysis_symbol ................................ [[32mPASS[0m in 0.17s]
[0m23:39:26.537793 [debug] [Thread-1 (]: Finished running node test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e
[0m23:39:26.538305 [debug] [Thread-1 (]: Began running node test.stock_analytics.test_forecast_dates_future
[0m23:39:26.538836 [info ] [Thread-1 (]: 4 of 5 START test test_forecast_dates_future ................................... [RUN]
[0m23:39:26.539565 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e, now test.stock_analytics.test_forecast_dates_future)
[0m23:39:26.539983 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.test_forecast_dates_future
[0m23:39:26.543457 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.test_forecast_dates_future"
[0m23:39:26.545674 [debug] [Thread-1 (]: Began executing node test.stock_analytics.test_forecast_dates_future
[0m23:39:26.548008 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.test_forecast_dates_future"
[0m23:39:26.549622 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.test_forecast_dates_future"
[0m23:39:26.549994 [debug] [Thread-1 (]: On test.stock_analytics.test_forecast_dates_future: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- Fail if any forecast date is not strictly after the latest historical date for that symbol.
with max_hist as (
  select symbol, max(date) as max_hist_date
  from USER_DB_OSTRICH.PUBLIC_ANALYTICS.mart_stock_analysis
  where record_type = 'historical'
  group by 1
)

select f.symbol, f.date, f.record_type, f.forecast_price, m.max_hist_date
from USER_DB_OSTRICH.PUBLIC_ANALYTICS.mart_stock_analysis f
join max_hist m using (symbol)
where f.record_type = 'forecast'
  and f.date <= m.max_hist_date
  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.0rc1", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.test_forecast_dates_future"} */
[0m23:39:27.689656 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.139 seconds
[0m23:39:27.693954 [error] [Thread-1 (]: 4 of 5 FAIL 1 test_forecast_dates_future ....................................... [[31mFAIL 1[0m in 1.15s]
[0m23:39:27.695638 [debug] [Thread-1 (]: Finished running node test.stock_analytics.test_forecast_dates_future
[0m23:39:27.696328 [debug] [Thread-1 (]: Began running node test.stock_analytics.unique_mart_stock_analysis_pk_symbol_date.2ccccb8eaa
[0m23:39:27.696851 [info ] [Thread-1 (]: 5 of 5 START test unique_mart_stock_analysis_pk_symbol_date .................... [RUN]
[0m23:39:27.697637 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.test_forecast_dates_future, now test.stock_analytics.unique_mart_stock_analysis_pk_symbol_date.2ccccb8eaa)
[0m23:39:27.698077 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.unique_mart_stock_analysis_pk_symbol_date.2ccccb8eaa
[0m23:39:27.704566 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.unique_mart_stock_analysis_pk_symbol_date.2ccccb8eaa"
[0m23:39:27.706823 [debug] [Thread-1 (]: Began executing node test.stock_analytics.unique_mart_stock_analysis_pk_symbol_date.2ccccb8eaa
[0m23:39:27.709237 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.unique_mart_stock_analysis_pk_symbol_date.2ccccb8eaa"
[0m23:39:27.710867 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.unique_mart_stock_analysis_pk_symbol_date.2ccccb8eaa"
[0m23:39:27.711194 [debug] [Thread-1 (]: On test.stock_analytics.unique_mart_stock_analysis_pk_symbol_date.2ccccb8eaa: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    pk_symbol_date as unique_field,
    count(*) as n_records

from USER_DB_OSTRICH.PUBLIC_ANALYTICS.mart_stock_analysis
where pk_symbol_date is not null
group by pk_symbol_date
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.0rc1", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.unique_mart_stock_analysis_pk_symbol_date.2ccccb8eaa"} */
[0m23:39:27.888142 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.176 seconds
[0m23:39:27.893775 [error] [Thread-1 (]: 5 of 5 FAIL 1 unique_mart_stock_analysis_pk_symbol_date ........................ [[31mFAIL 1[0m in 0.20s]
[0m23:39:27.895891 [debug] [Thread-1 (]: Finished running node test.stock_analytics.unique_mart_stock_analysis_pk_symbol_date.2ccccb8eaa
[0m23:39:27.898150 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:39:27.898642 [debug] [MainThread]: Connection 'test.stock_analytics.unique_mart_stock_analysis_pk_symbol_date.2ccccb8eaa' was left open.
[0m23:39:27.899057 [debug] [MainThread]: On test.stock_analytics.unique_mart_stock_analysis_pk_symbol_date.2ccccb8eaa: Close
[0m23:39:28.002454 [info ] [MainThread]: 
[0m23:39:28.003160 [info ] [MainThread]: Finished running 5 data tests in 0 hours 0 minutes and 2.83 seconds (2.83s).
[0m23:39:28.004012 [debug] [MainThread]: Command end result
[0m23:39:28.024303 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/stock_analytics/target/manifest.json
[0m23:39:28.025681 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/stock_analytics/target/semantic_manifest.json
[0m23:39:28.029701 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/stock_analytics/target/run_results.json
[0m23:39:28.029910 [info ] [MainThread]: 
[0m23:39:28.030278 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m23:39:28.030494 [info ] [MainThread]: 
[0m23:39:28.030755 [error] [MainThread]: [31mFailure in test test_forecast_dates_future (tests/test_forecast_dates_future.sql)[0m
[0m23:39:28.030957 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m23:39:28.031160 [info ] [MainThread]: 
[0m23:39:28.031357 [info ] [MainThread]:   compiled code at target/compiled/stock_analytics/tests/test_forecast_dates_future.sql
[0m23:39:28.031554 [info ] [MainThread]: 
[0m23:39:28.031764 [error] [MainThread]: [31mFailure in test unique_mart_stock_analysis_pk_symbol_date (models/marts/mart_stock_analysis.yml)[0m
[0m23:39:28.031968 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m23:39:28.032117 [info ] [MainThread]: 
[0m23:39:28.032403 [info ] [MainThread]:   compiled code at target/compiled/stock_analytics/models/marts/mart_stock_analysis.yml/unique_mart_stock_analysis_pk_symbol_date.sql
[0m23:39:28.032578 [info ] [MainThread]: 
[0m23:39:28.032791 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=2 SKIP=0 NO-OP=0 TOTAL=5
[0m23:39:28.033381 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 3.4076934, "process_in_blocks": "0", "process_kernel_time": 0.125858, "process_mem_max_rss": "145780", "process_out_blocks": "2248", "process_user_time": 1.515464}
[0m23:39:28.033654 [debug] [MainThread]: Command `dbt test` failed at 23:39:28.033603 after 3.41 seconds
[0m23:39:28.033876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88d5d3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff889ffc80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8909d160>]}
[0m23:39:28.034076 [debug] [MainThread]: Flushing usage events
[0m23:39:28.419334 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:54:16.722845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90d30e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff921be780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90b687a0>]}


============================== 23:54:16.726483 | f5557a58-6a28-4d5f-b91f-a09882579100 ==============================
[0m23:54:16.726483 [info ] [MainThread]: Running with dbt=1.11.0-rc1
[0m23:54:16.726932 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/stock_analytics/logs', 'static_parser': 'True', 'quiet': 'False', 'cache_selected_only': 'False', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'invocation_command': 'dbt debug --profiles-dir /opt/airflow/dbt', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'empty': 'None', 'debug': 'False', 'use_colors': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'warn_error': 'None', 'target_path': 'None', 'profiles_dir': '/opt/airflow/dbt', 'write_json': 'True'}
[0m23:54:16.730934 [info ] [MainThread]: dbt version: 1.11.0-rc1
[0m23:54:16.731179 [info ] [MainThread]: python version: 3.12.5
[0m23:54:16.731377 [info ] [MainThread]: python path: /opt/airflow/dbt_venv/bin/python3.12
[0m23:54:16.731561 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.36
[0m23:54:16.821649 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m23:54:16.821997 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m23:54:16.822197 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m23:54:16.844685 [info ] [MainThread]: Using profiles dir at /opt/airflow/dbt
[0m23:54:16.844962 [info ] [MainThread]: Using profiles.yml file at /opt/airflow/dbt/profiles.yml
[0m23:54:16.845176 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/dbt/stock_analytics/dbt_project.yml
[0m23:54:16.845431 [info ] [MainThread]: adapter type: snowflake
[0m23:54:16.845606 [info ] [MainThread]: adapter version: 1.10.3
[0m23:54:16.886514 [info ] [MainThread]: Configuration:
[0m23:54:16.886847 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m23:54:16.887049 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m23:54:16.887270 [info ] [MainThread]: Required dependencies:
[0m23:54:16.887488 [debug] [MainThread]: Executing "git --help"
[0m23:54:16.889510 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m23:54:16.889752 [debug] [MainThread]: STDERR: "b''"
[0m23:54:16.889903 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m23:54:16.890071 [info ] [MainThread]: Connection:
[0m23:54:16.890268 [info ] [MainThread]:   account: sfedu02-lvb17920
[0m23:54:16.890457 [info ] [MainThread]:   user: OSTRICH
[0m23:54:16.890654 [info ] [MainThread]:   database: USER_DB_OSTRICH
[0m23:54:16.890847 [info ] [MainThread]:   warehouse: OSTRICH_QUERY_WH
[0m23:54:16.891011 [info ] [MainThread]:   role: TRAINING_ROLE
[0m23:54:16.891169 [info ] [MainThread]:   schema: PUBLIC
[0m23:54:16.891332 [info ] [MainThread]:   authenticator: None
[0m23:54:16.891492 [info ] [MainThread]:   oauth_client_id: None
[0m23:54:16.891663 [info ] [MainThread]:   query_tag: None
[0m23:54:16.891854 [info ] [MainThread]:   client_session_keep_alive: False
[0m23:54:16.892020 [info ] [MainThread]:   host: None
[0m23:54:16.892189 [info ] [MainThread]:   port: None
[0m23:54:16.892345 [info ] [MainThread]:   proxy_host: None
[0m23:54:16.892496 [info ] [MainThread]:   proxy_port: None
[0m23:54:16.892651 [info ] [MainThread]:   protocol: None
[0m23:54:16.892834 [info ] [MainThread]:   connect_retries: 1
[0m23:54:16.893043 [info ] [MainThread]:   connect_timeout: None
[0m23:54:16.893214 [info ] [MainThread]:   retry_on_database_errors: False
[0m23:54:16.893376 [info ] [MainThread]:   retry_all: False
[0m23:54:16.893510 [info ] [MainThread]:   insecure_mode: False
[0m23:54:16.893639 [info ] [MainThread]:   reuse_connections: True
[0m23:54:16.893781 [info ] [MainThread]:   s3_stage_vpce_dns_name: None
[0m23:54:16.893912 [info ] [MainThread]:   platform_detection_timeout_seconds: 0.0
[0m23:54:16.894129 [info ] [MainThread]: Registered adapter: snowflake=1.10.3
[0m23:54:16.929998 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m23:54:16.941638 [debug] [MainThread]: Using snowflake connection "debug"
[0m23:54:16.941920 [debug] [MainThread]: On debug: select 1 as id
[0m23:54:16.942124 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:54:17.443053 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.501 seconds
[0m23:54:17.445597 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m23:54:17.446531 [info ] [MainThread]: [32mAll checks passed![0m
[0m23:54:17.448238 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.74776727, "process_in_blocks": "0", "process_kernel_time": 0.138994, "process_mem_max_rss": "137056", "process_out_blocks": "30", "process_user_time": 1.08696}
[0m23:54:17.448967 [debug] [MainThread]: Command `dbt debug` succeeded at 23:54:17.448825 after 0.75 seconds
[0m23:54:17.449430 [debug] [MainThread]: Connection 'debug' was left open.
[0m23:54:17.449846 [debug] [MainThread]: On debug: Close
[0m23:54:17.568608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90afd8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8eda6bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91e74d10>]}
[0m23:54:17.569333 [debug] [MainThread]: Flushing usage events
[0m23:54:17.975688 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:54:19.013838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cae6090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f47ef00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cae7f80>]}


============================== 23:54:19.016925 | 0b5db62c-b806-4f6a-9581-8121df43d56a ==============================
[0m23:54:19.016925 [info ] [MainThread]: Running with dbt=1.11.0-rc1
[0m23:54:19.017202 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'empty': 'False', 'use_experimental_parser': 'False', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False', 'printer_width': '80', 'use_colors': 'True', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'no_print': 'None', 'log_path': '/opt/airflow/dbt/stock_analytics/logs', 'static_parser': 'True', 'version_check': 'True', 'partial_parse': 'True', 'profiles_dir': '/opt/airflow/dbt', 'invocation_command': 'dbt run -s mart_stock_analysis --profiles-dir /opt/airflow/dbt', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'write_json': 'True'}
[0m23:54:19.093313 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m23:54:19.093653 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m23:54:19.093909 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m23:54:19.157693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0b5db62c-b806-4f6a-9581-8121df43d56a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b08dd30>]}
[0m23:54:19.180567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0b5db62c-b806-4f6a-9581-8121df43d56a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cf1c830>]}
[0m23:54:19.180949 [info ] [MainThread]: Registered adapter: snowflake=1.10.3
[0m23:54:19.214656 [debug] [MainThread]: checksum: bdedcbc4566463a53095072aa091a5f5b73db413e58224228390aa7e9748abcc, vars: {}, profile: , target: , version: 1.11.0rc1
[0m23:54:19.271028 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:54:19.271422 [info ] [MainThread]: Unable to do partial parsing because an error occurred. Switching to full reparse.
[0m23:54:19.273417 [debug] [MainThread]: Partial parsing exception processing file stock_analytics://models/marts/mart_stock_analysis.sql
[0m23:54:19.273716 [debug] [MainThread]: PP exception info: {'exception': "AttributeError: 'SingularTestNode' object has no attribute 'attached_node'", 'traceback': 'Traceback (most recent call last):\n  File "/opt/airflow/dbt_venv/lib/python3.12/site-packages/dbt/parser/manifest.py", line 549, in safe_update_project_parser_files_partially\n    project_parser_files = self.partial_parser.get_parsing_files()\n                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File "/opt/airflow/dbt_venv/lib/python3.12/site-packages/dbt/parser/partial.py", line 197, in get_parsing_files\n    self.update_in_saved(file_id)\n  File "/opt/airflow/dbt_venv/lib/python3.12/site-packages/dbt/parser/partial.py", line 306, in update_in_saved\n    self.update_mssat_in_saved(new_source_file, old_source_file)\n  File "/opt/airflow/dbt_venv/lib/python3.12/site-packages/dbt/parser/partial.py", line 336, in update_mssat_in_saved\n    self.remove_node_in_saved(new_source_file, unique_id)\n  File "/opt/airflow/dbt_venv/lib/python3.12/site-packages/dbt/parser/partial.py", line 376, in remove_node_in_saved\n    self.delete_schema_mssa_links(schema_file, dict_key, elem_patch)\n  File "/opt/airflow/dbt_venv/lib/python3.12/site-packages/dbt/parser/partial.py", line 852, in delete_schema_mssa_links\n    self._delete_schema_mssa_links(schema_file, dict_key, elem, elem_unique_ids)\n  File "/opt/airflow/dbt_venv/lib/python3.12/site-packages/dbt/parser/partial.py", line 905, in _delete_schema_mssa_links\n    self.remove_tests(schema_file, dict_key, elem["name"])\n  File "/opt/airflow/dbt_venv/lib/python3.12/site-packages/dbt/parser/partial.py", line 920, in remove_tests\n    if child_test.attached_node:\n       ^^^^^^^^^^^^^^^^^^^^^^^^\nAttributeError: \'SingularTestNode\' object has no attribute \'attached_node\'\n', 'location': 'line 920 in remove_tests', 'code': 'if child_test.attached_node:', 'parse_file_type': 'model'}
[0m23:54:19.273949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0b5db62c-b806-4f6a-9581-8121df43d56a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cdde750>]}
[0m23:54:19.746058 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values` defined on
'mart_stock_analysis' in package 'stock_analytics'
(models/marts/mart_stock_analysis.yml). Arguments to generic tests should be
nested under the `arguments` property.
[0m23:54:19.746431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0b5db62c-b806-4f6a-9581-8121df43d56a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8aa057c0>]}
[0m23:54:19.828608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0b5db62c-b806-4f6a-9581-8121df43d56a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a1e1eb0>]}
[0m23:54:19.870744 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/stock_analytics/target/manifest.json
[0m23:54:19.872055 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/stock_analytics/target/semantic_manifest.json
[0m23:54:19.880836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0b5db62c-b806-4f6a-9581-8121df43d56a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8aae43e0>]}
[0m23:54:19.881076 [info ] [MainThread]: Found 3 models, 11 data tests, 2 sources, 504 macros
[0m23:54:19.881242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b5db62c-b806-4f6a-9581-8121df43d56a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ac11910>]}
[0m23:54:19.881874 [info ] [MainThread]: 
[0m23:54:19.882079 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:54:19.882277 [info ] [MainThread]: 
[0m23:54:19.882555 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:54:19.883077 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_OSTRICH'
[0m23:54:19.897206 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_OSTRICH"
[0m23:54:19.897459 [debug] [ThreadPool]: On list_USER_DB_OSTRICH: show terse schemas in database USER_DB_OSTRICH
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.0rc1", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_OSTRICH"} */
[0m23:54:19.897620 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:54:20.426004 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.528 seconds
[0m23:54:20.429291 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_OSTRICH, now list_USER_DB_OSTRICH_PUBLIC_STAGING)
[0m23:54:20.435406 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_OSTRICH_PUBLIC_STAGING"
[0m23:54:20.435645 [debug] [ThreadPool]: On list_USER_DB_OSTRICH_PUBLIC_STAGING: show objects in USER_DB_OSTRICH.PUBLIC_STAGING
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.0rc1", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_OSTRICH_PUBLIC_STAGING"} */;
[0m23:54:20.577671 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.142 seconds
[0m23:54:20.580250 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_OSTRICH_PUBLIC_STAGING, now list_USER_DB_OSTRICH_PUBLIC_ANALYTICS)
[0m23:54:20.583324 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_OSTRICH_PUBLIC_ANALYTICS"
[0m23:54:20.583752 [debug] [ThreadPool]: On list_USER_DB_OSTRICH_PUBLIC_ANALYTICS: show objects in USER_DB_OSTRICH.PUBLIC_ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.0rc1", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_OSTRICH_PUBLIC_ANALYTICS"} */;
[0m23:54:20.706445 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.122 seconds
[0m23:54:20.709582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b5db62c-b806-4f6a-9581-8121df43d56a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a1f27e0>]}
[0m23:54:20.715043 [debug] [Thread-1 (]: Began running node model.stock_analytics.mart_stock_analysis
[0m23:54:20.715938 [info ] [Thread-1 (]: 1 of 1 START sql table model PUBLIC_ANALYTICS.mart_stock_analysis .............. [RUN]
[0m23:54:20.716615 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_OSTRICH_PUBLIC_ANALYTICS, now model.stock_analytics.mart_stock_analysis)
[0m23:54:20.717163 [debug] [Thread-1 (]: Began compiling node model.stock_analytics.mart_stock_analysis
[0m23:54:20.725824 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_analytics.mart_stock_analysis"
[0m23:54:20.728325 [debug] [Thread-1 (]: Began executing node model.stock_analytics.mart_stock_analysis
[0m23:54:20.752276 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_analytics.mart_stock_analysis"
[0m23:54:20.753954 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.mart_stock_analysis"
[0m23:54:20.754296 [debug] [Thread-1 (]: On model.stock_analytics.mart_stock_analysis: create or replace transient table USER_DB_OSTRICH.PUBLIC_ANALYTICS.mart_stock_analysis
    
    
    
    as (

-- Historical slice
with hist as (
  select
    symbol,
    date,
    close                  as actual_price,
    cast(null as float)    as forecast_price,
    cast(null as float)    as lower_bound,
    cast(null as float)    as upper_bound,
    'historical'           as record_type,
    concat(symbol, '|', to_varchar(date)) as pk_symbol_date
  from USER_DB_OSTRICH.PUBLIC_STAGING.stg_market_data
),

-- Forecast slice
fut as (
  select
    symbol,
    date,
    cast(null as float)    as actual_price,
    forecast               as forecast_price,
    lower_bound,
    upper_bound,
    'forecast'             as record_type,
    concat(symbol, '|', to_varchar(date)) as pk_symbol_date
  from USER_DB_OSTRICH.PUBLIC_STAGING.stg_market_forecast
),

unioned as (
  select * from hist
  union all
  select * from fut
)

select *
from (
  select
    *,
    row_number() over (
      -- 1. PARTITION ONLY BY KEY (remove record_type)
      partition by symbol, date
      -- 2. PRIORITIZE HISTORICAL DATA
      order by 
        case when record_type = 'historical' then 1 else 2 end asc,
        date desc
    ) as rn
  from unioned
)
where rn = 1
    )

/* {"app": "dbt", "dbt_version": "1.11.0rc1", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.mart_stock_analysis"} */;
[0m23:54:22.155368 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.400 seconds
[0m23:54:22.179834 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b5db62c-b806-4f6a-9581-8121df43d56a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d52fda0>]}
[0m23:54:22.180581 [info ] [Thread-1 (]: 1 of 1 OK created sql table model PUBLIC_ANALYTICS.mart_stock_analysis ......... [[32mSUCCESS 1[0m in 1.46s]
[0m23:54:22.181093 [debug] [Thread-1 (]: Finished running node model.stock_analytics.mart_stock_analysis
[0m23:54:22.182275 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:54:22.182621 [debug] [MainThread]: Connection 'model.stock_analytics.mart_stock_analysis' was left open.
[0m23:54:22.182999 [debug] [MainThread]: On model.stock_analytics.mart_stock_analysis: Close
[0m23:54:22.288002 [info ] [MainThread]: 
[0m23:54:22.289146 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.41 seconds (2.41s).
[0m23:54:22.290461 [debug] [MainThread]: Command end result
[0m23:54:22.319895 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/stock_analytics/target/manifest.json
[0m23:54:22.321353 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/stock_analytics/target/semantic_manifest.json
[0m23:54:22.325150 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/stock_analytics/target/run_results.json
[0m23:54:22.325391 [info ] [MainThread]: 
[0m23:54:22.325665 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:54:22.325922 [info ] [MainThread]: 
[0m23:54:22.326199 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m23:54:22.326543 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m23:54:22.327104 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.334119, "process_in_blocks": "0", "process_kernel_time": 0.082389, "process_mem_max_rss": "151664", "process_out_blocks": "3293", "process_user_time": 1.86482}
[0m23:54:22.327426 [debug] [MainThread]: Command `dbt run` succeeded at 23:54:22.327357 after 3.33 seconds
[0m23:54:22.327675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ac10050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8aa048c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a50b650>]}
[0m23:54:22.327925 [debug] [MainThread]: Flushing usage events
[0m23:54:22.657714 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:54:24.806349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8419d130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84102db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83dde060>]}


============================== 23:54:24.809956 | 3df72350-66d8-47a8-8609-667aaea962f9 ==============================
[0m23:54:24.809956 [info ] [MainThread]: Running with dbt=1.11.0-rc1
[0m23:54:24.810400 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'fail_fast': 'False', 'debug': 'False', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'no_print': 'None', 'invocation_command': 'dbt test -s mart_stock_analysis --profiles-dir /opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/stock_analytics/logs', 'cache_selected_only': 'False', 'quiet': 'False', 'use_colors': 'True', 'write_json': 'True', 'indirect_selection': 'eager', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'profiles_dir': '/opt/airflow/dbt', 'printer_width': '80', 'log_format': 'default', 'warn_error': 'None'}
[0m23:54:24.920863 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m23:54:24.921257 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m23:54:24.921582 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m23:54:25.000394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3df72350-66d8-47a8-8609-667aaea962f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff825c2ff0>]}
[0m23:54:25.030216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3df72350-66d8-47a8-8609-667aaea962f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83096120>]}
[0m23:54:25.030810 [info ] [MainThread]: Registered adapter: snowflake=1.10.3
[0m23:54:25.067668 [debug] [MainThread]: checksum: bdedcbc4566463a53095072aa091a5f5b73db413e58224228390aa7e9748abcc, vars: {}, profile: , target: , version: 1.11.0rc1
[0m23:54:25.122058 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:54:25.122323 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:54:25.142481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3df72350-66d8-47a8-8609-667aaea962f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81963410>]}
[0m23:54:25.221144 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/stock_analytics/target/manifest.json
[0m23:54:25.222085 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/stock_analytics/target/semantic_manifest.json
[0m23:54:25.235248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3df72350-66d8-47a8-8609-667aaea962f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81cca120>]}
[0m23:54:25.235513 [info ] [MainThread]: Found 3 models, 11 data tests, 2 sources, 504 macros
[0m23:54:25.235877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3df72350-66d8-47a8-8609-667aaea962f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff819ea2d0>]}
[0m23:54:25.236592 [info ] [MainThread]: 
[0m23:54:25.236854 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:54:25.237104 [info ] [MainThread]: 
[0m23:54:25.237450 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:54:25.239365 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_OSTRICH_PUBLIC_STAGING'
[0m23:54:25.256948 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_OSTRICH_PUBLIC_STAGING"
[0m23:54:25.257224 [debug] [ThreadPool]: On list_USER_DB_OSTRICH_PUBLIC_STAGING: show objects in USER_DB_OSTRICH.PUBLIC_STAGING
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.0rc1", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_OSTRICH_PUBLIC_STAGING"} */;
[0m23:54:25.257435 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:54:25.823456 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.566 seconds
[0m23:54:25.824958 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_OSTRICH_PUBLIC_STAGING, now list_USER_DB_OSTRICH_PUBLIC_ANALYTICS)
[0m23:54:25.826648 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_OSTRICH_PUBLIC_ANALYTICS"
[0m23:54:25.826862 [debug] [ThreadPool]: On list_USER_DB_OSTRICH_PUBLIC_ANALYTICS: show objects in USER_DB_OSTRICH.PUBLIC_ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.0rc1", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_OSTRICH_PUBLIC_ANALYTICS"} */;
[0m23:54:25.927865 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.101 seconds
[0m23:54:25.929459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3df72350-66d8-47a8-8609-667aaea962f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85b1a180>]}
[0m23:54:25.932381 [debug] [Thread-1 (]: Began running node test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316
[0m23:54:25.932725 [info ] [Thread-1 (]: 1 of 5 START test accepted_values_mart_stock_analysis_record_type__historical__forecast  [RUN]
[0m23:54:25.933586 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_OSTRICH_PUBLIC_ANALYTICS, now test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316)
[0m23:54:25.933857 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316
[0m23:54:25.942887 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316"
[0m23:54:25.944097 [debug] [Thread-1 (]: Began executing node test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316
[0m23:54:25.955652 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316"
[0m23:54:25.956786 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316"
[0m23:54:25.957025 [debug] [Thread-1 (]: On test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        record_type as value_field,
        count(*) as n_records

    from USER_DB_OSTRICH.PUBLIC_ANALYTICS.mart_stock_analysis
    group by record_type

)

select *
from all_values
where value_field not in (
    'historical','forecast'
)



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.0rc1", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316"} */
[0m23:54:26.162685 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.205 seconds
[0m23:54:26.177643 [info ] [Thread-1 (]: 1 of 5 PASS accepted_values_mart_stock_analysis_record_type__historical__forecast  [[32mPASS[0m in 0.24s]
[0m23:54:26.178544 [debug] [Thread-1 (]: Finished running node test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316
[0m23:54:26.179067 [debug] [Thread-1 (]: Began running node test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5
[0m23:54:26.179583 [info ] [Thread-1 (]: 2 of 5 START test not_null_mart_stock_analysis_date ............................ [RUN]
[0m23:54:26.180390 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316, now test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5)
[0m23:54:26.180808 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5
[0m23:54:26.186941 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5"
[0m23:54:26.188111 [debug] [Thread-1 (]: Began executing node test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5
[0m23:54:26.191432 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5"
[0m23:54:26.192494 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5"
[0m23:54:26.192819 [debug] [Thread-1 (]: On test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date
from USER_DB_OSTRICH.PUBLIC_ANALYTICS.mart_stock_analysis
where date is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.0rc1", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5"} */
[0m23:54:26.559600 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.366 seconds
[0m23:54:26.563889 [info ] [Thread-1 (]: 2 of 5 PASS not_null_mart_stock_analysis_date .................................. [[32mPASS[0m in 0.38s]
[0m23:54:26.565609 [debug] [Thread-1 (]: Finished running node test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5
[0m23:54:26.566159 [debug] [Thread-1 (]: Began running node test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e
[0m23:54:26.566819 [info ] [Thread-1 (]: 3 of 5 START test not_null_mart_stock_analysis_symbol .......................... [RUN]
[0m23:54:26.567749 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5, now test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e)
[0m23:54:26.568223 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e
[0m23:54:26.574404 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e"
[0m23:54:26.576180 [debug] [Thread-1 (]: Began executing node test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e
[0m23:54:26.579286 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e"
[0m23:54:26.580911 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e"
[0m23:54:26.581325 [debug] [Thread-1 (]: On test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select symbol
from USER_DB_OSTRICH.PUBLIC_ANALYTICS.mart_stock_analysis
where symbol is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.0rc1", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e"} */
[0m23:54:26.810132 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.228 seconds
[0m23:54:26.812934 [info ] [Thread-1 (]: 3 of 5 PASS not_null_mart_stock_analysis_symbol ................................ [[32mPASS[0m in 0.25s]
[0m23:54:26.814027 [debug] [Thread-1 (]: Finished running node test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e
[0m23:54:26.814498 [debug] [Thread-1 (]: Began running node test.stock_analytics.test_forecast_dates_future
[0m23:54:26.815013 [info ] [Thread-1 (]: 4 of 5 START test test_forecast_dates_future ................................... [RUN]
[0m23:54:26.815870 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e, now test.stock_analytics.test_forecast_dates_future)
[0m23:54:26.816343 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.test_forecast_dates_future
[0m23:54:26.819264 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.test_forecast_dates_future"
[0m23:54:26.821193 [debug] [Thread-1 (]: Began executing node test.stock_analytics.test_forecast_dates_future
[0m23:54:26.823276 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.test_forecast_dates_future"
[0m23:54:26.824552 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.test_forecast_dates_future"
[0m23:54:26.824889 [debug] [Thread-1 (]: On test.stock_analytics.test_forecast_dates_future: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- Fail if any forecast date is not strictly after the latest historical date for that symbol.
with max_hist as (
  select symbol, max(date) as max_hist_date
  from USER_DB_OSTRICH.PUBLIC_ANALYTICS.mart_stock_analysis
  where record_type = 'historical'
  group by 1
)

select f.symbol, f.date, f.record_type, f.forecast_price, m.max_hist_date
from USER_DB_OSTRICH.PUBLIC_ANALYTICS.mart_stock_analysis f
join max_hist m using (symbol)
where f.record_type = 'forecast'
  and f.date <= m.max_hist_date
  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.0rc1", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.test_forecast_dates_future"} */
[0m23:54:27.174379 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.349 seconds
[0m23:54:27.178446 [info ] [Thread-1 (]: 4 of 5 PASS test_forecast_dates_future ......................................... [[32mPASS[0m in 0.36s]
[0m23:54:27.180342 [debug] [Thread-1 (]: Finished running node test.stock_analytics.test_forecast_dates_future
[0m23:54:27.181269 [debug] [Thread-1 (]: Began running node test.stock_analytics.unique_mart_stock_analysis_pk_symbol_date.2ccccb8eaa
[0m23:54:27.183007 [info ] [Thread-1 (]: 5 of 5 START test unique_mart_stock_analysis_pk_symbol_date .................... [RUN]
[0m23:54:27.184450 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.test_forecast_dates_future, now test.stock_analytics.unique_mart_stock_analysis_pk_symbol_date.2ccccb8eaa)
[0m23:54:27.185016 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.unique_mart_stock_analysis_pk_symbol_date.2ccccb8eaa
[0m23:54:27.193978 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.unique_mart_stock_analysis_pk_symbol_date.2ccccb8eaa"
[0m23:54:27.195690 [debug] [Thread-1 (]: Began executing node test.stock_analytics.unique_mart_stock_analysis_pk_symbol_date.2ccccb8eaa
[0m23:54:27.199119 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.unique_mart_stock_analysis_pk_symbol_date.2ccccb8eaa"
[0m23:54:27.200689 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.unique_mart_stock_analysis_pk_symbol_date.2ccccb8eaa"
[0m23:54:27.201121 [debug] [Thread-1 (]: On test.stock_analytics.unique_mart_stock_analysis_pk_symbol_date.2ccccb8eaa: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    pk_symbol_date as unique_field,
    count(*) as n_records

from USER_DB_OSTRICH.PUBLIC_ANALYTICS.mart_stock_analysis
where pk_symbol_date is not null
group by pk_symbol_date
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.0rc1", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.unique_mart_stock_analysis_pk_symbol_date.2ccccb8eaa"} */
[0m23:54:27.417068 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.215 seconds
[0m23:54:27.420849 [info ] [Thread-1 (]: 5 of 5 PASS unique_mart_stock_analysis_pk_symbol_date .......................... [[32mPASS[0m in 0.24s]
[0m23:54:27.422413 [debug] [Thread-1 (]: Finished running node test.stock_analytics.unique_mart_stock_analysis_pk_symbol_date.2ccccb8eaa
[0m23:54:27.424455 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:54:27.425031 [debug] [MainThread]: Connection 'test.stock_analytics.unique_mart_stock_analysis_pk_symbol_date.2ccccb8eaa' was left open.
[0m23:54:27.425419 [debug] [MainThread]: On test.stock_analytics.unique_mart_stock_analysis_pk_symbol_date.2ccccb8eaa: Close
[0m23:54:27.558740 [info ] [MainThread]: 
[0m23:54:27.560113 [info ] [MainThread]: Finished running 5 data tests in 0 hours 0 minutes and 2.32 seconds (2.32s).
[0m23:54:27.562933 [debug] [MainThread]: Command end result
[0m23:54:27.598258 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/stock_analytics/target/manifest.json
[0m23:54:27.600039 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/stock_analytics/target/semantic_manifest.json
[0m23:54:27.604465 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/stock_analytics/target/run_results.json
[0m23:54:27.604719 [info ] [MainThread]: 
[0m23:54:27.605225 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:54:27.605565 [info ] [MainThread]: 
[0m23:54:27.605929 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m23:54:27.606668 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 2.8231556, "process_in_blocks": "0", "process_kernel_time": 0.154115, "process_mem_max_rss": "145804", "process_out_blocks": "2246", "process_user_time": 1.578143}
[0m23:54:27.606993 [debug] [MainThread]: Command `dbt test` succeeded at 23:54:27.606927 after 2.82 seconds
[0m23:54:27.607249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83b2bb60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83b2a570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82354d10>]}
[0m23:54:27.607466 [debug] [MainThread]: Flushing usage events
[0m23:54:27.937498 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:00:02.371308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9943950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa214bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa004470>]}


============================== 03:00:02.375771 | 84a9682b-2d58-4015-8425-2e4ee9aa2c6d ==============================
[0m03:00:02.375771 [info ] [MainThread]: Running with dbt=1.11.0-rc1
[0m03:00:02.377170 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'debug': 'False', 'use_colors': 'True', 'log_path': '/opt/airflow/dbt/stock_analytics/logs', 'empty': 'None', 'version_check': 'True', 'partial_parse': 'True', 'no_print': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'indirect_selection': 'eager', 'printer_width': '80', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'log_format': 'default', 'write_json': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/opt/airflow/dbt', 'invocation_command': 'dbt debug --profiles-dir /opt/airflow/dbt', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True'}
[0m03:00:02.381523 [info ] [MainThread]: dbt version: 1.11.0-rc1
[0m03:00:02.382212 [info ] [MainThread]: python version: 3.12.5
[0m03:00:02.382528 [info ] [MainThread]: python path: /opt/airflow/dbt_venv/bin/python3.12
[0m03:00:02.383078 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.36
[0m03:00:02.488403 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m03:00:02.489203 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m03:00:02.489539 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m03:00:02.523174 [info ] [MainThread]: Using profiles dir at /opt/airflow/dbt
[0m03:00:02.523710 [info ] [MainThread]: Using profiles.yml file at /opt/airflow/dbt/profiles.yml
[0m03:00:02.524051 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/dbt/stock_analytics/dbt_project.yml
[0m03:00:02.524530 [info ] [MainThread]: adapter type: snowflake
[0m03:00:02.524731 [info ] [MainThread]: adapter version: 1.10.3
[0m03:00:02.583438 [info ] [MainThread]: Configuration:
[0m03:00:02.583962 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m03:00:02.584212 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m03:00:02.584532 [info ] [MainThread]: Required dependencies:
[0m03:00:02.584782 [debug] [MainThread]: Executing "git --help"
[0m03:00:02.586674 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m03:00:02.586956 [debug] [MainThread]: STDERR: "b''"
[0m03:00:02.587146 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m03:00:02.587451 [info ] [MainThread]: Connection:
[0m03:00:02.588535 [info ] [MainThread]:   account: sfedu02-lvb17920
[0m03:00:02.588756 [info ] [MainThread]:   user: OSTRICH
[0m03:00:02.589304 [info ] [MainThread]:   database: USER_DB_OSTRICH
[0m03:00:02.589553 [info ] [MainThread]:   warehouse: OSTRICH_QUERY_WH
[0m03:00:02.589804 [info ] [MainThread]:   role: TRAINING_ROLE
[0m03:00:02.590024 [info ] [MainThread]:   schema: PUBLIC
[0m03:00:02.590293 [info ] [MainThread]:   authenticator: None
[0m03:00:02.590451 [info ] [MainThread]:   oauth_client_id: None
[0m03:00:02.590630 [info ] [MainThread]:   query_tag: None
[0m03:00:02.590764 [info ] [MainThread]:   client_session_keep_alive: False
[0m03:00:02.590950 [info ] [MainThread]:   host: None
[0m03:00:02.591133 [info ] [MainThread]:   port: None
[0m03:00:02.591320 [info ] [MainThread]:   proxy_host: None
[0m03:00:02.591468 [info ] [MainThread]:   proxy_port: None
[0m03:00:02.591639 [info ] [MainThread]:   protocol: None
[0m03:00:02.591801 [info ] [MainThread]:   connect_retries: 1
[0m03:00:02.591978 [info ] [MainThread]:   connect_timeout: None
[0m03:00:02.592148 [info ] [MainThread]:   retry_on_database_errors: False
[0m03:00:02.592366 [info ] [MainThread]:   retry_all: False
[0m03:00:02.592518 [info ] [MainThread]:   insecure_mode: False
[0m03:00:02.592697 [info ] [MainThread]:   reuse_connections: True
[0m03:00:02.592850 [info ] [MainThread]:   s3_stage_vpce_dns_name: None
[0m03:00:02.593081 [info ] [MainThread]:   platform_detection_timeout_seconds: 0.0
[0m03:00:02.593568 [info ] [MainThread]: Registered adapter: snowflake=1.10.3
[0m03:00:02.639403 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m03:00:02.654980 [debug] [MainThread]: Using snowflake connection "debug"
[0m03:00:02.655390 [debug] [MainThread]: On debug: select 1 as id
[0m03:00:02.655625 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:00:03.081651 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.426 seconds
[0m03:00:03.083331 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m03:00:03.084334 [info ] [MainThread]: [32mAll checks passed![0m
[0m03:00:03.086031 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.7425913, "process_in_blocks": "0", "process_kernel_time": 0.180497, "process_mem_max_rss": "137128", "process_out_blocks": "30", "process_user_time": 1.551445}
[0m03:00:03.086956 [debug] [MainThread]: Command `dbt debug` succeeded at 03:00:03.086773 after 0.74 seconds
[0m03:00:03.087658 [debug] [MainThread]: Connection 'debug' was left open.
[0m03:00:03.088341 [debug] [MainThread]: On debug: Close
[0m03:00:03.287517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7d392e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa79a3710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9980980>]}
[0m03:00:03.288468 [debug] [MainThread]: Flushing usage events
[0m03:00:03.733507 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:00:05.227071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffadefedb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad392270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad8275f0>]}


============================== 03:00:05.230146 | 7ae72799-6bef-4d56-8ab0-e8cac7cbef36 ==============================
[0m03:00:05.230146 [info ] [MainThread]: Running with dbt=1.11.0-rc1
[0m03:00:05.230636 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'static_parser': 'True', 'introspect': 'True', 'quiet': 'False', 'version_check': 'True', 'empty': 'False', 'log_path': '/opt/airflow/dbt/stock_analytics/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'warn_error': 'None', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'use_colors': 'True', 'log_cache_events': 'False', 'invocation_command': 'dbt run -s mart_stock_analysis --profiles-dir /opt/airflow/dbt', 'partial_parse': 'True', 'log_format': 'default', 'printer_width': '80', 'cache_selected_only': 'False'}
[0m03:00:05.314811 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m03:00:05.315201 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m03:00:05.315434 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m03:00:05.381792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7ae72799-6bef-4d56-8ab0-e8cac7cbef36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffada403e0>]}
[0m03:00:05.405667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7ae72799-6bef-4d56-8ab0-e8cac7cbef36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffababd910>]}
[0m03:00:05.406085 [info ] [MainThread]: Registered adapter: snowflake=1.10.3
[0m03:00:05.442875 [debug] [MainThread]: checksum: bdedcbc4566463a53095072aa091a5f5b73db413e58224228390aa7e9748abcc, vars: {}, profile: , target: , version: 1.11.0rc1
[0m03:00:05.503728 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:00:05.503977 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:00:05.523905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7ae72799-6bef-4d56-8ab0-e8cac7cbef36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab7d8890>]}
[0m03:00:05.596743 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/stock_analytics/target/manifest.json
[0m03:00:05.598197 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/stock_analytics/target/semantic_manifest.json
[0m03:00:05.607802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7ae72799-6bef-4d56-8ab0-e8cac7cbef36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab50aae0>]}
[0m03:00:05.608075 [info ] [MainThread]: Found 3 models, 11 data tests, 2 sources, 504 macros
[0m03:00:05.608456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7ae72799-6bef-4d56-8ab0-e8cac7cbef36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab4fc2c0>]}
[0m03:00:05.609226 [info ] [MainThread]: 
[0m03:00:05.609518 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:00:05.609834 [info ] [MainThread]: 
[0m03:00:05.610169 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:00:05.610672 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_OSTRICH'
[0m03:00:05.626862 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_OSTRICH"
[0m03:00:05.627129 [debug] [ThreadPool]: On list_USER_DB_OSTRICH: show terse schemas in database USER_DB_OSTRICH
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.0rc1", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_OSTRICH"} */
[0m03:00:05.627339 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:00:06.137918 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.510 seconds
[0m03:00:06.145553 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_OSTRICH, now list_USER_DB_OSTRICH_PUBLIC_ANALYTICS)
[0m03:00:06.162826 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_OSTRICH_PUBLIC_ANALYTICS"
[0m03:00:06.163601 [debug] [ThreadPool]: On list_USER_DB_OSTRICH_PUBLIC_ANALYTICS: show objects in USER_DB_OSTRICH.PUBLIC_ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.0rc1", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_OSTRICH_PUBLIC_ANALYTICS"} */;
[0m03:00:06.349324 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.185 seconds
[0m03:00:06.353696 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_OSTRICH_PUBLIC_ANALYTICS, now list_USER_DB_OSTRICH_PUBLIC_STAGING)
[0m03:00:06.360332 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_OSTRICH_PUBLIC_STAGING"
[0m03:00:06.362810 [debug] [ThreadPool]: On list_USER_DB_OSTRICH_PUBLIC_STAGING: show objects in USER_DB_OSTRICH.PUBLIC_STAGING
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.0rc1", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_OSTRICH_PUBLIC_STAGING"} */;
[0m03:00:06.501899 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.136 seconds
[0m03:00:06.506069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7ae72799-6bef-4d56-8ab0-e8cac7cbef36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffabaea4e0>]}
[0m03:00:06.513080 [debug] [Thread-1 (]: Began running node model.stock_analytics.mart_stock_analysis
[0m03:00:06.514317 [info ] [Thread-1 (]: 1 of 1 START sql table model PUBLIC_ANALYTICS.mart_stock_analysis .............. [RUN]
[0m03:00:06.515825 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_OSTRICH_PUBLIC_STAGING, now model.stock_analytics.mart_stock_analysis)
[0m03:00:06.516205 [debug] [Thread-1 (]: Began compiling node model.stock_analytics.mart_stock_analysis
[0m03:00:06.526510 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_analytics.mart_stock_analysis"
[0m03:00:06.532493 [debug] [Thread-1 (]: Began executing node model.stock_analytics.mart_stock_analysis
[0m03:00:06.555745 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_analytics.mart_stock_analysis"
[0m03:00:06.557381 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.mart_stock_analysis"
[0m03:00:06.557661 [debug] [Thread-1 (]: On model.stock_analytics.mart_stock_analysis: create or replace transient table USER_DB_OSTRICH.PUBLIC_ANALYTICS.mart_stock_analysis
    
    
    
    as (

-- Historical slice
with hist as (
  select
    symbol,
    date,
    close                  as actual_price,
    cast(null as float)    as forecast_price,
    cast(null as float)    as lower_bound,
    cast(null as float)    as upper_bound,
    'historical'           as record_type,
    concat(symbol, '|', to_varchar(date)) as pk_symbol_date
  from USER_DB_OSTRICH.PUBLIC_STAGING.stg_market_data
),

-- Forecast slice
fut as (
  select
    symbol,
    date,
    cast(null as float)    as actual_price,
    forecast               as forecast_price,
    lower_bound,
    upper_bound,
    'forecast'             as record_type,
    concat(symbol, '|', to_varchar(date)) as pk_symbol_date
  from USER_DB_OSTRICH.PUBLIC_STAGING.stg_market_forecast
),

unioned as (
  select * from hist
  union all
  select * from fut
)

select *
from (
  select
    *,
    row_number() over (
      -- 1. PARTITION ONLY BY KEY (remove record_type)
      partition by symbol, date
      -- 2. PRIORITIZE HISTORICAL DATA
      order by 
        case when record_type = 'historical' then 1 else 2 end asc,
        date desc
    ) as rn
  from unioned
)
where rn = 1
    )

/* {"app": "dbt", "dbt_version": "1.11.0rc1", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.mart_stock_analysis"} */;
[0m03:00:08.731625 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.173 seconds
[0m03:00:08.761333 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ae72799-6bef-4d56-8ab0-e8cac7cbef36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf9f2000>]}
[0m03:00:08.762296 [info ] [Thread-1 (]: 1 of 1 OK created sql table model PUBLIC_ANALYTICS.mart_stock_analysis ......... [[32mSUCCESS 1[0m in 2.24s]
[0m03:00:08.763606 [debug] [Thread-1 (]: Finished running node model.stock_analytics.mart_stock_analysis
[0m03:00:08.765733 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:00:08.766340 [debug] [MainThread]: Connection 'model.stock_analytics.mart_stock_analysis' was left open.
[0m03:00:08.766984 [debug] [MainThread]: On model.stock_analytics.mart_stock_analysis: Close
[0m03:00:08.883673 [info ] [MainThread]: 
[0m03:00:08.885088 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.27 seconds (3.27s).
[0m03:00:08.886396 [debug] [MainThread]: Command end result
[0m03:00:08.921436 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/stock_analytics/target/manifest.json
[0m03:00:08.923193 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/stock_analytics/target/semantic_manifest.json
[0m03:00:08.927580 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/stock_analytics/target/run_results.json
[0m03:00:08.927830 [info ] [MainThread]: 
[0m03:00:08.928313 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:00:08.928523 [info ] [MainThread]: 
[0m03:00:08.928799 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m03:00:08.929564 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.7250223, "process_in_blocks": "0", "process_kernel_time": 0.122376, "process_mem_max_rss": "144528", "process_out_blocks": "2219", "process_user_time": 1.638825}
[0m03:00:08.929883 [debug] [MainThread]: Command `dbt run` succeeded at 03:00:08.929820 after 3.73 seconds
[0m03:00:08.930171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad267200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffadeffe60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae2cd580>]}
[0m03:00:08.930407 [debug] [MainThread]: Flushing usage events
[0m03:00:09.273075 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:00:11.469452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7fbf4ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e77fa70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ecc4980>]}


============================== 03:00:11.472525 | 64e96641-f07c-43a1-b556-2cb5160c7576 ==============================
[0m03:00:11.472525 [info ] [MainThread]: Running with dbt=1.11.0-rc1
[0m03:00:11.472989 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'static_parser': 'True', 'printer_width': '80', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'debug': 'False', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'use_colors': 'True', 'fail_fast': 'False', 'no_print': 'None', 'log_cache_events': 'False', 'warn_error': 'None', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'empty': 'None', 'partial_parse': 'True', 'version_check': 'True', 'log_format': 'default', 'invocation_command': 'dbt test -s mart_stock_analysis --profiles-dir /opt/airflow/dbt', 'profiles_dir': '/opt/airflow/dbt', 'quiet': 'False', 'log_path': '/opt/airflow/dbt/stock_analytics/logs'}
[0m03:00:11.552813 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m03:00:11.553160 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m03:00:11.553362 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m03:00:11.618037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '64e96641-f07c-43a1-b556-2cb5160c7576', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c69cb60>]}
[0m03:00:11.641112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '64e96641-f07c-43a1-b556-2cb5160c7576', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cdb3b30>]}
[0m03:00:11.641515 [info ] [MainThread]: Registered adapter: snowflake=1.10.3
[0m03:00:11.675954 [debug] [MainThread]: checksum: bdedcbc4566463a53095072aa091a5f5b73db413e58224228390aa7e9748abcc, vars: {}, profile: , target: , version: 1.11.0rc1
[0m03:00:11.731009 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:00:11.731302 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:00:11.752301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '64e96641-f07c-43a1-b556-2cb5160c7576', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ddc82f0>]}
[0m03:00:11.825411 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/stock_analytics/target/manifest.json
[0m03:00:11.826689 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/stock_analytics/target/semantic_manifest.json
[0m03:00:11.840651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '64e96641-f07c-43a1-b556-2cb5160c7576', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c8bc9e0>]}
[0m03:00:11.840930 [info ] [MainThread]: Found 3 models, 11 data tests, 2 sources, 504 macros
[0m03:00:11.841291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '64e96641-f07c-43a1-b556-2cb5160c7576', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c69fb60>]}
[0m03:00:11.842053 [info ] [MainThread]: 
[0m03:00:11.842316 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:00:11.842462 [info ] [MainThread]: 
[0m03:00:11.842731 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:00:11.844846 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_OSTRICH_PUBLIC_STAGING'
[0m03:00:11.862436 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_OSTRICH_PUBLIC_STAGING"
[0m03:00:11.862718 [debug] [ThreadPool]: On list_USER_DB_OSTRICH_PUBLIC_STAGING: show objects in USER_DB_OSTRICH.PUBLIC_STAGING
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.0rc1", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_OSTRICH_PUBLIC_STAGING"} */;
[0m03:00:11.862891 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:00:12.625679 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.763 seconds
[0m03:00:12.629928 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_OSTRICH_PUBLIC_STAGING, now list_USER_DB_OSTRICH_PUBLIC_ANALYTICS)
[0m03:00:12.635181 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_OSTRICH_PUBLIC_ANALYTICS"
[0m03:00:12.636003 [debug] [ThreadPool]: On list_USER_DB_OSTRICH_PUBLIC_ANALYTICS: show objects in USER_DB_OSTRICH.PUBLIC_ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.0rc1", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_OSTRICH_PUBLIC_ANALYTICS"} */;
[0m03:00:12.914815 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.278 seconds
[0m03:00:12.919101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '64e96641-f07c-43a1-b556-2cb5160c7576', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c6ce720>]}
[0m03:00:12.926564 [debug] [Thread-1 (]: Began running node test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316
[0m03:00:12.927722 [info ] [Thread-1 (]: 1 of 5 START test accepted_values_mart_stock_analysis_record_type__historical__forecast  [RUN]
[0m03:00:12.928917 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_OSTRICH_PUBLIC_ANALYTICS, now test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316)
[0m03:00:12.929530 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316
[0m03:00:12.945491 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316"
[0m03:00:12.947034 [debug] [Thread-1 (]: Began executing node test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316
[0m03:00:12.962070 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316"
[0m03:00:12.963268 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316"
[0m03:00:12.963552 [debug] [Thread-1 (]: On test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        record_type as value_field,
        count(*) as n_records

    from USER_DB_OSTRICH.PUBLIC_ANALYTICS.mart_stock_analysis
    group by record_type

)

select *
from all_values
where value_field not in (
    'historical','forecast'
)



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.0rc1", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316"} */
[0m03:00:13.281841 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.318 seconds
[0m03:00:13.293291 [info ] [Thread-1 (]: 1 of 5 PASS accepted_values_mart_stock_analysis_record_type__historical__forecast  [[32mPASS[0m in 0.36s]
[0m03:00:13.294708 [debug] [Thread-1 (]: Finished running node test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316
[0m03:00:13.295348 [debug] [Thread-1 (]: Began running node test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5
[0m03:00:13.295917 [info ] [Thread-1 (]: 2 of 5 START test not_null_mart_stock_analysis_date ............................ [RUN]
[0m03:00:13.296688 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316, now test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5)
[0m03:00:13.297229 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5
[0m03:00:13.304147 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5"
[0m03:00:13.305408 [debug] [Thread-1 (]: Began executing node test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5
[0m03:00:13.308929 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5"
[0m03:00:13.310233 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5"
[0m03:00:13.310624 [debug] [Thread-1 (]: On test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date
from USER_DB_OSTRICH.PUBLIC_ANALYTICS.mart_stock_analysis
where date is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.0rc1", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5"} */
[0m03:00:13.616571 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.305 seconds
[0m03:00:13.620991 [info ] [Thread-1 (]: 2 of 5 PASS not_null_mart_stock_analysis_date .................................. [[32mPASS[0m in 0.32s]
[0m03:00:13.622611 [debug] [Thread-1 (]: Finished running node test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5
[0m03:00:13.623545 [debug] [Thread-1 (]: Began running node test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e
[0m03:00:13.624348 [info ] [Thread-1 (]: 3 of 5 START test not_null_mart_stock_analysis_symbol .......................... [RUN]
[0m03:00:13.626254 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5, now test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e)
[0m03:00:13.627334 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e
[0m03:00:13.633646 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e"
[0m03:00:13.635374 [debug] [Thread-1 (]: Began executing node test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e
[0m03:00:13.638388 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e"
[0m03:00:13.639861 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e"
[0m03:00:13.640234 [debug] [Thread-1 (]: On test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select symbol
from USER_DB_OSTRICH.PUBLIC_ANALYTICS.mart_stock_analysis
where symbol is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.0rc1", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e"} */
[0m03:00:13.856737 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.216 seconds
[0m03:00:13.862211 [info ] [Thread-1 (]: 3 of 5 PASS not_null_mart_stock_analysis_symbol ................................ [[32mPASS[0m in 0.24s]
[0m03:00:13.864191 [debug] [Thread-1 (]: Finished running node test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e
[0m03:00:13.866598 [debug] [Thread-1 (]: Began running node test.stock_analytics.test_forecast_dates_future
[0m03:00:13.867398 [info ] [Thread-1 (]: 4 of 5 START test test_forecast_dates_future ................................... [RUN]
[0m03:00:13.868857 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e, now test.stock_analytics.test_forecast_dates_future)
[0m03:00:13.869596 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.test_forecast_dates_future
[0m03:00:13.873598 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.test_forecast_dates_future"
[0m03:00:13.876398 [debug] [Thread-1 (]: Began executing node test.stock_analytics.test_forecast_dates_future
[0m03:00:13.878614 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.test_forecast_dates_future"
[0m03:00:13.880422 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.test_forecast_dates_future"
[0m03:00:13.880824 [debug] [Thread-1 (]: On test.stock_analytics.test_forecast_dates_future: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- Fail if any forecast date is not strictly after the latest historical date for that symbol.
with max_hist as (
  select symbol, max(date) as max_hist_date
  from USER_DB_OSTRICH.PUBLIC_ANALYTICS.mart_stock_analysis
  where record_type = 'historical'
  group by 1
)

select f.symbol, f.date, f.record_type, f.forecast_price, m.max_hist_date
from USER_DB_OSTRICH.PUBLIC_ANALYTICS.mart_stock_analysis f
join max_hist m using (symbol)
where f.record_type = 'forecast'
  and f.date <= m.max_hist_date
  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.0rc1", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.test_forecast_dates_future"} */
[0m03:00:14.222414 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.341 seconds
[0m03:00:14.226513 [info ] [Thread-1 (]: 4 of 5 PASS test_forecast_dates_future ......................................... [[32mPASS[0m in 0.36s]
[0m03:00:14.228668 [debug] [Thread-1 (]: Finished running node test.stock_analytics.test_forecast_dates_future
[0m03:00:14.229500 [debug] [Thread-1 (]: Began running node test.stock_analytics.unique_mart_stock_analysis_pk_symbol_date.2ccccb8eaa
[0m03:00:14.230034 [info ] [Thread-1 (]: 5 of 5 START test unique_mart_stock_analysis_pk_symbol_date .................... [RUN]
[0m03:00:14.231253 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.test_forecast_dates_future, now test.stock_analytics.unique_mart_stock_analysis_pk_symbol_date.2ccccb8eaa)
[0m03:00:14.231875 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.unique_mart_stock_analysis_pk_symbol_date.2ccccb8eaa
[0m03:00:14.238879 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.unique_mart_stock_analysis_pk_symbol_date.2ccccb8eaa"
[0m03:00:14.240152 [debug] [Thread-1 (]: Began executing node test.stock_analytics.unique_mart_stock_analysis_pk_symbol_date.2ccccb8eaa
[0m03:00:14.242398 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.unique_mart_stock_analysis_pk_symbol_date.2ccccb8eaa"
[0m03:00:14.243635 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.unique_mart_stock_analysis_pk_symbol_date.2ccccb8eaa"
[0m03:00:14.243965 [debug] [Thread-1 (]: On test.stock_analytics.unique_mart_stock_analysis_pk_symbol_date.2ccccb8eaa: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    pk_symbol_date as unique_field,
    count(*) as n_records

from USER_DB_OSTRICH.PUBLIC_ANALYTICS.mart_stock_analysis
where pk_symbol_date is not null
group by pk_symbol_date
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.0rc1", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.unique_mart_stock_analysis_pk_symbol_date.2ccccb8eaa"} */
[0m03:00:14.527756 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.283 seconds
[0m03:00:14.531981 [info ] [Thread-1 (]: 5 of 5 PASS unique_mart_stock_analysis_pk_symbol_date .......................... [[32mPASS[0m in 0.30s]
[0m03:00:14.533187 [debug] [Thread-1 (]: Finished running node test.stock_analytics.unique_mart_stock_analysis_pk_symbol_date.2ccccb8eaa
[0m03:00:14.535800 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:00:14.536903 [debug] [MainThread]: Connection 'test.stock_analytics.unique_mart_stock_analysis_pk_symbol_date.2ccccb8eaa' was left open.
[0m03:00:14.537567 [debug] [MainThread]: On test.stock_analytics.unique_mart_stock_analysis_pk_symbol_date.2ccccb8eaa: Close
[0m03:00:14.657345 [info ] [MainThread]: 
[0m03:00:14.659240 [info ] [MainThread]: Finished running 5 data tests in 0 hours 0 minutes and 2.81 seconds (2.81s).
[0m03:00:14.661835 [debug] [MainThread]: Command end result
[0m03:00:14.697388 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/stock_analytics/target/manifest.json
[0m03:00:14.699839 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/stock_analytics/target/semantic_manifest.json
[0m03:00:14.704656 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/stock_analytics/target/run_results.json
[0m03:00:14.704891 [info ] [MainThread]: 
[0m03:00:14.705494 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:00:14.705704 [info ] [MainThread]: 
[0m03:00:14.706134 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m03:00:14.706993 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 3.2590427, "process_in_blocks": "0", "process_kernel_time": 0.101182, "process_mem_max_rss": "145616", "process_out_blocks": "2246", "process_user_time": 1.462636}
[0m03:00:14.707366 [debug] [MainThread]: Command `dbt test` succeeded at 03:00:14.707305 after 3.26 seconds
[0m03:00:14.707681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e3de600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7eb15d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7eb15370>]}
[0m03:00:14.707963 [debug] [MainThread]: Flushing usage events
[0m03:00:15.040403 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:23:44.793050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84617830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83f50530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8458bb30>]}


============================== 05:23:44.796515 | 217269c9-b6ca-49c7-9717-aa69dc894643 ==============================
[0m05:23:44.796515 [info ] [MainThread]: Running with dbt=1.11.0-rc1
[0m05:23:44.796977 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'use_colors': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'invocation_command': 'dbt debug --profiles-dir /opt/airflow/dbt', 'log_format': 'default', 'use_experimental_parser': 'False', 'profiles_dir': '/opt/airflow/dbt', 'empty': 'None', 'log_path': '/opt/airflow/dbt/stock_analytics/logs', 'static_parser': 'True', 'quiet': 'False', 'target_path': 'None', 'warn_error': 'None', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'fail_fast': 'False', 'cache_selected_only': 'False', 'printer_width': '80', 'version_check': 'True', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'write_json': 'True'}
[0m05:23:44.800921 [info ] [MainThread]: dbt version: 1.11.0-rc1
[0m05:23:44.801161 [info ] [MainThread]: python version: 3.12.5
[0m05:23:44.801308 [info ] [MainThread]: python path: /opt/airflow/dbt_venv/bin/python3.12
[0m05:23:44.801508 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.36
[0m05:23:44.890087 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m05:23:44.890418 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m05:23:44.890621 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m05:23:44.913642 [info ] [MainThread]: Using profiles dir at /opt/airflow/dbt
[0m05:23:44.914052 [info ] [MainThread]: Using profiles.yml file at /opt/airflow/dbt/profiles.yml
[0m05:23:44.914247 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/dbt/stock_analytics/dbt_project.yml
[0m05:23:44.914536 [info ] [MainThread]: adapter type: snowflake
[0m05:23:44.914716 [info ] [MainThread]: adapter version: 1.10.3
[0m05:23:44.953149 [info ] [MainThread]: Configuration:
[0m05:23:44.953432 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m05:23:44.953623 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m05:23:44.953835 [info ] [MainThread]: Required dependencies:
[0m05:23:44.954026 [debug] [MainThread]: Executing "git --help"
[0m05:23:44.959097 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m05:23:44.959334 [debug] [MainThread]: STDERR: "b''"
[0m05:23:44.959488 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m05:23:44.959703 [info ] [MainThread]: Connection:
[0m05:23:44.959851 [info ] [MainThread]:   account: sfedu02-lvb17920
[0m05:23:44.959995 [info ] [MainThread]:   user: OSTRICH
[0m05:23:44.960124 [info ] [MainThread]:   database: USER_DB_OSTRICH
[0m05:23:44.960260 [info ] [MainThread]:   warehouse: OSTRICH_QUERY_WH
[0m05:23:44.960385 [info ] [MainThread]:   role: TRAINING_ROLE
[0m05:23:44.960516 [info ] [MainThread]:   schema: PUBLIC
[0m05:23:44.960653 [info ] [MainThread]:   authenticator: None
[0m05:23:44.960807 [info ] [MainThread]:   oauth_client_id: None
[0m05:23:44.960983 [info ] [MainThread]:   query_tag: None
[0m05:23:44.961134 [info ] [MainThread]:   client_session_keep_alive: False
[0m05:23:44.961272 [info ] [MainThread]:   host: None
[0m05:23:44.961408 [info ] [MainThread]:   port: None
[0m05:23:44.961540 [info ] [MainThread]:   proxy_host: None
[0m05:23:44.961681 [info ] [MainThread]:   proxy_port: None
[0m05:23:44.961837 [info ] [MainThread]:   protocol: None
[0m05:23:44.962007 [info ] [MainThread]:   connect_retries: 1
[0m05:23:44.962208 [info ] [MainThread]:   connect_timeout: None
[0m05:23:44.962360 [info ] [MainThread]:   retry_on_database_errors: False
[0m05:23:44.962503 [info ] [MainThread]:   retry_all: False
[0m05:23:44.962645 [info ] [MainThread]:   insecure_mode: False
[0m05:23:44.962777 [info ] [MainThread]:   reuse_connections: True
[0m05:23:44.962918 [info ] [MainThread]:   s3_stage_vpce_dns_name: None
[0m05:23:44.963048 [info ] [MainThread]:   platform_detection_timeout_seconds: 0.0
[0m05:23:44.963259 [info ] [MainThread]: Registered adapter: snowflake=1.10.3
[0m05:23:44.995668 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m05:23:45.018595 [debug] [MainThread]: Using snowflake connection "debug"
[0m05:23:45.018876 [debug] [MainThread]: On debug: select 1 as id
[0m05:23:45.019072 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:23:45.565584 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.546 seconds
[0m05:23:45.566410 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m05:23:45.567019 [info ] [MainThread]: [32mAll checks passed![0m
[0m05:23:45.568686 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.7984374, "process_in_blocks": "0", "process_kernel_time": 0.182922, "process_mem_max_rss": "138268", "process_out_blocks": "2270", "process_user_time": 1.177501}
[0m05:23:45.569016 [debug] [MainThread]: Command `dbt debug` succeeded at 05:23:45.568945 after 0.80 seconds
[0m05:23:45.569299 [debug] [MainThread]: Connection 'debug' was left open.
[0m05:23:45.569493 [debug] [MainThread]: On debug: Close
[0m05:23:45.705223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8400fc80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82994170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82540aa0>]}
[0m05:23:45.706430 [debug] [MainThread]: Flushing usage events
[0m05:23:46.117677 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:23:47.191599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82ed7e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82ed47a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff831fd490>]}


============================== 05:23:47.194604 | 387a3d83-d231-4cf0-ba64-ea0593b3b072 ==============================
[0m05:23:47.194604 [info ] [MainThread]: Running with dbt=1.11.0-rc1
[0m05:23:47.195115 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/opt/airflow/dbt/stock_analytics/logs', 'no_print': 'None', 'empty': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'invocation_command': 'dbt run -s mart_stock_analysis --profiles-dir /opt/airflow/dbt', 'version_check': 'True', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'quiet': 'False', 'target_path': 'None', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'write_json': 'True', 'warn_error': 'None', 'introspect': 'True'}
[0m05:23:47.272720 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m05:23:47.273078 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m05:23:47.273304 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m05:23:47.338630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '387a3d83-d231-4cf0-ba64-ea0593b3b072', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff818ed730>]}
[0m05:23:47.361950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '387a3d83-d231-4cf0-ba64-ea0593b3b072', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83330440>]}
[0m05:23:47.362329 [info ] [MainThread]: Registered adapter: snowflake=1.10.3
[0m05:23:47.397342 [debug] [MainThread]: checksum: bdedcbc4566463a53095072aa091a5f5b73db413e58224228390aa7e9748abcc, vars: {}, profile: , target: , version: 1.11.0rc1
[0m05:23:47.456241 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:23:47.456488 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:23:47.476269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '387a3d83-d231-4cf0-ba64-ea0593b3b072', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff812dc380>]}
[0m05:23:47.554130 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/stock_analytics/target/manifest.json
[0m05:23:47.557224 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/stock_analytics/target/semantic_manifest.json
[0m05:23:47.569338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '387a3d83-d231-4cf0-ba64-ea0593b3b072', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81059280>]}
[0m05:23:47.569679 [info ] [MainThread]: Found 3 models, 11 data tests, 2 sources, 504 macros
[0m05:23:47.570083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '387a3d83-d231-4cf0-ba64-ea0593b3b072', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff818ed730>]}
[0m05:23:47.570956 [info ] [MainThread]: 
[0m05:23:47.571208 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:23:47.571407 [info ] [MainThread]: 
[0m05:23:47.571725 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m05:23:47.572245 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_OSTRICH'
[0m05:23:47.590875 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_OSTRICH"
[0m05:23:47.591154 [debug] [ThreadPool]: On list_USER_DB_OSTRICH: show terse schemas in database USER_DB_OSTRICH
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.0rc1", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_OSTRICH"} */
[0m05:23:47.591355 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:23:48.040656 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.449 seconds
[0m05:23:48.044888 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_OSTRICH, now list_USER_DB_OSTRICH_PUBLIC_STAGING)
[0m05:23:48.052711 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_OSTRICH_PUBLIC_STAGING"
[0m05:23:48.052979 [debug] [ThreadPool]: On list_USER_DB_OSTRICH_PUBLIC_STAGING: show objects in USER_DB_OSTRICH.PUBLIC_STAGING
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.0rc1", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_OSTRICH_PUBLIC_STAGING"} */;
[0m05:23:48.161961 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.109 seconds
[0m05:23:48.164305 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_OSTRICH_PUBLIC_STAGING, now list_USER_DB_OSTRICH_PUBLIC_ANALYTICS)
[0m05:23:48.167133 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_OSTRICH_PUBLIC_ANALYTICS"
[0m05:23:48.167532 [debug] [ThreadPool]: On list_USER_DB_OSTRICH_PUBLIC_ANALYTICS: show objects in USER_DB_OSTRICH.PUBLIC_ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.0rc1", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_OSTRICH_PUBLIC_ANALYTICS"} */;
[0m05:23:48.296263 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.128 seconds
[0m05:23:48.302666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '387a3d83-d231-4cf0-ba64-ea0593b3b072', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8014b0e0>]}
[0m05:23:48.307179 [debug] [Thread-1 (]: Began running node model.stock_analytics.mart_stock_analysis
[0m05:23:48.307647 [info ] [Thread-1 (]: 1 of 1 START sql table model PUBLIC_ANALYTICS.mart_stock_analysis .............. [RUN]
[0m05:23:48.308461 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_OSTRICH_PUBLIC_ANALYTICS, now model.stock_analytics.mart_stock_analysis)
[0m05:23:48.308781 [debug] [Thread-1 (]: Began compiling node model.stock_analytics.mart_stock_analysis
[0m05:23:48.315143 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_analytics.mart_stock_analysis"
[0m05:23:48.317615 [debug] [Thread-1 (]: Began executing node model.stock_analytics.mart_stock_analysis
[0m05:23:48.338208 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_analytics.mart_stock_analysis"
[0m05:23:48.339787 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.mart_stock_analysis"
[0m05:23:48.340065 [debug] [Thread-1 (]: On model.stock_analytics.mart_stock_analysis: create or replace transient table USER_DB_OSTRICH.PUBLIC_ANALYTICS.mart_stock_analysis
    
    
    
    as (

-- Historical slice
with hist as (
  select
    symbol,
    date,
    close                  as actual_price,
    cast(null as float)    as forecast_price,
    cast(null as float)    as lower_bound,
    cast(null as float)    as upper_bound,
    'historical'           as record_type,
    concat(symbol, '|', to_varchar(date)) as pk_symbol_date
  from USER_DB_OSTRICH.PUBLIC_STAGING.stg_market_data
),

-- Forecast slice
fut as (
  select
    symbol,
    date,
    cast(null as float)    as actual_price,
    forecast               as forecast_price,
    lower_bound,
    upper_bound,
    'forecast'             as record_type,
    concat(symbol, '|', to_varchar(date)) as pk_symbol_date
  from USER_DB_OSTRICH.PUBLIC_STAGING.stg_market_forecast
),

unioned as (
  select * from hist
  union all
  select * from fut
)

select *
from (
  select
    *,
    row_number() over (
      -- 1. PARTITION ONLY BY KEY (remove record_type)
      partition by symbol, date
      -- 2. PRIORITIZE HISTORICAL DATA
      order by 
        case when record_type = 'historical' then 1 else 2 end asc,
        date desc
    ) as rn
  from unioned
)
where rn = 1
    )

/* {"app": "dbt", "dbt_version": "1.11.0rc1", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.mart_stock_analysis"} */;
[0m05:23:49.525778 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.185 seconds
[0m05:23:49.542093 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '387a3d83-d231-4cf0-ba64-ea0593b3b072', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8552df70>]}
[0m05:23:49.542652 [info ] [Thread-1 (]: 1 of 1 OK created sql table model PUBLIC_ANALYTICS.mart_stock_analysis ......... [[32mSUCCESS 1[0m in 1.23s]
[0m05:23:49.543282 [debug] [Thread-1 (]: Finished running node model.stock_analytics.mart_stock_analysis
[0m05:23:49.544251 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:23:49.544545 [debug] [MainThread]: Connection 'model.stock_analytics.mart_stock_analysis' was left open.
[0m05:23:49.544822 [debug] [MainThread]: On model.stock_analytics.mart_stock_analysis: Close
[0m05:23:49.656950 [info ] [MainThread]: 
[0m05:23:49.657627 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.09 seconds (2.09s).
[0m05:23:49.658322 [debug] [MainThread]: Command end result
[0m05:23:49.681811 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/stock_analytics/target/manifest.json
[0m05:23:49.683231 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/stock_analytics/target/semantic_manifest.json
[0m05:23:49.686948 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/stock_analytics/target/run_results.json
[0m05:23:49.687179 [info ] [MainThread]: 
[0m05:23:49.687555 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:23:49.687754 [info ] [MainThread]: 
[0m05:23:49.687989 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m05:23:49.688535 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.5182054, "process_in_blocks": "0", "process_kernel_time": 0.100027, "process_mem_max_rss": "144520", "process_out_blocks": "2219", "process_user_time": 1.323369}
[0m05:23:49.688806 [debug] [MainThread]: Command `dbt run` succeeded at 05:23:49.688764 after 2.52 seconds
[0m05:23:49.689021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff831fd490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82d590d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8141dee0>]}
[0m05:23:49.689237 [debug] [MainThread]: Flushing usage events
[0m05:23:50.020670 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:23:51.671613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bafc8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b6cb0e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bc9a180>]}


============================== 05:23:51.674650 | dbcb5a4a-51e6-4e17-8067-7557e38e2acb ==============================
[0m05:23:51.674650 [info ] [MainThread]: Running with dbt=1.11.0-rc1
[0m05:23:51.675119 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'cache_selected_only': 'False', 'invocation_command': 'dbt test -s mart_stock_analysis --profiles-dir /opt/airflow/dbt', 'write_json': 'True', 'log_path': '/opt/airflow/dbt/stock_analytics/logs', 'printer_width': '80', 'target_path': 'None', 'introspect': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'profiles_dir': '/opt/airflow/dbt', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'empty': 'None', 'no_print': 'None', 'quiet': 'False', 'log_cache_events': 'False', 'static_parser': 'True', 'use_colors': 'True', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:23:51.756490 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m05:23:51.756804 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m05:23:51.757001 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m05:23:51.820687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dbcb5a4a-51e6-4e17-8067-7557e38e2acb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7dd12d20>]}
[0m05:23:51.843416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dbcb5a4a-51e6-4e17-8067-7557e38e2acb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a285670>]}
[0m05:23:51.843795 [info ] [MainThread]: Registered adapter: snowflake=1.10.3
[0m05:23:51.877878 [debug] [MainThread]: checksum: bdedcbc4566463a53095072aa091a5f5b73db413e58224228390aa7e9748abcc, vars: {}, profile: , target: , version: 1.11.0rc1
[0m05:23:51.934618 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:23:51.934924 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:23:51.956638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dbcb5a4a-51e6-4e17-8067-7557e38e2acb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79ad2540>]}
[0m05:23:52.031154 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/stock_analytics/target/manifest.json
[0m05:23:52.032450 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/stock_analytics/target/semantic_manifest.json
[0m05:23:52.046398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dbcb5a4a-51e6-4e17-8067-7557e38e2acb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79bc07d0>]}
[0m05:23:52.046680 [info ] [MainThread]: Found 3 models, 11 data tests, 2 sources, 504 macros
[0m05:23:52.047022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dbcb5a4a-51e6-4e17-8067-7557e38e2acb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7982ba70>]}
[0m05:23:52.047773 [info ] [MainThread]: 
[0m05:23:52.048003 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:23:52.048197 [info ] [MainThread]: 
[0m05:23:52.048458 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m05:23:52.050438 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_OSTRICH_PUBLIC_ANALYTICS'
[0m05:23:52.067869 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_OSTRICH_PUBLIC_ANALYTICS"
[0m05:23:52.068115 [debug] [ThreadPool]: On list_USER_DB_OSTRICH_PUBLIC_ANALYTICS: show objects in USER_DB_OSTRICH.PUBLIC_ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.0rc1", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_OSTRICH_PUBLIC_ANALYTICS"} */;
[0m05:23:52.068308 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:23:52.581557 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.513 seconds
[0m05:23:52.584789 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_OSTRICH_PUBLIC_ANALYTICS, now list_USER_DB_OSTRICH_PUBLIC_STAGING)
[0m05:23:52.588033 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_OSTRICH_PUBLIC_STAGING"
[0m05:23:52.588424 [debug] [ThreadPool]: On list_USER_DB_OSTRICH_PUBLIC_STAGING: show objects in USER_DB_OSTRICH.PUBLIC_STAGING
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.0rc1", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_OSTRICH_PUBLIC_STAGING"} */;
[0m05:23:52.716609 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.128 seconds
[0m05:23:52.721126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dbcb5a4a-51e6-4e17-8067-7557e38e2acb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff79ad2810>]}
[0m05:23:52.727857 [debug] [Thread-1 (]: Began running node test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316
[0m05:23:52.728831 [info ] [Thread-1 (]: 1 of 5 START test accepted_values_mart_stock_analysis_record_type__historical__forecast  [RUN]
[0m05:23:52.730179 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_OSTRICH_PUBLIC_STAGING, now test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316)
[0m05:23:52.730880 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316
[0m05:23:52.746659 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316"
[0m05:23:52.748010 [debug] [Thread-1 (]: Began executing node test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316
[0m05:23:52.763227 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316"
[0m05:23:52.764440 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316"
[0m05:23:52.764733 [debug] [Thread-1 (]: On test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        record_type as value_field,
        count(*) as n_records

    from USER_DB_OSTRICH.PUBLIC_ANALYTICS.mart_stock_analysis
    group by record_type

)

select *
from all_values
where value_field not in (
    'historical','forecast'
)



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.0rc1", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316"} */
[0m05:23:52.978587 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.213 seconds
[0m05:23:52.991727 [info ] [Thread-1 (]: 1 of 5 PASS accepted_values_mart_stock_analysis_record_type__historical__forecast  [[32mPASS[0m in 0.26s]
[0m05:23:52.992989 [debug] [Thread-1 (]: Finished running node test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316
[0m05:23:52.993639 [debug] [Thread-1 (]: Began running node test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5
[0m05:23:52.994230 [info ] [Thread-1 (]: 2 of 5 START test not_null_mart_stock_analysis_date ............................ [RUN]
[0m05:23:52.994920 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316, now test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5)
[0m05:23:52.995431 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5
[0m05:23:53.001770 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5"
[0m05:23:53.002965 [debug] [Thread-1 (]: Began executing node test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5
[0m05:23:53.006477 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5"
[0m05:23:53.007579 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5"
[0m05:23:53.007912 [debug] [Thread-1 (]: On test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date
from USER_DB_OSTRICH.PUBLIC_ANALYTICS.mart_stock_analysis
where date is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.0rc1", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5"} */
[0m05:23:53.232366 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.224 seconds
[0m05:23:53.236304 [info ] [Thread-1 (]: 2 of 5 PASS not_null_mart_stock_analysis_date .................................. [[32mPASS[0m in 0.24s]
[0m05:23:53.237275 [debug] [Thread-1 (]: Finished running node test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5
[0m05:23:53.237749 [debug] [Thread-1 (]: Began running node test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e
[0m05:23:53.238194 [info ] [Thread-1 (]: 3 of 5 START test not_null_mart_stock_analysis_symbol .......................... [RUN]
[0m05:23:53.238739 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5, now test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e)
[0m05:23:53.239168 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e
[0m05:23:53.243207 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e"
[0m05:23:53.244350 [debug] [Thread-1 (]: Began executing node test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e
[0m05:23:53.246546 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e"
[0m05:23:53.247789 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e"
[0m05:23:53.248130 [debug] [Thread-1 (]: On test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select symbol
from USER_DB_OSTRICH.PUBLIC_ANALYTICS.mart_stock_analysis
where symbol is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.0rc1", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e"} */
[0m05:23:53.429234 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.180 seconds
[0m05:23:53.432492 [info ] [Thread-1 (]: 3 of 5 PASS not_null_mart_stock_analysis_symbol ................................ [[32mPASS[0m in 0.19s]
[0m05:23:53.433480 [debug] [Thread-1 (]: Finished running node test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e
[0m05:23:53.434015 [debug] [Thread-1 (]: Began running node test.stock_analytics.test_forecast_dates_future
[0m05:23:53.434505 [info ] [Thread-1 (]: 4 of 5 START test test_forecast_dates_future ................................... [RUN]
[0m05:23:53.435060 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e, now test.stock_analytics.test_forecast_dates_future)
[0m05:23:53.435601 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.test_forecast_dates_future
[0m05:23:53.438682 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.test_forecast_dates_future"
[0m05:23:53.440813 [debug] [Thread-1 (]: Began executing node test.stock_analytics.test_forecast_dates_future
[0m05:23:53.442947 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.test_forecast_dates_future"
[0m05:23:53.444550 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.test_forecast_dates_future"
[0m05:23:53.444923 [debug] [Thread-1 (]: On test.stock_analytics.test_forecast_dates_future: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- Fail if any forecast date is not strictly after the latest historical date for that symbol.
with max_hist as (
  select symbol, max(date) as max_hist_date
  from USER_DB_OSTRICH.PUBLIC_ANALYTICS.mart_stock_analysis
  where record_type = 'historical'
  group by 1
)

select f.symbol, f.date, f.record_type, f.forecast_price, m.max_hist_date
from USER_DB_OSTRICH.PUBLIC_ANALYTICS.mart_stock_analysis f
join max_hist m using (symbol)
where f.record_type = 'forecast'
  and f.date <= m.max_hist_date
  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.0rc1", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.test_forecast_dates_future"} */
[0m05:23:53.726059 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.280 seconds
[0m05:23:53.730517 [info ] [Thread-1 (]: 4 of 5 PASS test_forecast_dates_future ......................................... [[32mPASS[0m in 0.30s]
[0m05:23:53.732233 [debug] [Thread-1 (]: Finished running node test.stock_analytics.test_forecast_dates_future
[0m05:23:53.733065 [debug] [Thread-1 (]: Began running node test.stock_analytics.unique_mart_stock_analysis_pk_symbol_date.2ccccb8eaa
[0m05:23:53.733792 [info ] [Thread-1 (]: 5 of 5 START test unique_mart_stock_analysis_pk_symbol_date .................... [RUN]
[0m05:23:53.734637 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.test_forecast_dates_future, now test.stock_analytics.unique_mart_stock_analysis_pk_symbol_date.2ccccb8eaa)
[0m05:23:53.735282 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.unique_mart_stock_analysis_pk_symbol_date.2ccccb8eaa
[0m05:23:53.742749 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.unique_mart_stock_analysis_pk_symbol_date.2ccccb8eaa"
[0m05:23:53.745066 [debug] [Thread-1 (]: Began executing node test.stock_analytics.unique_mart_stock_analysis_pk_symbol_date.2ccccb8eaa
[0m05:23:53.747401 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.unique_mart_stock_analysis_pk_symbol_date.2ccccb8eaa"
[0m05:23:53.749031 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.unique_mart_stock_analysis_pk_symbol_date.2ccccb8eaa"
[0m05:23:53.749434 [debug] [Thread-1 (]: On test.stock_analytics.unique_mart_stock_analysis_pk_symbol_date.2ccccb8eaa: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    pk_symbol_date as unique_field,
    count(*) as n_records

from USER_DB_OSTRICH.PUBLIC_ANALYTICS.mart_stock_analysis
where pk_symbol_date is not null
group by pk_symbol_date
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.0rc1", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.unique_mart_stock_analysis_pk_symbol_date.2ccccb8eaa"} */
[0m05:23:54.136999 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.387 seconds
[0m05:23:54.141251 [info ] [Thread-1 (]: 5 of 5 PASS unique_mart_stock_analysis_pk_symbol_date .......................... [[32mPASS[0m in 0.41s]
[0m05:23:54.143269 [debug] [Thread-1 (]: Finished running node test.stock_analytics.unique_mart_stock_analysis_pk_symbol_date.2ccccb8eaa
[0m05:23:54.145796 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:23:54.146508 [debug] [MainThread]: Connection 'test.stock_analytics.unique_mart_stock_analysis_pk_symbol_date.2ccccb8eaa' was left open.
[0m05:23:54.147162 [debug] [MainThread]: On test.stock_analytics.unique_mart_stock_analysis_pk_symbol_date.2ccccb8eaa: Close
[0m05:23:54.264452 [info ] [MainThread]: 
[0m05:23:54.266155 [info ] [MainThread]: Finished running 5 data tests in 0 hours 0 minutes and 2.22 seconds (2.22s).
[0m05:23:54.268337 [debug] [MainThread]: Command end result
[0m05:23:54.301932 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/stock_analytics/target/manifest.json
[0m05:23:54.303534 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/stock_analytics/target/semantic_manifest.json
[0m05:23:54.307891 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/stock_analytics/target/run_results.json
[0m05:23:54.308125 [info ] [MainThread]: 
[0m05:23:54.308565 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:23:54.308782 [info ] [MainThread]: 
[0m05:23:54.309016 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m05:23:54.309630 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 2.658661, "process_in_blocks": "0", "process_kernel_time": 0.107784, "process_mem_max_rss": "145812", "process_out_blocks": "2246", "process_user_time": 1.414168}
[0m05:23:54.309947 [debug] [MainThread]: Command `dbt test` succeeded at 05:23:54.309890 after 2.66 seconds
[0m05:23:54.310220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b2e7e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e16edb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a092930>]}
[0m05:23:54.310477 [debug] [MainThread]: Flushing usage events
[0m05:23:54.639830 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:23:58.831186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a9fbd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d8c2b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d200380>]}


============================== 05:23:58.834682 | a7acac12-3b28-4a4d-84dc-801f76c10c03 ==============================
[0m05:23:58.834682 [info ] [MainThread]: Running with dbt=1.11.0-rc1
[0m05:23:58.835164 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'empty': 'None', 'static_parser': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'partial_parse': 'True', 'version_check': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'fail_fast': 'False', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'write_json': 'True', 'log_path': '/opt/airflow/dbt/stock_analytics/logs', 'profiles_dir': '/opt/airflow/dbt', 'target_path': 'None', 'log_format': 'default', 'use_colors': 'True', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'invocation_command': 'dbt debug --profiles-dir /opt/airflow/dbt', 'debug': 'False'}
[0m05:23:58.839015 [info ] [MainThread]: dbt version: 1.11.0-rc1
[0m05:23:58.839414 [info ] [MainThread]: python version: 3.12.5
[0m05:23:58.839606 [info ] [MainThread]: python path: /opt/airflow/dbt_venv/bin/python3.12
[0m05:23:58.839889 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.36
[0m05:23:58.922190 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m05:23:58.922525 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m05:23:58.922771 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m05:23:58.944692 [info ] [MainThread]: Using profiles dir at /opt/airflow/dbt
[0m05:23:58.945096 [info ] [MainThread]: Using profiles.yml file at /opt/airflow/dbt/profiles.yml
[0m05:23:58.945275 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/dbt/stock_analytics/dbt_project.yml
[0m05:23:58.945546 [info ] [MainThread]: adapter type: snowflake
[0m05:23:58.945746 [info ] [MainThread]: adapter version: 1.10.3
[0m05:23:58.984141 [info ] [MainThread]: Configuration:
[0m05:23:58.984449 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m05:23:58.984632 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m05:23:58.984847 [info ] [MainThread]: Required dependencies:
[0m05:23:58.985036 [debug] [MainThread]: Executing "git --help"
[0m05:23:58.986137 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m05:23:58.986322 [debug] [MainThread]: STDERR: "b''"
[0m05:23:58.986460 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m05:23:58.986666 [info ] [MainThread]: Connection:
[0m05:23:58.986881 [info ] [MainThread]:   account: sfedu02-lvb17920
[0m05:23:58.987046 [info ] [MainThread]:   user: OSTRICH
[0m05:23:58.987270 [info ] [MainThread]:   database: USER_DB_OSTRICH
[0m05:23:58.987459 [info ] [MainThread]:   warehouse: OSTRICH_QUERY_WH
[0m05:23:58.987662 [info ] [MainThread]:   role: TRAINING_ROLE
[0m05:23:58.987820 [info ] [MainThread]:   schema: PUBLIC
[0m05:23:58.988015 [info ] [MainThread]:   authenticator: None
[0m05:23:58.988197 [info ] [MainThread]:   oauth_client_id: None
[0m05:23:58.988488 [info ] [MainThread]:   query_tag: None
[0m05:23:58.988676 [info ] [MainThread]:   client_session_keep_alive: False
[0m05:23:58.988841 [info ] [MainThread]:   host: None
[0m05:23:58.989028 [info ] [MainThread]:   port: None
[0m05:23:58.989199 [info ] [MainThread]:   proxy_host: None
[0m05:23:58.989432 [info ] [MainThread]:   proxy_port: None
[0m05:23:58.989741 [info ] [MainThread]:   protocol: None
[0m05:23:58.990015 [info ] [MainThread]:   connect_retries: 1
[0m05:23:58.990348 [info ] [MainThread]:   connect_timeout: None
[0m05:23:58.990735 [info ] [MainThread]:   retry_on_database_errors: False
[0m05:23:58.990910 [info ] [MainThread]:   retry_all: False
[0m05:23:58.991116 [info ] [MainThread]:   insecure_mode: False
[0m05:23:58.991299 [info ] [MainThread]:   reuse_connections: True
[0m05:23:58.991498 [info ] [MainThread]:   s3_stage_vpce_dns_name: None
[0m05:23:58.991677 [info ] [MainThread]:   platform_detection_timeout_seconds: 0.0
[0m05:23:58.991964 [info ] [MainThread]: Registered adapter: snowflake=1.10.3
[0m05:23:59.023266 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m05:23:59.032632 [debug] [MainThread]: Using snowflake connection "debug"
[0m05:23:59.032883 [debug] [MainThread]: On debug: select 1 as id
[0m05:23:59.033059 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:23:59.465689 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.433 seconds
[0m05:23:59.466537 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m05:23:59.466777 [info ] [MainThread]: [32mAll checks passed![0m
[0m05:23:59.467426 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.6587105, "process_in_blocks": "0", "process_kernel_time": 0.062902, "process_mem_max_rss": "137100", "process_out_blocks": "30", "process_user_time": 1.056366}
[0m05:23:59.467889 [debug] [MainThread]: Command `dbt debug` succeeded at 05:23:59.467840 after 0.66 seconds
[0m05:23:59.468086 [debug] [MainThread]: Connection 'debug' was left open.
[0m05:23:59.468428 [debug] [MainThread]: On debug: Close
[0m05:23:59.583006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9aee1070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff990fff80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99a58770>]}
[0m05:23:59.583459 [debug] [MainThread]: Flushing usage events
[0m05:23:59.906208 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:24:00.998306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff844552e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84292300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84292360>]}


============================== 05:24:01.001416 | ac4cc271-a38a-4e3e-ba8b-6c2e03d965a8 ==============================
[0m05:24:01.001416 [info ] [MainThread]: Running with dbt=1.11.0-rc1
[0m05:24:01.002117 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'static_parser': 'True', 'log_format': 'default', 'no_print': 'None', 'printer_width': '80', 'profiles_dir': '/opt/airflow/dbt', 'warn_error': 'None', 'log_cache_events': 'False', 'use_colors': 'True', 'log_path': '/opt/airflow/dbt/stock_analytics/logs', 'empty': 'False', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'quiet': 'False', 'fail_fast': 'False', 'debug': 'False', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt run -s mart_stock_analysis --profiles-dir /opt/airflow/dbt', 'partial_parse': 'True', 'version_check': 'True', 'write_json': 'True', 'introspect': 'True'}
[0m05:24:01.081342 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m05:24:01.081666 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m05:24:01.081861 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m05:24:01.146892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ac4cc271-a38a-4e3e-ba8b-6c2e03d965a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff821f18b0>]}
[0m05:24:01.170336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ac4cc271-a38a-4e3e-ba8b-6c2e03d965a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff843bbe00>]}
[0m05:24:01.170740 [info ] [MainThread]: Registered adapter: snowflake=1.10.3
[0m05:24:01.205373 [debug] [MainThread]: checksum: bdedcbc4566463a53095072aa091a5f5b73db413e58224228390aa7e9748abcc, vars: {}, profile: , target: , version: 1.11.0rc1
[0m05:24:01.259982 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:24:01.260246 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:24:01.279860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ac4cc271-a38a-4e3e-ba8b-6c2e03d965a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83351250>]}
[0m05:24:01.353207 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/stock_analytics/target/manifest.json
[0m05:24:01.354541 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/stock_analytics/target/semantic_manifest.json
[0m05:24:01.363638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ac4cc271-a38a-4e3e-ba8b-6c2e03d965a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81a02a80>]}
[0m05:24:01.363880 [info ] [MainThread]: Found 3 models, 11 data tests, 2 sources, 504 macros
[0m05:24:01.364232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac4cc271-a38a-4e3e-ba8b-6c2e03d965a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81c09610>]}
[0m05:24:01.364951 [info ] [MainThread]: 
[0m05:24:01.365186 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:24:01.365347 [info ] [MainThread]: 
[0m05:24:01.365624 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m05:24:01.366177 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_OSTRICH'
[0m05:24:01.382686 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_OSTRICH"
[0m05:24:01.382969 [debug] [ThreadPool]: On list_USER_DB_OSTRICH: show terse schemas in database USER_DB_OSTRICH
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.0rc1", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_OSTRICH"} */
[0m05:24:01.383183 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:24:01.903913 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.520 seconds
[0m05:24:01.915462 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_OSTRICH, now list_USER_DB_OSTRICH_PUBLIC_STAGING)
[0m05:24:01.931181 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_OSTRICH_PUBLIC_STAGING"
[0m05:24:01.931704 [debug] [ThreadPool]: On list_USER_DB_OSTRICH_PUBLIC_STAGING: show objects in USER_DB_OSTRICH.PUBLIC_STAGING
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.0rc1", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_OSTRICH_PUBLIC_STAGING"} */;
[0m05:24:02.066023 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.134 seconds
[0m05:24:02.068460 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_OSTRICH_PUBLIC_STAGING, now list_USER_DB_OSTRICH_PUBLIC_ANALYTICS)
[0m05:24:02.070959 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_OSTRICH_PUBLIC_ANALYTICS"
[0m05:24:02.071260 [debug] [ThreadPool]: On list_USER_DB_OSTRICH_PUBLIC_ANALYTICS: show objects in USER_DB_OSTRICH.PUBLIC_ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.0rc1", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_OSTRICH_PUBLIC_ANALYTICS"} */;
[0m05:24:02.431099 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.359 seconds
[0m05:24:02.436493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac4cc271-a38a-4e3e-ba8b-6c2e03d965a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85fcdf10>]}
[0m05:24:02.443458 [debug] [Thread-1 (]: Began running node model.stock_analytics.mart_stock_analysis
[0m05:24:02.444527 [info ] [Thread-1 (]: 1 of 1 START sql table model PUBLIC_ANALYTICS.mart_stock_analysis .............. [RUN]
[0m05:24:02.447008 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_OSTRICH_PUBLIC_ANALYTICS, now model.stock_analytics.mart_stock_analysis)
[0m05:24:02.447520 [debug] [Thread-1 (]: Began compiling node model.stock_analytics.mart_stock_analysis
[0m05:24:02.455984 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_analytics.mart_stock_analysis"
[0m05:24:02.457471 [debug] [Thread-1 (]: Began executing node model.stock_analytics.mart_stock_analysis
[0m05:24:02.478967 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_analytics.mart_stock_analysis"
[0m05:24:02.480470 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.mart_stock_analysis"
[0m05:24:02.480814 [debug] [Thread-1 (]: On model.stock_analytics.mart_stock_analysis: create or replace transient table USER_DB_OSTRICH.PUBLIC_ANALYTICS.mart_stock_analysis
    
    
    
    as (

-- Historical slice
with hist as (
  select
    symbol,
    date,
    close                  as actual_price,
    cast(null as float)    as forecast_price,
    cast(null as float)    as lower_bound,
    cast(null as float)    as upper_bound,
    'historical'           as record_type,
    concat(symbol, '|', to_varchar(date)) as pk_symbol_date
  from USER_DB_OSTRICH.PUBLIC_STAGING.stg_market_data
),

-- Forecast slice
fut as (
  select
    symbol,
    date,
    cast(null as float)    as actual_price,
    forecast               as forecast_price,
    lower_bound,
    upper_bound,
    'forecast'             as record_type,
    concat(symbol, '|', to_varchar(date)) as pk_symbol_date
  from USER_DB_OSTRICH.PUBLIC_STAGING.stg_market_forecast
),

unioned as (
  select * from hist
  union all
  select * from fut
)

select *
from (
  select
    *,
    row_number() over (
      -- 1. PARTITION ONLY BY KEY (remove record_type)
      partition by symbol, date
      -- 2. PRIORITIZE HISTORICAL DATA
      order by 
        case when record_type = 'historical' then 1 else 2 end asc,
        date desc
    ) as rn
  from unioned
)
where rn = 1
    )

/* {"app": "dbt", "dbt_version": "1.11.0rc1", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.mart_stock_analysis"} */;
[0m05:24:03.660488 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.179 seconds
[0m05:24:03.689573 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac4cc271-a38a-4e3e-ba8b-6c2e03d965a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85f4e030>]}
[0m05:24:03.690315 [info ] [Thread-1 (]: 1 of 1 OK created sql table model PUBLIC_ANALYTICS.mart_stock_analysis ......... [[32mSUCCESS 1[0m in 1.24s]
[0m05:24:03.691101 [debug] [Thread-1 (]: Finished running node model.stock_analytics.mart_stock_analysis
[0m05:24:03.692402 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:24:03.692762 [debug] [MainThread]: Connection 'model.stock_analytics.mart_stock_analysis' was left open.
[0m05:24:03.693139 [debug] [MainThread]: On model.stock_analytics.mart_stock_analysis: Close
[0m05:24:03.820305 [info ] [MainThread]: 
[0m05:24:03.821404 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.45 seconds (2.45s).
[0m05:24:03.823142 [debug] [MainThread]: Command end result
[0m05:24:03.859749 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/stock_analytics/target/manifest.json
[0m05:24:03.861588 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/stock_analytics/target/semantic_manifest.json
[0m05:24:03.865533 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/stock_analytics/target/run_results.json
[0m05:24:03.865785 [info ] [MainThread]: 
[0m05:24:03.866245 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:24:03.866455 [info ] [MainThread]: 
[0m05:24:03.866706 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m05:24:03.867504 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.8906221, "process_in_blocks": "0", "process_kernel_time": 0.108038, "process_mem_max_rss": "144744", "process_out_blocks": "2219", "process_user_time": 1.403505}
[0m05:24:03.867831 [debug] [MainThread]: Command `dbt run` succeeded at 05:24:03.867776 after 2.89 seconds
[0m05:24:03.868113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87dbb0e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff821bfc80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff821bf0e0>]}
[0m05:24:03.868351 [debug] [MainThread]: Flushing usage events
[0m05:24:04.203199 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:24:05.853186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cd80ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bfc7e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bfc5bb0>]}


============================== 05:24:05.856235 | 413dfd85-d934-447f-9e50-487dcc080644 ==============================
[0m05:24:05.856235 [info ] [MainThread]: Running with dbt=1.11.0-rc1
[0m05:24:05.856695 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'debug': 'False', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'printer_width': '80', 'empty': 'None', 'static_parser': 'True', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'no_print': 'None', 'partial_parse': 'True', 'log_format': 'default', 'log_path': '/opt/airflow/dbt/stock_analytics/logs', 'warn_error': 'None', 'use_experimental_parser': 'False', 'invocation_command': 'dbt test -s mart_stock_analysis --profiles-dir /opt/airflow/dbt', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'target_path': 'None'}
[0m05:24:05.940384 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m05:24:05.940714 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m05:24:05.940905 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m05:24:06.004784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '413dfd85-d934-447f-9e50-487dcc080644', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b0ca000>]}
[0m05:24:06.027626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '413dfd85-d934-447f-9e50-487dcc080644', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b8768a0>]}
[0m05:24:06.028029 [info ] [MainThread]: Registered adapter: snowflake=1.10.3
[0m05:24:06.063026 [debug] [MainThread]: checksum: bdedcbc4566463a53095072aa091a5f5b73db413e58224228390aa7e9748abcc, vars: {}, profile: , target: , version: 1.11.0rc1
[0m05:24:06.116421 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:24:06.116647 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:24:06.136006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '413dfd85-d934-447f-9e50-487dcc080644', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8985faa0>]}
[0m05:24:06.205256 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/stock_analytics/target/manifest.json
[0m05:24:06.206546 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/stock_analytics/target/semantic_manifest.json
[0m05:24:06.220935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '413dfd85-d934-447f-9e50-487dcc080644', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff898e66c0>]}
[0m05:24:06.221260 [info ] [MainThread]: Found 3 models, 11 data tests, 2 sources, 504 macros
[0m05:24:06.221648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '413dfd85-d934-447f-9e50-487dcc080644', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89b93fb0>]}
[0m05:24:06.222445 [info ] [MainThread]: 
[0m05:24:06.222704 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m05:24:06.222865 [info ] [MainThread]: 
[0m05:24:06.223170 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m05:24:06.225353 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_OSTRICH_PUBLIC_ANALYTICS'
[0m05:24:06.246152 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_OSTRICH_PUBLIC_ANALYTICS"
[0m05:24:06.246515 [debug] [ThreadPool]: On list_USER_DB_OSTRICH_PUBLIC_ANALYTICS: show objects in USER_DB_OSTRICH.PUBLIC_ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.0rc1", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_OSTRICH_PUBLIC_ANALYTICS"} */;
[0m05:24:06.246700 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:24:06.633180 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.386 seconds
[0m05:24:06.638057 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_OSTRICH_PUBLIC_ANALYTICS, now list_USER_DB_OSTRICH_PUBLIC_STAGING)
[0m05:24:06.643575 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_OSTRICH_PUBLIC_STAGING"
[0m05:24:06.644345 [debug] [ThreadPool]: On list_USER_DB_OSTRICH_PUBLIC_STAGING: show objects in USER_DB_OSTRICH.PUBLIC_STAGING
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.0rc1", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_OSTRICH_PUBLIC_STAGING"} */;
[0m05:24:06.760260 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.115 seconds
[0m05:24:06.765216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '413dfd85-d934-447f-9e50-487dcc080644', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8af601a0>]}
[0m05:24:06.771676 [debug] [Thread-1 (]: Began running node test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316
[0m05:24:06.772742 [info ] [Thread-1 (]: 1 of 5 START test accepted_values_mart_stock_analysis_record_type__historical__forecast  [RUN]
[0m05:24:06.774322 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_OSTRICH_PUBLIC_STAGING, now test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316)
[0m05:24:06.775010 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316
[0m05:24:06.790517 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316"
[0m05:24:06.792040 [debug] [Thread-1 (]: Began executing node test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316
[0m05:24:06.808578 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316"
[0m05:24:06.809896 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316"
[0m05:24:06.810225 [debug] [Thread-1 (]: On test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        record_type as value_field,
        count(*) as n_records

    from USER_DB_OSTRICH.PUBLIC_ANALYTICS.mart_stock_analysis
    group by record_type

)

select *
from all_values
where value_field not in (
    'historical','forecast'
)



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.0rc1", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316"} */
[0m05:24:06.997532 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.187 seconds
[0m05:24:07.012870 [info ] [Thread-1 (]: 1 of 5 PASS accepted_values_mart_stock_analysis_record_type__historical__forecast  [[32mPASS[0m in 0.24s]
[0m05:24:07.014982 [debug] [Thread-1 (]: Finished running node test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316
[0m05:24:07.015703 [debug] [Thread-1 (]: Began running node test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5
[0m05:24:07.016349 [info ] [Thread-1 (]: 2 of 5 START test not_null_mart_stock_analysis_date ............................ [RUN]
[0m05:24:07.017186 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316, now test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5)
[0m05:24:07.017657 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5
[0m05:24:07.023870 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5"
[0m05:24:07.025278 [debug] [Thread-1 (]: Began executing node test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5
[0m05:24:07.028973 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5"
[0m05:24:07.030709 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5"
[0m05:24:07.031155 [debug] [Thread-1 (]: On test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date
from USER_DB_OSTRICH.PUBLIC_ANALYTICS.mart_stock_analysis
where date is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.0rc1", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5"} */
[0m05:24:07.206348 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.175 seconds
[0m05:24:07.211701 [info ] [Thread-1 (]: 2 of 5 PASS not_null_mart_stock_analysis_date .................................. [[32mPASS[0m in 0.19s]
[0m05:24:07.214711 [debug] [Thread-1 (]: Finished running node test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5
[0m05:24:07.215463 [debug] [Thread-1 (]: Began running node test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e
[0m05:24:07.216136 [info ] [Thread-1 (]: 3 of 5 START test not_null_mart_stock_analysis_symbol .......................... [RUN]
[0m05:24:07.217134 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5, now test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e)
[0m05:24:07.217663 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e
[0m05:24:07.224226 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e"
[0m05:24:07.226183 [debug] [Thread-1 (]: Began executing node test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e
[0m05:24:07.229387 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e"
[0m05:24:07.231496 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e"
[0m05:24:07.231914 [debug] [Thread-1 (]: On test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select symbol
from USER_DB_OSTRICH.PUBLIC_ANALYTICS.mart_stock_analysis
where symbol is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.0rc1", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e"} */
[0m05:24:07.444342 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.212 seconds
[0m05:24:07.448884 [info ] [Thread-1 (]: 3 of 5 PASS not_null_mart_stock_analysis_symbol ................................ [[32mPASS[0m in 0.23s]
[0m05:24:07.450802 [debug] [Thread-1 (]: Finished running node test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e
[0m05:24:07.451569 [debug] [Thread-1 (]: Began running node test.stock_analytics.test_forecast_dates_future
[0m05:24:07.452173 [info ] [Thread-1 (]: 4 of 5 START test test_forecast_dates_future ................................... [RUN]
[0m05:24:07.453242 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e, now test.stock_analytics.test_forecast_dates_future)
[0m05:24:07.453779 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.test_forecast_dates_future
[0m05:24:07.459695 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.test_forecast_dates_future"
[0m05:24:07.461923 [debug] [Thread-1 (]: Began executing node test.stock_analytics.test_forecast_dates_future
[0m05:24:07.465431 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.test_forecast_dates_future"
[0m05:24:07.467348 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.test_forecast_dates_future"
[0m05:24:07.467763 [debug] [Thread-1 (]: On test.stock_analytics.test_forecast_dates_future: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- Fail if any forecast date is not strictly after the latest historical date for that symbol.
with max_hist as (
  select symbol, max(date) as max_hist_date
  from USER_DB_OSTRICH.PUBLIC_ANALYTICS.mart_stock_analysis
  where record_type = 'historical'
  group by 1
)

select f.symbol, f.date, f.record_type, f.forecast_price, m.max_hist_date
from USER_DB_OSTRICH.PUBLIC_ANALYTICS.mart_stock_analysis f
join max_hist m using (symbol)
where f.record_type = 'forecast'
  and f.date <= m.max_hist_date
  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.0rc1", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.test_forecast_dates_future"} */
[0m05:24:07.755474 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.287 seconds
[0m05:24:07.760412 [info ] [Thread-1 (]: 4 of 5 PASS test_forecast_dates_future ......................................... [[32mPASS[0m in 0.31s]
[0m05:24:07.762359 [debug] [Thread-1 (]: Finished running node test.stock_analytics.test_forecast_dates_future
[0m05:24:07.763512 [debug] [Thread-1 (]: Began running node test.stock_analytics.unique_mart_stock_analysis_pk_symbol_date.2ccccb8eaa
[0m05:24:07.764371 [info ] [Thread-1 (]: 5 of 5 START test unique_mart_stock_analysis_pk_symbol_date .................... [RUN]
[0m05:24:07.765532 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.test_forecast_dates_future, now test.stock_analytics.unique_mart_stock_analysis_pk_symbol_date.2ccccb8eaa)
[0m05:24:07.766242 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.unique_mart_stock_analysis_pk_symbol_date.2ccccb8eaa
[0m05:24:07.774423 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.unique_mart_stock_analysis_pk_symbol_date.2ccccb8eaa"
[0m05:24:07.775993 [debug] [Thread-1 (]: Began executing node test.stock_analytics.unique_mart_stock_analysis_pk_symbol_date.2ccccb8eaa
[0m05:24:07.778375 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.unique_mart_stock_analysis_pk_symbol_date.2ccccb8eaa"
[0m05:24:07.779826 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.unique_mart_stock_analysis_pk_symbol_date.2ccccb8eaa"
[0m05:24:07.780275 [debug] [Thread-1 (]: On test.stock_analytics.unique_mart_stock_analysis_pk_symbol_date.2ccccb8eaa: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    pk_symbol_date as unique_field,
    count(*) as n_records

from USER_DB_OSTRICH.PUBLIC_ANALYTICS.mart_stock_analysis
where pk_symbol_date is not null
group by pk_symbol_date
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.0rc1", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.unique_mart_stock_analysis_pk_symbol_date.2ccccb8eaa"} */
[0m05:24:07.968028 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.187 seconds
[0m05:24:07.972804 [info ] [Thread-1 (]: 5 of 5 PASS unique_mart_stock_analysis_pk_symbol_date .......................... [[32mPASS[0m in 0.21s]
[0m05:24:07.974838 [debug] [Thread-1 (]: Finished running node test.stock_analytics.unique_mart_stock_analysis_pk_symbol_date.2ccccb8eaa
[0m05:24:07.978698 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:24:07.979679 [debug] [MainThread]: Connection 'test.stock_analytics.unique_mart_stock_analysis_pk_symbol_date.2ccccb8eaa' was left open.
[0m05:24:07.980476 [debug] [MainThread]: On test.stock_analytics.unique_mart_stock_analysis_pk_symbol_date.2ccccb8eaa: Close
[0m05:24:08.129053 [info ] [MainThread]: 
[0m05:24:08.131047 [info ] [MainThread]: Finished running 5 data tests in 0 hours 0 minutes and 1.91 seconds (1.91s).
[0m05:24:08.133464 [debug] [MainThread]: Command end result
[0m05:24:08.167446 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/stock_analytics/target/manifest.json
[0m05:24:08.169038 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/stock_analytics/target/semantic_manifest.json
[0m05:24:08.173436 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/stock_analytics/target/run_results.json
[0m05:24:08.173697 [info ] [MainThread]: 
[0m05:24:08.174149 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:24:08.174357 [info ] [MainThread]: 
[0m05:24:08.174584 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m05:24:08.175212 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 2.3427927, "process_in_blocks": "0", "process_kernel_time": 0.118592, "process_mem_max_rss": "145796", "process_out_blocks": "2246", "process_user_time": 1.504517}
[0m05:24:08.175541 [debug] [MainThread]: Command `dbt test` succeeded at 05:24:08.175486 after 2.34 seconds
[0m05:24:08.175807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d81ac00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89621cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89bc07d0>]}
[0m05:24:08.176048 [debug] [MainThread]: Flushing usage events
[0m05:24:08.506910 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:45:06.181406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff878e5970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff874be0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff874be270>]}


============================== 21:45:06.185013 | 978e322f-e113-47d5-b0a7-d813d2850f81 ==============================
[0m21:45:06.185013 [info ] [MainThread]: Running with dbt=1.11.0-rc1
[0m21:45:06.185344 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'log_cache_events': 'False', 'log_path': '/opt/airflow/dbt/stock_analytics/logs', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'no_print': 'None', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/dbt', 'use_colors': 'True', 'warn_error': 'None', 'debug': 'False', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'profiles_dir': '/opt/airflow/dbt', 'empty': 'False', 'introspect': 'True', 'log_format': 'default', 'cache_selected_only': 'False', 'static_parser': 'True', 'printer_width': '80', 'target_path': 'None', 'write_json': 'True'}
[0m21:45:06.193020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9910bb60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b63af00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b6301a0>]}


============================== 21:45:06.196351 | 2df194bc-e75b-41ec-9242-c14fd0ab65bf ==============================
[0m21:45:06.196351 [info ] [MainThread]: Running with dbt=1.11.0-rc1
[0m21:45:06.196622 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'version_check': 'True', 'quiet': 'False', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_format': 'default', 'warn_error': 'None', 'no_print': 'None', 'empty': 'None', 'cache_selected_only': 'False', 'write_json': 'True', 'profiles_dir': '/opt/airflow/dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt/stock_analytics/logs', 'use_colors': 'True', 'invocation_command': 'dbt test -s mart_stock_analysis --profiles-dir /opt/airflow/dbt', 'debug': 'False', 'partial_parse': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'target_path': 'None'}
[0m21:45:06.314070 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m21:45:06.314487 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m21:45:06.314695 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m21:45:06.315218 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m21:45:06.318425 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m21:45:06.318778 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m21:45:06.391451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '978e322f-e113-47d5-b0a7-d813d2850f81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8914ee10>]}
[0m21:45:06.395574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2df194bc-e75b-41ec-9242-c14fd0ab65bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97309b80>]}
[0m21:45:06.415688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '978e322f-e113-47d5-b0a7-d813d2850f81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86e92780>]}
[0m21:45:06.419487 [info ] [MainThread]: Registered adapter: snowflake=1.10.3
[0m21:45:06.420749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2df194bc-e75b-41ec-9242-c14fd0ab65bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9777d910>]}
[0m21:45:06.421204 [info ] [MainThread]: Registered adapter: snowflake=1.10.3
[0m21:45:06.462852 [debug] [MainThread]: checksum: bdedcbc4566463a53095072aa091a5f5b73db413e58224228390aa7e9748abcc, vars: {}, profile: , target: , version: 1.11.0rc1
[0m21:45:06.463941 [debug] [MainThread]: checksum: bdedcbc4566463a53095072aa091a5f5b73db413e58224228390aa7e9748abcc, vars: {}, profile: , target: , version: 1.11.0rc1
[0m21:45:06.534194 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m21:45:06.534580 [debug] [MainThread]: Partial parsing: added file: stock_analytics://snapshots/market_snapshot.sql
[0m21:45:06.546758 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m21:45:06.547102 [debug] [MainThread]: Partial parsing: added file: stock_analytics://snapshots/market_snapshot.sql
[0m21:45:06.699685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2df194bc-e75b-41ec-9242-c14fd0ab65bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96b63bf0>]}
[0m21:45:06.712423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '978e322f-e113-47d5-b0a7-d813d2850f81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84a67860>]}
[0m21:45:06.749496 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/stock_analytics/target/manifest.json
[0m21:45:06.750756 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/stock_analytics/target/semantic_manifest.json
[0m21:45:06.770909 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/stock_analytics/target/manifest.json
[0m21:45:06.772073 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/stock_analytics/target/semantic_manifest.json
[0m21:45:06.773603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2df194bc-e75b-41ec-9242-c14fd0ab65bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96ac38f0>]}
[0m21:45:06.773877 [info ] [MainThread]: Found 3 models, 11 data tests, 1 snapshot, 2 sources, 504 macros
[0m21:45:06.774078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2df194bc-e75b-41ec-9242-c14fd0ab65bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96c16780>]}
[0m21:45:06.774894 [info ] [MainThread]: 
[0m21:45:06.775091 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:45:06.775236 [info ] [MainThread]: 
[0m21:45:06.775504 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:45:06.777481 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_OSTRICH_PUBLIC_ANALYTICS'
[0m21:45:06.791436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '978e322f-e113-47d5-b0a7-d813d2850f81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86e921b0>]}
[0m21:45:06.791724 [info ] [MainThread]: Found 3 models, 11 data tests, 1 snapshot, 2 sources, 504 macros
[0m21:45:06.791906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '978e322f-e113-47d5-b0a7-d813d2850f81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84d077a0>]}
[0m21:45:06.792774 [info ] [MainThread]: 
[0m21:45:06.793005 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:45:06.793188 [info ] [MainThread]: 
[0m21:45:06.793510 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:45:06.793973 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_OSTRICH'
[0m21:45:06.823185 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_OSTRICH_PUBLIC_ANALYTICS"
[0m21:45:06.823493 [debug] [ThreadPool]: On list_USER_DB_OSTRICH_PUBLIC_ANALYTICS: show objects in USER_DB_OSTRICH.PUBLIC_ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.0rc1", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_OSTRICH_PUBLIC_ANALYTICS"} */;
[0m21:45:06.823680 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:45:06.832617 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_OSTRICH"
[0m21:45:06.832926 [debug] [ThreadPool]: On list_USER_DB_OSTRICH: show terse schemas in database USER_DB_OSTRICH
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.0rc1", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_OSTRICH"} */
[0m21:45:06.833122 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:45:07.438384 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.615 seconds
[0m21:45:07.439728 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_OSTRICH_PUBLIC_ANALYTICS, now list_USER_DB_OSTRICH_SNAPSHOTS)
[0m21:45:07.441391 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_OSTRICH_SNAPSHOTS"
[0m21:45:07.441577 [debug] [ThreadPool]: On list_USER_DB_OSTRICH_SNAPSHOTS: show objects in USER_DB_OSTRICH.SNAPSHOTS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.0rc1", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_OSTRICH_SNAPSHOTS"} */;
[0m21:45:07.548965 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01c09d19-0307-1f0e-000f-c0df0093be1e
[0m21:45:07.549379 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m21:45:07.549871 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m21:45:07.550125 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m21:45:07.550495 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_OSTRICH_SNAPSHOTS, now list_USER_DB_OSTRICH_PUBLIC_STAGING)
[0m21:45:07.552193 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_OSTRICH_PUBLIC_STAGING"
[0m21:45:07.552457 [debug] [ThreadPool]: On list_USER_DB_OSTRICH_PUBLIC_STAGING: show objects in USER_DB_OSTRICH.PUBLIC_STAGING
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.0rc1", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_OSTRICH_PUBLIC_STAGING"} */;
[0m21:45:07.569056 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.736 seconds
[0m21:45:07.571185 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_OSTRICH, now create_USER_DB_OSTRICH_SNAPSHOTS)
[0m21:45:07.571721 [debug] [ThreadPool]: Creating schema "database: "USER_DB_OSTRICH"
schema: "SNAPSHOTS"
"
[0m21:45:07.576545 [debug] [ThreadPool]: Using snowflake connection "create_USER_DB_OSTRICH_SNAPSHOTS"
[0m21:45:07.576887 [debug] [ThreadPool]: On create_USER_DB_OSTRICH_SNAPSHOTS: create schema if not exists USER_DB_OSTRICH.SNAPSHOTS
/* {"app": "dbt", "dbt_version": "1.11.0rc1", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "create_USER_DB_OSTRICH_SNAPSHOTS"} */
[0m21:45:07.728276 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.176 seconds
[0m21:45:07.730482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2df194bc-e75b-41ec-9242-c14fd0ab65bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b25dee0>]}
[0m21:45:07.733370 [debug] [Thread-1 (]: Began running node test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316
[0m21:45:07.733713 [info ] [Thread-1 (]: 1 of 5 START test accepted_values_mart_stock_analysis_record_type__historical__forecast  [RUN]
[0m21:45:07.734085 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_OSTRICH_PUBLIC_STAGING, now test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316)
[0m21:45:07.734408 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316
[0m21:45:07.743726 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316"
[0m21:45:07.745874 [debug] [Thread-1 (]: Began executing node test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316
[0m21:45:07.747575 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.170 seconds
[0m21:45:07.750780 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_USER_DB_OSTRICH_SNAPSHOTS, now list_USER_DB_OSTRICH_PUBLIC_ANALYTICS)
[0m21:45:07.757519 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_OSTRICH_PUBLIC_ANALYTICS"
[0m21:45:07.757821 [debug] [ThreadPool]: On list_USER_DB_OSTRICH_PUBLIC_ANALYTICS: show objects in USER_DB_OSTRICH.PUBLIC_ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.0rc1", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_OSTRICH_PUBLIC_ANALYTICS"} */;
[0m21:45:07.759049 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316"
[0m21:45:07.760372 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316"
[0m21:45:07.760619 [debug] [Thread-1 (]: On test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        record_type as value_field,
        count(*) as n_records

    from USER_DB_OSTRICH.PUBLIC_ANALYTICS.mart_stock_analysis
    group by record_type

)

select *
from all_values
where value_field not in (
    'historical','forecast'
)



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.0rc1", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316"} */
[0m21:45:07.922792 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.162 seconds
[0m21:45:07.932670 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.174 seconds
[0m21:45:07.935531 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_OSTRICH_PUBLIC_ANALYTICS, now list_USER_DB_OSTRICH_SNAPSHOTS)
[0m21:45:07.937485 [info ] [Thread-1 (]: 1 of 5 PASS accepted_values_mart_stock_analysis_record_type__historical__forecast  [[32mPASS[0m in 0.20s]
[0m21:45:07.938236 [debug] [Thread-1 (]: Finished running node test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316
[0m21:45:07.938680 [debug] [Thread-1 (]: Began running node test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5
[0m21:45:07.938860 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_OSTRICH_SNAPSHOTS"
[0m21:45:07.939097 [info ] [Thread-1 (]: 2 of 5 START test not_null_mart_stock_analysis_date ............................ [RUN]
[0m21:45:07.939204 [debug] [ThreadPool]: On list_USER_DB_OSTRICH_SNAPSHOTS: show objects in USER_DB_OSTRICH.SNAPSHOTS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.0rc1", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_OSTRICH_SNAPSHOTS"} */;
[0m21:45:07.939545 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316, now test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5)
[0m21:45:07.939934 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5
[0m21:45:07.945335 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5"
[0m21:45:07.946436 [debug] [Thread-1 (]: Began executing node test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5
[0m21:45:07.948462 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5"
[0m21:45:07.949558 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5"
[0m21:45:07.949896 [debug] [Thread-1 (]: On test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date
from USER_DB_OSTRICH.PUBLIC_ANALYTICS.mart_stock_analysis
where date is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.0rc1", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5"} */
[0m21:45:08.073146 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.133 seconds
[0m21:45:08.074871 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_OSTRICH_SNAPSHOTS, now list_USER_DB_OSTRICH_PUBLIC_STAGING)
[0m21:45:08.077238 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_OSTRICH_PUBLIC_STAGING"
[0m21:45:08.077625 [debug] [ThreadPool]: On list_USER_DB_OSTRICH_PUBLIC_STAGING: show objects in USER_DB_OSTRICH.PUBLIC_STAGING
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.0rc1", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_OSTRICH_PUBLIC_STAGING"} */;
[0m21:45:08.234100 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.156 seconds
[0m21:45:08.237521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '978e322f-e113-47d5-b0a7-d813d2850f81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8517d220>]}
[0m21:45:08.242105 [debug] [Thread-1 (]: Began running node snapshot.stock_analytics.market_data_snapshot
[0m21:45:08.242977 [info ] [Thread-1 (]: 1 of 1 START snapshot SNAPSHOTS.market_data_snapshot ........................... [RUN]
[0m21:45:08.243749 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_OSTRICH_PUBLIC_STAGING, now snapshot.stock_analytics.market_data_snapshot)
[0m21:45:08.244223 [debug] [Thread-1 (]: Began compiling node snapshot.stock_analytics.market_data_snapshot
[0m21:45:08.250305 [debug] [Thread-1 (]: Began executing node snapshot.stock_analytics.market_data_snapshot
[0m21:45:08.299774 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.market_data_snapshot"
[0m21:45:08.300181 [debug] [Thread-1 (]: On snapshot.stock_analytics.market_data_snapshot: select * from (
        
    

    select *,
        md5(coalesce(cast(concat(symbol, '|', to_varchar(date)) as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
        
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
from (
        

select * from USER_DB_OSTRICH.RAW.MARKET_DATA
    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.11.0rc1", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.market_data_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.11.0rc1", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.market_data_snapshot"} */
[0m21:45:08.479108 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.529 seconds
[0m21:45:08.483554 [info ] [Thread-1 (]: 2 of 5 PASS not_null_mart_stock_analysis_date .................................. [[32mPASS[0m in 0.54s]
[0m21:45:08.484476 [debug] [Thread-1 (]: Finished running node test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5
[0m21:45:08.484980 [debug] [Thread-1 (]: Began running node test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e
[0m21:45:08.485548 [info ] [Thread-1 (]: 3 of 5 START test not_null_mart_stock_analysis_symbol .......................... [RUN]
[0m21:45:08.486188 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5, now test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e)
[0m21:45:08.486662 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e
[0m21:45:08.491198 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e"
[0m21:45:08.492709 [debug] [Thread-1 (]: Began executing node test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e
[0m21:45:08.495094 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e"
[0m21:45:08.496355 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e"
[0m21:45:08.496685 [debug] [Thread-1 (]: On test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select symbol
from USER_DB_OSTRICH.PUBLIC_ANALYTICS.mart_stock_analysis
where symbol is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.0rc1", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e"} */
[0m21:45:08.633400 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.136 seconds
[0m21:45:08.634682 [info ] [Thread-1 (]: 3 of 5 PASS not_null_mart_stock_analysis_symbol ................................ [[32mPASS[0m in 0.15s]
[0m21:45:08.635092 [debug] [Thread-1 (]: Finished running node test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e
[0m21:45:08.635356 [debug] [Thread-1 (]: Began running node test.stock_analytics.test_forecast_dates_future
[0m21:45:08.635591 [info ] [Thread-1 (]: 4 of 5 START test test_forecast_dates_future ................................... [RUN]
[0m21:45:08.635851 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e, now test.stock_analytics.test_forecast_dates_future)
[0m21:45:08.636092 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.test_forecast_dates_future
[0m21:45:08.637629 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.test_forecast_dates_future"
[0m21:45:08.638398 [debug] [Thread-1 (]: Began executing node test.stock_analytics.test_forecast_dates_future
[0m21:45:08.639536 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.test_forecast_dates_future"
[0m21:45:08.640271 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.test_forecast_dates_future"
[0m21:45:08.640455 [debug] [Thread-1 (]: On test.stock_analytics.test_forecast_dates_future: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- Fail if any forecast date is not strictly after the latest historical date for that symbol.
with max_hist as (
  select symbol, max(date) as max_hist_date
  from USER_DB_OSTRICH.PUBLIC_ANALYTICS.mart_stock_analysis
  where record_type = 'historical'
  group by 1
)

select f.symbol, f.date, f.record_type, f.forecast_price, m.max_hist_date
from USER_DB_OSTRICH.PUBLIC_ANALYTICS.mart_stock_analysis f
join max_hist m using (symbol)
where f.record_type = 'forecast'
  and f.date <= m.max_hist_date
  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.0rc1", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.test_forecast_dates_future"} */
[0m21:45:08.772881 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.132 seconds
[0m21:45:08.774834 [info ] [Thread-1 (]: 4 of 5 PASS test_forecast_dates_future ......................................... [[32mPASS[0m in 0.14s]
[0m21:45:08.775411 [debug] [Thread-1 (]: Finished running node test.stock_analytics.test_forecast_dates_future
[0m21:45:08.775796 [debug] [Thread-1 (]: Began running node test.stock_analytics.unique_mart_stock_analysis_pk_symbol_date.2ccccb8eaa
[0m21:45:08.776173 [info ] [Thread-1 (]: 5 of 5 START test unique_mart_stock_analysis_pk_symbol_date .................... [RUN]
[0m21:45:08.776610 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.test_forecast_dates_future, now test.stock_analytics.unique_mart_stock_analysis_pk_symbol_date.2ccccb8eaa)
[0m21:45:08.776945 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.unique_mart_stock_analysis_pk_symbol_date.2ccccb8eaa
[0m21:45:08.781840 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.unique_mart_stock_analysis_pk_symbol_date.2ccccb8eaa"
[0m21:45:08.782695 [debug] [Thread-1 (]: Began executing node test.stock_analytics.unique_mart_stock_analysis_pk_symbol_date.2ccccb8eaa
[0m21:45:08.784624 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.unique_mart_stock_analysis_pk_symbol_date.2ccccb8eaa"
[0m21:45:08.785588 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.unique_mart_stock_analysis_pk_symbol_date.2ccccb8eaa"
[0m21:45:08.785858 [debug] [Thread-1 (]: On test.stock_analytics.unique_mart_stock_analysis_pk_symbol_date.2ccccb8eaa: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    pk_symbol_date as unique_field,
    count(*) as n_records

from USER_DB_OSTRICH.PUBLIC_ANALYTICS.mart_stock_analysis
where pk_symbol_date is not null
group by pk_symbol_date
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.0rc1", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.unique_mart_stock_analysis_pk_symbol_date.2ccccb8eaa"} */
[0m21:45:08.897721 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.111 seconds
[0m21:45:08.901712 [info ] [Thread-1 (]: 5 of 5 PASS unique_mart_stock_analysis_pk_symbol_date .......................... [[32mPASS[0m in 0.12s]
[0m21:45:08.903328 [debug] [Thread-1 (]: Finished running node test.stock_analytics.unique_mart_stock_analysis_pk_symbol_date.2ccccb8eaa
[0m21:45:08.907984 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:45:08.908838 [debug] [MainThread]: Connection 'test.stock_analytics.unique_mart_stock_analysis_pk_symbol_date.2ccccb8eaa' was left open.
[0m21:45:08.909453 [debug] [MainThread]: On test.stock_analytics.unique_mart_stock_analysis_pk_symbol_date.2ccccb8eaa: Close
[0m21:45:09.112669 [info ] [MainThread]: 
[0m21:45:09.114160 [info ] [MainThread]: Finished running 5 data tests in 0 hours 0 minutes and 2.34 seconds (2.34s).
[0m21:45:09.116432 [debug] [MainThread]: Command end result
[0m21:45:09.150435 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/stock_analytics/target/manifest.json
[0m21:45:09.151865 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/stock_analytics/target/semantic_manifest.json
[0m21:45:09.156371 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/stock_analytics/target/run_results.json
[0m21:45:09.156609 [info ] [MainThread]: 
[0m21:45:09.156877 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:45:09.157117 [info ] [MainThread]: 
[0m21:45:09.157389 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m21:45:09.158061 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 2.9881685, "process_in_blocks": "0", "process_kernel_time": 0.28115, "process_mem_max_rss": "148572", "process_out_blocks": "3340", "process_user_time": 1.607142}
[0m21:45:09.158378 [debug] [MainThread]: Command `dbt test` succeeded at 21:45:09.158320 after 2.99 seconds
[0m21:45:09.158613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff987e5520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff996e1760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff996e3260>]}
[0m21:45:09.158846 [debug] [MainThread]: Flushing usage events
[0m21:45:09.452967 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.152 seconds
[0m21:45:09.460457 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.market_data_snapshot"
[0m21:45:09.461563 [debug] [Thread-1 (]: On snapshot.stock_analytics.market_data_snapshot: select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.11.0rc1", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.market_data_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.11.0rc1", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.market_data_snapshot"} */
[0m21:45:09.563792 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.101 seconds
[0m21:45:09.565798 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.stock_analytics.market_data_snapshot"
[0m21:45:09.572156 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.market_data_snapshot"
[0m21:45:09.573548 [debug] [Thread-1 (]: On snapshot.stock_analytics.market_data_snapshot: create or replace transient table USER_DB_OSTRICH.SNAPSHOTS.market_data_snapshot
    
    
    
    as (
    

    select *,
        md5(coalesce(cast(concat(symbol, '|', to_varchar(date)) as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
        
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
from (
        

select * from USER_DB_OSTRICH.RAW.MARKET_DATA
    ) sbq



    )

/* {"app": "dbt", "dbt_version": "1.11.0rc1", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.market_data_snapshot"} */;
[0m21:45:09.623732 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:45:11.213584 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.639 seconds
[0m21:45:11.243069 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '978e322f-e113-47d5-b0a7-d813d2850f81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87617b90>]}
[0m21:45:11.244161 [info ] [Thread-1 (]: 1 of 1 OK snapshotted SNAPSHOTS.market_data_snapshot ........................... [[32mSUCCESS 1[0m in 3.00s]
[0m21:45:11.245231 [debug] [Thread-1 (]: Finished running node snapshot.stock_analytics.market_data_snapshot
[0m21:45:11.246837 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:45:11.247145 [debug] [MainThread]: Connection 'snapshot.stock_analytics.market_data_snapshot' was left open.
[0m21:45:11.247440 [debug] [MainThread]: On snapshot.stock_analytics.market_data_snapshot: Close
[0m21:45:11.357346 [info ] [MainThread]: 
[0m21:45:11.358617 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 4.56 seconds (4.56s).
[0m21:45:11.360561 [debug] [MainThread]: Command end result
[0m21:45:11.395074 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/stock_analytics/target/manifest.json
[0m21:45:11.396582 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/stock_analytics/target/semantic_manifest.json
[0m21:45:11.400442 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/stock_analytics/target/run_results.json
[0m21:45:11.400676 [info ] [MainThread]: 
[0m21:45:11.401282 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:45:11.401667 [info ] [MainThread]: 
[0m21:45:11.402052 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m21:45:11.402843 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 5.2488027, "process_in_blocks": "0", "process_kernel_time": 0.250501, "process_mem_max_rss": "147956", "process_out_blocks": "3309", "process_user_time": 1.662327}
[0m21:45:11.403131 [debug] [MainThread]: Command `dbt snapshot` succeeded at 21:45:11.403081 after 5.25 seconds
[0m21:45:11.403445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87008aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff851ad460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff851ade80>]}
[0m21:45:11.404541 [debug] [MainThread]: Flushing usage events
[0m21:45:11.743631 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:00:02.396543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7553a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa96eec60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7553f50>]}


============================== 03:00:02.401813 | cab197ea-d38c-43ce-aa28-59e50396259b ==============================
[0m03:00:02.401813 [info ] [MainThread]: Running with dbt=1.11.0-rc1
[0m03:00:02.402929 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'log_path': '/opt/airflow/dbt/stock_analytics/logs', 'target_path': 'None', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'printer_width': '80', 'no_print': 'None', 'profiles_dir': '/opt/airflow/dbt', 'write_json': 'True', 'quiet': 'False', 'indirect_selection': 'eager', 'log_format': 'default', 'use_colors': 'True', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'empty': 'False', 'invocation_command': 'dbt snapshot --profiles-dir /opt/airflow/dbt', 'static_parser': 'True', 'use_experimental_parser': 'False', 'partial_parse': 'True'}
[0m03:00:02.580929 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m03:00:02.581277 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m03:00:02.581467 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m03:00:02.652840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cab197ea-d38c-43ce-aa28-59e50396259b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5777500>]}
[0m03:00:02.676168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cab197ea-d38c-43ce-aa28-59e50396259b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa86800b0>]}
[0m03:00:02.676599 [info ] [MainThread]: Registered adapter: snowflake=1.10.3
[0m03:00:02.718071 [debug] [MainThread]: checksum: bdedcbc4566463a53095072aa091a5f5b73db413e58224228390aa7e9748abcc, vars: {}, profile: , target: , version: 1.11.0rc1
[0m03:00:02.783861 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:00:02.784112 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:00:02.808964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cab197ea-d38c-43ce-aa28-59e50396259b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5790cb0>]}
[0m03:00:02.892103 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/stock_analytics/target/manifest.json
[0m03:00:02.893501 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/stock_analytics/target/semantic_manifest.json
[0m03:00:02.903166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cab197ea-d38c-43ce-aa28-59e50396259b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4e12ed0>]}
[0m03:00:02.903601 [info ] [MainThread]: Found 3 models, 11 data tests, 1 snapshot, 2 sources, 504 macros
[0m03:00:02.904116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cab197ea-d38c-43ce-aa28-59e50396259b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa508c440>]}
[0m03:00:02.904992 [info ] [MainThread]: 
[0m03:00:02.905258 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:00:02.905425 [info ] [MainThread]: 
[0m03:00:02.905732 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:00:02.906275 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_OSTRICH'
[0m03:00:02.926597 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_OSTRICH"
[0m03:00:02.926855 [debug] [ThreadPool]: On list_USER_DB_OSTRICH: show terse schemas in database USER_DB_OSTRICH
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.0rc1", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_OSTRICH"} */
[0m03:00:02.927050 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:00:03.408133 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.481 seconds
[0m03:00:03.415308 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_OSTRICH, now list_USER_DB_OSTRICH_PUBLIC_ANALYTICS)
[0m03:00:03.425757 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_OSTRICH_PUBLIC_ANALYTICS"
[0m03:00:03.426098 [debug] [ThreadPool]: On list_USER_DB_OSTRICH_PUBLIC_ANALYTICS: show objects in USER_DB_OSTRICH.PUBLIC_ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.0rc1", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_OSTRICH_PUBLIC_ANALYTICS"} */;
[0m03:00:03.571998 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.145 seconds
[0m03:00:03.575079 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_OSTRICH_PUBLIC_ANALYTICS, now list_USER_DB_OSTRICH_PUBLIC_STAGING)
[0m03:00:03.578837 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_OSTRICH_PUBLIC_STAGING"
[0m03:00:03.579241 [debug] [ThreadPool]: On list_USER_DB_OSTRICH_PUBLIC_STAGING: show objects in USER_DB_OSTRICH.PUBLIC_STAGING
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.0rc1", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_OSTRICH_PUBLIC_STAGING"} */;
[0m03:00:03.745413 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.166 seconds
[0m03:00:03.749764 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_OSTRICH_PUBLIC_STAGING, now list_USER_DB_OSTRICH_SNAPSHOTS)
[0m03:00:03.755363 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_OSTRICH_SNAPSHOTS"
[0m03:00:03.756331 [debug] [ThreadPool]: On list_USER_DB_OSTRICH_SNAPSHOTS: show objects in USER_DB_OSTRICH.SNAPSHOTS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.0rc1", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_OSTRICH_SNAPSHOTS"} */;
[0m03:00:03.869143 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.112 seconds
[0m03:00:03.874008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cab197ea-d38c-43ce-aa28-59e50396259b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa528d4c0>]}
[0m03:00:03.881322 [debug] [Thread-1 (]: Began running node snapshot.stock_analytics.market_data_snapshot
[0m03:00:03.882483 [info ] [Thread-1 (]: 1 of 1 START snapshot SNAPSHOTS.market_data_snapshot ........................... [RUN]
[0m03:00:03.883811 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_OSTRICH_SNAPSHOTS, now snapshot.stock_analytics.market_data_snapshot)
[0m03:00:03.884842 [debug] [Thread-1 (]: Began compiling node snapshot.stock_analytics.market_data_snapshot
[0m03:00:03.893255 [debug] [Thread-1 (]: Began executing node snapshot.stock_analytics.market_data_snapshot
[0m03:00:03.930958 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.market_data_snapshot"
[0m03:00:03.931263 [debug] [Thread-1 (]: On snapshot.stock_analytics.market_data_snapshot: select * from (
        select CLOSE, VOLUME from (
                

select * from USER_DB_OSTRICH.RAW.MARKET_DATA
            ) subq
    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.11.0rc1", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.market_data_snapshot"} */
[0m03:00:04.963639 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.032 seconds
[0m03:00:04.978068 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.market_data_snapshot"
[0m03:00:04.979603 [debug] [Thread-1 (]: On snapshot.stock_analytics.market_data_snapshot: describe table "USER_DB_OSTRICH"."SNAPSHOTS"."MARKET_DATA_SNAPSHOT"
/* {"app": "dbt", "dbt_version": "1.11.0rc1", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.market_data_snapshot"} */
[0m03:00:05.123376 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.142 seconds
[0m03:00:05.136913 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.market_data_snapshot"
[0m03:00:05.137912 [debug] [Thread-1 (]: On snapshot.stock_analytics.market_data_snapshot: describe table "USER_DB_OSTRICH"."SNAPSHOTS"."MARKET_DATA_SNAPSHOT"
/* {"app": "dbt", "dbt_version": "1.11.0rc1", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.market_data_snapshot"} */
[0m03:00:05.329283 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.190 seconds
[0m03:00:05.378785 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.market_data_snapshot"
[0m03:00:05.379314 [debug] [Thread-1 (]: On snapshot.stock_analytics.market_data_snapshot: create or replace temporary table "USER_DB_OSTRICH"."SNAPSHOTS"."MARKET_DATA_SNAPSHOT__dbt_tmp"
as (
    
    
    with snapshot_query as (

        

select * from USER_DB_OSTRICH.RAW.MARKET_DATA

    ),

    snapshotted_data as (

        select *, 
    
        concat(symbol, '|', to_varchar(date)) as dbt_unique_key
    

        from "USER_DB_OSTRICH"."SNAPSHOTS"."MARKET_DATA_SNAPSHOT"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        concat(symbol, '|', to_varchar(date)) as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(concat(symbol, '|', to_varchar(date)) as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        concat(symbol, '|', to_varchar(date)) as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        ) or snapshotted_data."VOLUME" != source_data."VOLUME"
        or
        (
            ((snapshotted_data."VOLUME" is null) and not (source_data."VOLUME" is null))
            or
            ((not snapshotted_data."VOLUME" is null) and (source_data."VOLUME" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        ) or snapshotted_data."VOLUME" != source_data."VOLUME"
        or
        (
            ((snapshotted_data."VOLUME" is null) and not (source_data."VOLUME" is null))
            or
            ((not snapshotted_data."VOLUME" is null) and (source_data."VOLUME" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    )

/* {"app": "dbt", "dbt_version": "1.11.0rc1", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.market_data_snapshot"} */;
[0m03:00:06.925191 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.545 seconds
[0m03:00:06.926889 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.market_data_snapshot"
[0m03:00:06.927142 [debug] [Thread-1 (]: On snapshot.stock_analytics.market_data_snapshot: describe table "USER_DB_OSTRICH"."SNAPSHOTS"."MARKET_DATA_SNAPSHOT__dbt_tmp"
/* {"app": "dbt", "dbt_version": "1.11.0rc1", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.market_data_snapshot"} */
[0m03:00:07.053275 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.126 seconds
[0m03:00:07.056753 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.market_data_snapshot"
[0m03:00:07.057034 [debug] [Thread-1 (]: On snapshot.stock_analytics.market_data_snapshot: describe table "USER_DB_OSTRICH"."SNAPSHOTS"."MARKET_DATA_SNAPSHOT"
/* {"app": "dbt", "dbt_version": "1.11.0rc1", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.market_data_snapshot"} */
[0m03:00:07.192317 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.135 seconds
[0m03:00:07.195712 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.market_data_snapshot"
[0m03:00:07.196295 [debug] [Thread-1 (]: On snapshot.stock_analytics.market_data_snapshot: describe table "USER_DB_OSTRICH"."SNAPSHOTS"."MARKET_DATA_SNAPSHOT__dbt_tmp"
/* {"app": "dbt", "dbt_version": "1.11.0rc1", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.market_data_snapshot"} */
[0m03:00:07.327123 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.130 seconds
[0m03:00:07.329245 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.market_data_snapshot"
[0m03:00:07.329489 [debug] [Thread-1 (]: On snapshot.stock_analytics.market_data_snapshot: describe table "USER_DB_OSTRICH"."SNAPSHOTS"."MARKET_DATA_SNAPSHOT"
/* {"app": "dbt", "dbt_version": "1.11.0rc1", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.market_data_snapshot"} */
[0m03:00:07.453824 [debug] [Thread-1 (]: SQL status: SUCCESS 11 in 0.124 seconds
[0m03:00:07.461448 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.market_data_snapshot"
[0m03:00:07.461932 [debug] [Thread-1 (]: On snapshot.stock_analytics.market_data_snapshot: describe table "USER_DB_OSTRICH"."SNAPSHOTS"."MARKET_DATA_SNAPSHOT__dbt_tmp"
/* {"app": "dbt", "dbt_version": "1.11.0rc1", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.market_data_snapshot"} */
[0m03:00:07.596534 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.134 seconds
[0m03:00:07.618127 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.market_data_snapshot"
[0m03:00:07.618670 [debug] [Thread-1 (]: On snapshot.stock_analytics.market_data_snapshot: select * from (
        
    
    with snapshot_query as (

        

select * from USER_DB_OSTRICH.RAW.MARKET_DATA

    ),

    snapshotted_data as (

        select *, 
    
        concat(symbol, '|', to_varchar(date)) as dbt_unique_key
    

        from "USER_DB_OSTRICH"."SNAPSHOTS"."MARKET_DATA_SNAPSHOT"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        concat(symbol, '|', to_varchar(date)) as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
,
            md5(coalesce(cast(concat(symbol, '|', to_varchar(date)) as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        concat(symbol, '|', to_varchar(date)) as dbt_unique_key
    
,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and (
               (snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        ) or snapshotted_data."VOLUME" != source_data."VOLUME"
        or
        (
            ((snapshotted_data."VOLUME" is null) and not (source_data."VOLUME" is null))
            or
            ((not snapshotted_data."VOLUME" is null) and (source_data."VOLUME" is null))
        ))
            )

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data."CLOSE" != source_data."CLOSE"
        or
        (
            ((snapshotted_data."CLOSE" is null) and not (source_data."CLOSE" is null))
            or
            ((not snapshotted_data."CLOSE" is null) and (source_data."CLOSE" is null))
        ) or snapshotted_data."VOLUME" != source_data."VOLUME"
        or
        (
            ((snapshotted_data."VOLUME" is null) and not (source_data."VOLUME" is null))
            or
            ((not snapshotted_data."VOLUME" is null) and (source_data."VOLUME" is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates

    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.11.0rc1", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.market_data_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.11.0rc1", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.market_data_snapshot"} */
[0m03:00:07.760030 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.141 seconds
[0m03:00:07.765921 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.market_data_snapshot"
[0m03:00:07.766993 [debug] [Thread-1 (]: On snapshot.stock_analytics.market_data_snapshot: select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.11.0rc1", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.market_data_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.11.0rc1", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.market_data_snapshot"} */
[0m03:00:07.860547 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.093 seconds
[0m03:00:07.862124 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.stock_analytics.market_data_snapshot"
[0m03:00:07.868126 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.market_data_snapshot"
[0m03:00:07.868914 [debug] [Thread-1 (]: On snapshot.stock_analytics.market_data_snapshot: BEGIN
/* {"app": "dbt", "dbt_version": "1.11.0rc1", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.market_data_snapshot"} */
[0m03:00:08.113706 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.244 seconds
[0m03:00:08.115424 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.market_data_snapshot"
[0m03:00:08.116345 [debug] [Thread-1 (]: On snapshot.stock_analytics.market_data_snapshot: merge into "USER_DB_OSTRICH"."SNAPSHOTS"."MARKET_DATA_SNAPSHOT" as DBT_INTERNAL_DEST
    using "USER_DB_OSTRICH"."SNAPSHOTS"."MARKET_DATA_SNAPSHOT__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("SYMBOL", "DATE", "OPEN", "CLOSE", "LOW", "HIGH", "VOLUME", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("SYMBOL", "DATE", "OPEN", "CLOSE", "LOW", "HIGH", "VOLUME", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")


/* {"app": "dbt", "dbt_version": "1.11.0rc1", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.market_data_snapshot"} */;
[0m03:00:09.159283 [debug] [Thread-1 (]: SQL status: SUCCESS 2 in 1.041 seconds
[0m03:00:09.160173 [debug] [Thread-1 (]: Using snowflake connection "snapshot.stock_analytics.market_data_snapshot"
[0m03:00:09.160424 [debug] [Thread-1 (]: On snapshot.stock_analytics.market_data_snapshot: COMMIT
/* {"app": "dbt", "dbt_version": "1.11.0rc1", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "snapshot.stock_analytics.market_data_snapshot"} */
[0m03:00:09.673774 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.513 seconds
[0m03:00:09.698086 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cab197ea-d38c-43ce-aa28-59e50396259b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7727b00>]}
[0m03:00:09.699239 [info ] [Thread-1 (]: 1 of 1 OK snapshotted SNAPSHOTS.market_data_snapshot ........................... [[32mSUCCESS 2[0m in 5.81s]
[0m03:00:09.700560 [debug] [Thread-1 (]: Finished running node snapshot.stock_analytics.market_data_snapshot
[0m03:00:09.702446 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:00:09.702917 [debug] [MainThread]: Connection 'snapshot.stock_analytics.market_data_snapshot' was left open.
[0m03:00:09.703212 [debug] [MainThread]: On snapshot.stock_analytics.market_data_snapshot: Close
[0m03:00:10.082190 [info ] [MainThread]: 
[0m03:00:10.084632 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 7.18 seconds (7.18s).
[0m03:00:10.086537 [debug] [MainThread]: Command end result
[0m03:00:10.120269 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/stock_analytics/target/manifest.json
[0m03:00:10.122322 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/stock_analytics/target/semantic_manifest.json
[0m03:00:10.126788 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/stock_analytics/target/run_results.json
[0m03:00:10.127037 [info ] [MainThread]: 
[0m03:00:10.127574 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:00:10.127806 [info ] [MainThread]: 
[0m03:00:10.128126 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m03:00:10.128983 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 7.7674336, "process_in_blocks": "0", "process_kernel_time": 0.273635, "process_mem_max_rss": "146324", "process_out_blocks": "2254", "process_user_time": 1.695743}
[0m03:00:10.129417 [debug] [MainThread]: Command `dbt snapshot` succeeded at 03:00:10.129344 after 7.77 seconds
[0m03:00:10.129745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa700c6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa700f980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9fe6f800>]}
[0m03:00:10.130159 [debug] [MainThread]: Flushing usage events
[0m03:00:10.505091 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:00:12.316998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb39438c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5b129c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb30d8500>]}


============================== 03:00:12.320077 | ec8119a3-2289-47f3-9539-cf954c34948f ==============================
[0m03:00:12.320077 [info ] [MainThread]: Running with dbt=1.11.0-rc1
[0m03:00:12.320381 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'static_parser': 'True', 'use_experimental_parser': 'False', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'log_cache_events': 'False', 'printer_width': '80', 'indirect_selection': 'eager', 'invocation_command': 'dbt debug --profiles-dir /opt/airflow/dbt', 'cache_selected_only': 'False', 'empty': 'None', 'warn_error': 'None', 'no_print': 'None', 'quiet': 'False', 'version_check': 'True', 'partial_parse': 'True', 'introspect': 'True', 'log_format': 'default', 'write_json': 'True', 'log_path': '/opt/airflow/dbt/stock_analytics/logs'}
[0m03:00:12.323999 [info ] [MainThread]: dbt version: 1.11.0-rc1
[0m03:00:12.324272 [info ] [MainThread]: python version: 3.12.5
[0m03:00:12.324502 [info ] [MainThread]: python path: /opt/airflow/dbt_venv/bin/python3.12
[0m03:00:12.324757 [info ] [MainThread]: os info: Linux-6.10.14-linuxkit-aarch64-with-glibc2.36
[0m03:00:12.408165 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m03:00:12.408494 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m03:00:12.408712 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m03:00:12.433197 [info ] [MainThread]: Using profiles dir at /opt/airflow/dbt
[0m03:00:12.433450 [info ] [MainThread]: Using profiles.yml file at /opt/airflow/dbt/profiles.yml
[0m03:00:12.433642 [info ] [MainThread]: Using dbt_project.yml file at /opt/airflow/dbt/stock_analytics/dbt_project.yml
[0m03:00:12.433922 [info ] [MainThread]: adapter type: snowflake
[0m03:00:12.434115 [info ] [MainThread]: adapter version: 1.10.3
[0m03:00:12.475212 [info ] [MainThread]: Configuration:
[0m03:00:12.475533 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m03:00:12.475763 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m03:00:12.475984 [info ] [MainThread]: Required dependencies:
[0m03:00:12.476191 [debug] [MainThread]: Executing "git --help"
[0m03:00:12.478258 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m03:00:12.478495 [debug] [MainThread]: STDERR: "b''"
[0m03:00:12.478662 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m03:00:12.478843 [info ] [MainThread]: Connection:
[0m03:00:12.479034 [info ] [MainThread]:   account: sfedu02-lvb17920
[0m03:00:12.479223 [info ] [MainThread]:   user: OSTRICH
[0m03:00:12.479402 [info ] [MainThread]:   database: USER_DB_OSTRICH
[0m03:00:12.479611 [info ] [MainThread]:   warehouse: OSTRICH_QUERY_WH
[0m03:00:12.479787 [info ] [MainThread]:   role: TRAINING_ROLE
[0m03:00:12.479967 [info ] [MainThread]:   schema: PUBLIC
[0m03:00:12.480127 [info ] [MainThread]:   authenticator: None
[0m03:00:12.480286 [info ] [MainThread]:   oauth_client_id: None
[0m03:00:12.480443 [info ] [MainThread]:   query_tag: None
[0m03:00:12.480624 [info ] [MainThread]:   client_session_keep_alive: False
[0m03:00:12.480779 [info ] [MainThread]:   host: None
[0m03:00:12.480950 [info ] [MainThread]:   port: None
[0m03:00:12.481113 [info ] [MainThread]:   proxy_host: None
[0m03:00:12.481280 [info ] [MainThread]:   proxy_port: None
[0m03:00:12.481415 [info ] [MainThread]:   protocol: None
[0m03:00:12.481548 [info ] [MainThread]:   connect_retries: 1
[0m03:00:12.481677 [info ] [MainThread]:   connect_timeout: None
[0m03:00:12.481802 [info ] [MainThread]:   retry_on_database_errors: False
[0m03:00:12.481931 [info ] [MainThread]:   retry_all: False
[0m03:00:12.482074 [info ] [MainThread]:   insecure_mode: False
[0m03:00:12.482203 [info ] [MainThread]:   reuse_connections: True
[0m03:00:12.482332 [info ] [MainThread]:   s3_stage_vpce_dns_name: None
[0m03:00:12.482460 [info ] [MainThread]:   platform_detection_timeout_seconds: 0.0
[0m03:00:12.482671 [info ] [MainThread]: Registered adapter: snowflake=1.10.3
[0m03:00:12.514404 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m03:00:12.524395 [debug] [MainThread]: Using snowflake connection "debug"
[0m03:00:12.524654 [debug] [MainThread]: On debug: select 1 as id
[0m03:00:12.524860 [debug] [MainThread]: Opening a new connection, currently in state init
[0m03:00:13.257894 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.733 seconds
[0m03:00:13.259884 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m03:00:13.260510 [info ] [MainThread]: [32mAll checks passed![0m
[0m03:00:13.262013 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.9664743, "process_in_blocks": "0", "process_kernel_time": 0.078356, "process_mem_max_rss": "137008", "process_out_blocks": "30", "process_user_time": 1.072886}
[0m03:00:13.263153 [debug] [MainThread]: Command `dbt debug` succeeded at 03:00:13.262966 after 0.97 seconds
[0m03:00:13.263714 [debug] [MainThread]: Connection 'debug' was left open.
[0m03:00:13.264165 [debug] [MainThread]: On debug: Close
[0m03:00:13.378424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2a85370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb16170b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0e5c9b0>]}
[0m03:00:13.379337 [debug] [MainThread]: Flushing usage events
[0m03:00:13.751851 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:00:14.797491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92cf8b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91dfbe00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92612bd0>]}


============================== 03:00:14.800539 | fddee10f-82ca-4b1c-b023-18ff80f610b3 ==============================
[0m03:00:14.800539 [info ] [MainThread]: Running with dbt=1.11.0-rc1
[0m03:00:14.800855 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'no_print': 'None', 'fail_fast': 'False', 'version_check': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_path': '/opt/airflow/dbt/stock_analytics/logs', 'warn_error': 'None', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'partial_parse': 'True', 'printer_width': '80', 'cache_selected_only': 'False', 'debug': 'False', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/opt/airflow/dbt', 'invocation_command': 'dbt run -s mart_stock_analysis --profiles-dir /opt/airflow/dbt'}
[0m03:00:14.877759 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m03:00:14.878092 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m03:00:14.878271 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m03:00:14.941514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fddee10f-82ca-4b1c-b023-18ff80f610b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90750e90>]}
[0m03:00:14.964268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fddee10f-82ca-4b1c-b023-18ff80f610b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91cb6870>]}
[0m03:00:14.964629 [info ] [MainThread]: Registered adapter: snowflake=1.10.3
[0m03:00:14.998978 [debug] [MainThread]: checksum: bdedcbc4566463a53095072aa091a5f5b73db413e58224228390aa7e9748abcc, vars: {}, profile: , target: , version: 1.11.0rc1
[0m03:00:15.059341 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:00:15.059587 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:00:15.083613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fddee10f-82ca-4b1c-b023-18ff80f610b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff903db5f0>]}
[0m03:00:15.156055 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/stock_analytics/target/manifest.json
[0m03:00:15.157038 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/stock_analytics/target/semantic_manifest.json
[0m03:00:15.165761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fddee10f-82ca-4b1c-b023-18ff80f610b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff904c8470>]}
[0m03:00:15.165994 [info ] [MainThread]: Found 3 models, 11 data tests, 1 snapshot, 2 sources, 504 macros
[0m03:00:15.166354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fddee10f-82ca-4b1c-b023-18ff80f610b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9020bf20>]}
[0m03:00:15.166969 [info ] [MainThread]: 
[0m03:00:15.167219 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:00:15.167433 [info ] [MainThread]: 
[0m03:00:15.167724 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:00:15.168172 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_OSTRICH'
[0m03:00:15.183814 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_OSTRICH"
[0m03:00:15.184066 [debug] [ThreadPool]: On list_USER_DB_OSTRICH: show terse schemas in database USER_DB_OSTRICH
    limit 10000
/* {"app": "dbt", "dbt_version": "1.11.0rc1", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_OSTRICH"} */
[0m03:00:15.184238 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:00:15.597237 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.413 seconds
[0m03:00:15.607466 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_OSTRICH, now list_USER_DB_OSTRICH_PUBLIC_ANALYTICS)
[0m03:00:15.623662 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_OSTRICH_PUBLIC_ANALYTICS"
[0m03:00:15.624261 [debug] [ThreadPool]: On list_USER_DB_OSTRICH_PUBLIC_ANALYTICS: show objects in USER_DB_OSTRICH.PUBLIC_ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.0rc1", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_OSTRICH_PUBLIC_ANALYTICS"} */;
[0m03:00:15.721771 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.097 seconds
[0m03:00:15.725887 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_OSTRICH_PUBLIC_ANALYTICS, now list_USER_DB_OSTRICH_SNAPSHOTS)
[0m03:00:15.731548 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_OSTRICH_SNAPSHOTS"
[0m03:00:15.732969 [debug] [ThreadPool]: On list_USER_DB_OSTRICH_SNAPSHOTS: show objects in USER_DB_OSTRICH.SNAPSHOTS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.0rc1", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_OSTRICH_SNAPSHOTS"} */;
[0m03:00:15.864879 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.131 seconds
[0m03:00:15.868663 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_OSTRICH_SNAPSHOTS, now list_USER_DB_OSTRICH_PUBLIC_STAGING)
[0m03:00:15.874929 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_OSTRICH_PUBLIC_STAGING"
[0m03:00:15.876067 [debug] [ThreadPool]: On list_USER_DB_OSTRICH_PUBLIC_STAGING: show objects in USER_DB_OSTRICH.PUBLIC_STAGING
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.0rc1", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_OSTRICH_PUBLIC_STAGING"} */;
[0m03:00:15.996986 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.120 seconds
[0m03:00:16.001646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fddee10f-82ca-4b1c-b023-18ff80f610b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9082af00>]}
[0m03:00:16.006886 [debug] [Thread-1 (]: Began running node model.stock_analytics.mart_stock_analysis
[0m03:00:16.009131 [info ] [Thread-1 (]: 1 of 1 START sql table model PUBLIC_ANALYTICS.mart_stock_analysis .............. [RUN]
[0m03:00:16.010853 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_OSTRICH_PUBLIC_STAGING, now model.stock_analytics.mart_stock_analysis)
[0m03:00:16.012143 [debug] [Thread-1 (]: Began compiling node model.stock_analytics.mart_stock_analysis
[0m03:00:16.020913 [debug] [Thread-1 (]: Writing injected SQL for node "model.stock_analytics.mart_stock_analysis"
[0m03:00:16.023611 [debug] [Thread-1 (]: Began executing node model.stock_analytics.mart_stock_analysis
[0m03:00:16.045432 [debug] [Thread-1 (]: Writing runtime sql for node "model.stock_analytics.mart_stock_analysis"
[0m03:00:16.046925 [debug] [Thread-1 (]: Using snowflake connection "model.stock_analytics.mart_stock_analysis"
[0m03:00:16.047243 [debug] [Thread-1 (]: On model.stock_analytics.mart_stock_analysis: create or replace transient table USER_DB_OSTRICH.PUBLIC_ANALYTICS.mart_stock_analysis
    
    
    
    as (

-- Historical slice
with hist as (
  select
    symbol,
    date,
    close                  as actual_price,
    cast(null as float)    as forecast_price,
    cast(null as float)    as lower_bound,
    cast(null as float)    as upper_bound,
    'historical'           as record_type,
    concat(symbol, '|', to_varchar(date)) as pk_symbol_date
  from USER_DB_OSTRICH.PUBLIC_STAGING.stg_market_data
),

-- Forecast slice
fut as (
  select
    symbol,
    date,
    cast(null as float)    as actual_price,
    forecast               as forecast_price,
    lower_bound,
    upper_bound,
    'forecast'             as record_type,
    concat(symbol, '|', to_varchar(date)) as pk_symbol_date
  from USER_DB_OSTRICH.PUBLIC_STAGING.stg_market_forecast
),

unioned as (
  select * from hist
  union all
  select * from fut
)

select *
from (
  select
    *,
    row_number() over (
      -- 1. PARTITION ONLY BY KEY (remove record_type)
      partition by symbol, date
      -- 2. PRIORITIZE HISTORICAL DATA
      order by 
        case when record_type = 'historical' then 1 else 2 end asc,
        date desc
    ) as rn
  from unioned
)
where rn = 1
    )

/* {"app": "dbt", "dbt_version": "1.11.0rc1", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "model.stock_analytics.mart_stock_analysis"} */;
[0m03:00:17.712983 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.665 seconds
[0m03:00:17.740642 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fddee10f-82ca-4b1c-b023-18ff80f610b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92d2bf50>]}
[0m03:00:17.741510 [info ] [Thread-1 (]: 1 of 1 OK created sql table model PUBLIC_ANALYTICS.mart_stock_analysis ......... [[32mSUCCESS 1[0m in 1.73s]
[0m03:00:17.742179 [debug] [Thread-1 (]: Finished running node model.stock_analytics.mart_stock_analysis
[0m03:00:17.743536 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:00:17.743872 [debug] [MainThread]: Connection 'model.stock_analytics.mart_stock_analysis' was left open.
[0m03:00:17.744211 [debug] [MainThread]: On model.stock_analytics.mart_stock_analysis: Close
[0m03:00:17.845449 [info ] [MainThread]: 
[0m03:00:17.846600 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.68 seconds (2.68s).
[0m03:00:17.847469 [debug] [MainThread]: Command end result
[0m03:00:17.867715 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/stock_analytics/target/manifest.json
[0m03:00:17.869000 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/stock_analytics/target/semantic_manifest.json
[0m03:00:17.872608 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/stock_analytics/target/run_results.json
[0m03:00:17.872823 [info ] [MainThread]: 
[0m03:00:17.873296 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:00:17.873598 [info ] [MainThread]: 
[0m03:00:17.873914 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m03:00:17.874719 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.0980935, "process_in_blocks": "0", "process_kernel_time": 0.081372, "process_mem_max_rss": "144560", "process_out_blocks": "2234", "process_user_time": 1.380315}
[0m03:00:17.874981 [debug] [MainThread]: Command `dbt run` succeeded at 03:00:17.874937 after 3.10 seconds
[0m03:00:17.875187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91c902f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff930f88c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90d034a0>]}
[0m03:00:17.875372 [debug] [MainThread]: Flushing usage events
[0m03:00:18.228464 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m03:00:20.231653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99100aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff992ab170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff996a62a0>]}


============================== 03:00:20.234924 | 8cebddb5-4c3d-4bf7-8a16-fd1dccf686f1 ==============================
[0m03:00:20.234924 [info ] [MainThread]: Running with dbt=1.11.0-rc1
[0m03:00:20.235382 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'log_format': 'default', 'empty': 'None', 'version_check': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'log_path': '/opt/airflow/dbt/stock_analytics/logs', 'write_json': 'True', 'no_print': 'None', 'debug': 'False', 'introspect': 'True', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'invocation_command': 'dbt test -s mart_stock_analysis --profiles-dir /opt/airflow/dbt', 'partial_parse': 'True', 'profiles_dir': '/opt/airflow/dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'target_path': 'None', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager'}
[0m03:00:20.315703 [debug] [MainThread]: Snowflake adapter: Setting snowflake.connector to ERROR (file logging only)
[0m03:00:20.316023 [debug] [MainThread]: Snowflake adapter: Setting botocore to ERROR (file logging only)
[0m03:00:20.316247 [debug] [MainThread]: Snowflake adapter: Setting boto3 to ERROR (file logging only)
[0m03:00:20.379702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8cebddb5-4c3d-4bf7-8a16-fd1dccf686f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff972a09e0>]}
[0m03:00:20.402614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8cebddb5-4c3d-4bf7-8a16-fd1dccf686f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97672f90>]}
[0m03:00:20.403014 [info ] [MainThread]: Registered adapter: snowflake=1.10.3
[0m03:00:20.439849 [debug] [MainThread]: checksum: bdedcbc4566463a53095072aa091a5f5b73db413e58224228390aa7e9748abcc, vars: {}, profile: , target: , version: 1.11.0rc1
[0m03:00:20.503602 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:00:20.503911 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:00:20.529392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8cebddb5-4c3d-4bf7-8a16-fd1dccf686f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97184590>]}
[0m03:00:20.607917 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/stock_analytics/target/manifest.json
[0m03:00:20.609343 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/stock_analytics/target/semantic_manifest.json
[0m03:00:20.622921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8cebddb5-4c3d-4bf7-8a16-fd1dccf686f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff972a1eb0>]}
[0m03:00:20.623299 [info ] [MainThread]: Found 3 models, 11 data tests, 1 snapshot, 2 sources, 504 macros
[0m03:00:20.623670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8cebddb5-4c3d-4bf7-8a16-fd1dccf686f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97184530>]}
[0m03:00:20.624454 [info ] [MainThread]: 
[0m03:00:20.624706 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m03:00:20.624907 [info ] [MainThread]: 
[0m03:00:20.625250 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m03:00:20.627240 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_USER_DB_OSTRICH_SNAPSHOTS'
[0m03:00:20.645029 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_OSTRICH_SNAPSHOTS"
[0m03:00:20.645288 [debug] [ThreadPool]: On list_USER_DB_OSTRICH_SNAPSHOTS: show objects in USER_DB_OSTRICH.SNAPSHOTS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.0rc1", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_OSTRICH_SNAPSHOTS"} */;
[0m03:00:20.645467 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:00:21.055357 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.410 seconds
[0m03:00:21.059519 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_OSTRICH_SNAPSHOTS, now list_USER_DB_OSTRICH_PUBLIC_STAGING)
[0m03:00:21.064117 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_OSTRICH_PUBLIC_STAGING"
[0m03:00:21.064861 [debug] [ThreadPool]: On list_USER_DB_OSTRICH_PUBLIC_STAGING: show objects in USER_DB_OSTRICH.PUBLIC_STAGING
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.0rc1", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_OSTRICH_PUBLIC_STAGING"} */;
[0m03:00:21.159674 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.094 seconds
[0m03:00:21.163480 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_USER_DB_OSTRICH_PUBLIC_STAGING, now list_USER_DB_OSTRICH_PUBLIC_ANALYTICS)
[0m03:00:21.168952 [debug] [ThreadPool]: Using snowflake connection "list_USER_DB_OSTRICH_PUBLIC_ANALYTICS"
[0m03:00:21.169894 [debug] [ThreadPool]: On list_USER_DB_OSTRICH_PUBLIC_ANALYTICS: show objects in USER_DB_OSTRICH.PUBLIC_ANALYTICS
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.11.0rc1", "profile_name": "stock_analytics", "target_name": "dev", "connection_name": "list_USER_DB_OSTRICH_PUBLIC_ANALYTICS"} */;
[0m03:00:21.321893 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.151 seconds
[0m03:00:21.325912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8cebddb5-4c3d-4bf7-8a16-fd1dccf686f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff972fbfb0>]}
[0m03:00:21.330373 [debug] [Thread-1 (]: Began running node test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316
[0m03:00:21.331139 [info ] [Thread-1 (]: 1 of 5 START test accepted_values_mart_stock_analysis_record_type__historical__forecast  [RUN]
[0m03:00:21.331828 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_USER_DB_OSTRICH_PUBLIC_ANALYTICS, now test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316)
[0m03:00:21.332079 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316
[0m03:00:21.340395 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316"
[0m03:00:21.342432 [debug] [Thread-1 (]: Began executing node test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316
[0m03:00:21.356645 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316"
[0m03:00:21.358058 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316"
[0m03:00:21.358406 [debug] [Thread-1 (]: On test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        record_type as value_field,
        count(*) as n_records

    from USER_DB_OSTRICH.PUBLIC_ANALYTICS.mart_stock_analysis
    group by record_type

)

select *
from all_values
where value_field not in (
    'historical','forecast'
)



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.0rc1", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316"} */
[0m03:00:21.656343 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.297 seconds
[0m03:00:21.672921 [info ] [Thread-1 (]: 1 of 5 PASS accepted_values_mart_stock_analysis_record_type__historical__forecast  [[32mPASS[0m in 0.34s]
[0m03:00:21.674481 [debug] [Thread-1 (]: Finished running node test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316
[0m03:00:21.674905 [debug] [Thread-1 (]: Began running node test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5
[0m03:00:21.675538 [info ] [Thread-1 (]: 2 of 5 START test not_null_mart_stock_analysis_date ............................ [RUN]
[0m03:00:21.676356 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.accepted_values_mart_stock_analysis_record_type__historical__forecast.fb5a01c316, now test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5)
[0m03:00:21.676689 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5
[0m03:00:21.683753 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5"
[0m03:00:21.685156 [debug] [Thread-1 (]: Began executing node test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5
[0m03:00:21.686860 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5"
[0m03:00:21.687780 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5"
[0m03:00:21.688023 [debug] [Thread-1 (]: On test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date
from USER_DB_OSTRICH.PUBLIC_ANALYTICS.mart_stock_analysis
where date is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.0rc1", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5"} */
[0m03:00:21.960954 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.273 seconds
[0m03:00:21.964054 [info ] [Thread-1 (]: 2 of 5 PASS not_null_mart_stock_analysis_date .................................. [[32mPASS[0m in 0.29s]
[0m03:00:21.965184 [debug] [Thread-1 (]: Finished running node test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5
[0m03:00:21.965905 [debug] [Thread-1 (]: Began running node test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e
[0m03:00:21.966716 [info ] [Thread-1 (]: 3 of 5 START test not_null_mart_stock_analysis_symbol .......................... [RUN]
[0m03:00:21.967625 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_mart_stock_analysis_date.1fbfacb7a5, now test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e)
[0m03:00:21.968250 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e
[0m03:00:21.972826 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e"
[0m03:00:21.974833 [debug] [Thread-1 (]: Began executing node test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e
[0m03:00:21.977104 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e"
[0m03:00:21.978716 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e"
[0m03:00:21.979232 [debug] [Thread-1 (]: On test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select symbol
from USER_DB_OSTRICH.PUBLIC_ANALYTICS.mart_stock_analysis
where symbol is null



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.0rc1", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e"} */
[0m03:00:22.160510 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.180 seconds
[0m03:00:22.168416 [info ] [Thread-1 (]: 3 of 5 PASS not_null_mart_stock_analysis_symbol ................................ [[32mPASS[0m in 0.20s]
[0m03:00:22.170701 [debug] [Thread-1 (]: Finished running node test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e
[0m03:00:22.172488 [debug] [Thread-1 (]: Began running node test.stock_analytics.test_forecast_dates_future
[0m03:00:22.173216 [info ] [Thread-1 (]: 4 of 5 START test test_forecast_dates_future ................................... [RUN]
[0m03:00:22.174392 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.not_null_mart_stock_analysis_symbol.41b6f4217e, now test.stock_analytics.test_forecast_dates_future)
[0m03:00:22.174884 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.test_forecast_dates_future
[0m03:00:22.180195 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.test_forecast_dates_future"
[0m03:00:22.182971 [debug] [Thread-1 (]: Began executing node test.stock_analytics.test_forecast_dates_future
[0m03:00:22.185923 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.test_forecast_dates_future"
[0m03:00:22.187783 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.test_forecast_dates_future"
[0m03:00:22.188213 [debug] [Thread-1 (]: On test.stock_analytics.test_forecast_dates_future: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  -- Fail if any forecast date is not strictly after the latest historical date for that symbol.
with max_hist as (
  select symbol, max(date) as max_hist_date
  from USER_DB_OSTRICH.PUBLIC_ANALYTICS.mart_stock_analysis
  where record_type = 'historical'
  group by 1
)

select f.symbol, f.date, f.record_type, f.forecast_price, m.max_hist_date
from USER_DB_OSTRICH.PUBLIC_ANALYTICS.mart_stock_analysis f
join max_hist m using (symbol)
where f.record_type = 'forecast'
  and f.date <= m.max_hist_date
  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.0rc1", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.test_forecast_dates_future"} */
[0m03:00:22.499942 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.311 seconds
[0m03:00:22.505079 [info ] [Thread-1 (]: 4 of 5 PASS test_forecast_dates_future ......................................... [[32mPASS[0m in 0.33s]
[0m03:00:22.506646 [debug] [Thread-1 (]: Finished running node test.stock_analytics.test_forecast_dates_future
[0m03:00:22.507321 [debug] [Thread-1 (]: Began running node test.stock_analytics.unique_mart_stock_analysis_pk_symbol_date.2ccccb8eaa
[0m03:00:22.508329 [info ] [Thread-1 (]: 5 of 5 START test unique_mart_stock_analysis_pk_symbol_date .................... [RUN]
[0m03:00:22.509313 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.stock_analytics.test_forecast_dates_future, now test.stock_analytics.unique_mart_stock_analysis_pk_symbol_date.2ccccb8eaa)
[0m03:00:22.509921 [debug] [Thread-1 (]: Began compiling node test.stock_analytics.unique_mart_stock_analysis_pk_symbol_date.2ccccb8eaa
[0m03:00:22.520498 [debug] [Thread-1 (]: Writing injected SQL for node "test.stock_analytics.unique_mart_stock_analysis_pk_symbol_date.2ccccb8eaa"
[0m03:00:22.522160 [debug] [Thread-1 (]: Began executing node test.stock_analytics.unique_mart_stock_analysis_pk_symbol_date.2ccccb8eaa
[0m03:00:22.525101 [debug] [Thread-1 (]: Writing runtime sql for node "test.stock_analytics.unique_mart_stock_analysis_pk_symbol_date.2ccccb8eaa"
[0m03:00:22.526485 [debug] [Thread-1 (]: Using snowflake connection "test.stock_analytics.unique_mart_stock_analysis_pk_symbol_date.2ccccb8eaa"
[0m03:00:22.526881 [debug] [Thread-1 (]: On test.stock_analytics.unique_mart_stock_analysis_pk_symbol_date.2ccccb8eaa: select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    pk_symbol_date as unique_field,
    count(*) as n_records

from USER_DB_OSTRICH.PUBLIC_ANALYTICS.mart_stock_analysis
where pk_symbol_date is not null
group by pk_symbol_date
having count(*) > 1



  
  
      
    ) dbt_internal_test
/* {"app": "dbt", "dbt_version": "1.11.0rc1", "profile_name": "stock_analytics", "target_name": "dev", "node_id": "test.stock_analytics.unique_mart_stock_analysis_pk_symbol_date.2ccccb8eaa"} */
[0m03:00:23.193289 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.666 seconds
[0m03:00:23.197965 [info ] [Thread-1 (]: 5 of 5 PASS unique_mart_stock_analysis_pk_symbol_date .......................... [[32mPASS[0m in 0.69s]
[0m03:00:23.200175 [debug] [Thread-1 (]: Finished running node test.stock_analytics.unique_mart_stock_analysis_pk_symbol_date.2ccccb8eaa
[0m03:00:23.203515 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:00:23.204276 [debug] [MainThread]: Connection 'test.stock_analytics.unique_mart_stock_analysis_pk_symbol_date.2ccccb8eaa' was left open.
[0m03:00:23.204909 [debug] [MainThread]: On test.stock_analytics.unique_mart_stock_analysis_pk_symbol_date.2ccccb8eaa: Close
[0m03:00:23.353939 [info ] [MainThread]: 
[0m03:00:23.355241 [info ] [MainThread]: Finished running 5 data tests in 0 hours 0 minutes and 2.73 seconds (2.73s).
[0m03:00:23.357065 [debug] [MainThread]: Command end result
[0m03:00:23.394488 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt/stock_analytics/target/manifest.json
[0m03:00:23.396045 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt/stock_analytics/target/semantic_manifest.json
[0m03:00:23.400508 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt/stock_analytics/target/run_results.json
[0m03:00:23.400790 [info ] [MainThread]: 
[0m03:00:23.401244 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:00:23.401515 [info ] [MainThread]: 
[0m03:00:23.401745 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m03:00:23.402381 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 3.1930652, "process_in_blocks": "0", "process_kernel_time": 0.103812, "process_mem_max_rss": "145856", "process_out_blocks": "2262", "process_user_time": 1.489314}
[0m03:00:23.402676 [debug] [MainThread]: Command `dbt test` succeeded at 03:00:23.402624 after 3.19 seconds
[0m03:00:23.402910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98d90fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff997d6180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99100aa0>]}
[0m03:00:23.403180 [debug] [MainThread]: Flushing usage events
[0m03:00:23.773160 [debug] [MainThread]: An error was encountered while trying to flush usage events
